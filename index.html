<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CD0777 Elite Club - Pro Admin & VIP Activation</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: { 100: '#FFF9C4', 300: '#FDD835', 400: '#FFD700', 500: '#FFC107', 600: '#FFB300', 700: '#FFA000', 800: '#C0A000', 900: '#3d2e07' },
                        dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' },
                        elite: { 500: '#e0e7ff', 900: '#312e81' }
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                        oswald: ['Oswald', 'sans-serif']
                    },
                    animation: {
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'shake-hard': 'shakeHard 0.4s ease-in-out',
                        'flip': 'flip 0.6s ease-in-out forwards',
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'float-up': 'floatUp 1.5s ease-out forwards',
                        'pulse-glow': 'pulseGlow 1.5s infinite',
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'rocket-fly': 'rocketFly 2s ease-in-out infinite alternate',
                        'shine': 'shine 2s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'spin-fast': 'spin 0.5s linear infinite',
                        'bounce-drop': 'bounceDrop 0.6s cubic-bezier(0.36, 0, 0.66, -0.56) forwards',
                    },
                    keyframes: {
                        pop: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        shakeHard: { '0%, 100%': { transform: 'translateX(0)' }, '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-10px)' }, '20%, 40%, 60%, 80%': { transform: 'translateX(10px)' } },
                        flip: { '0%': { transform: 'rotateY(0)' }, '100%': { transform: 'rotateY(180deg)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        floatUp: { '0%': { transform: 'translateY(0) scale(1)', opacity: '1' }, '100%': { transform: 'translateY(-50px) scale(1.2)', opacity: '0' } },
                        pulseGlow: { '0%, 100%': { boxShadow: '0 0 10px #FFD700' }, '50%': { boxShadow: '0 0 25px #FFD700' } },
                        slideUp: { '0%': { transform: 'translateY(50px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        rocketFly: { '0%': { transform: 'translateY(0)' }, '100%': { transform: 'translateY(-20px)' } },
                        shine: { '0%': { backgroundPosition: '200% center' }, '100%': { backgroundPosition: '-200% center' } },
                        bounceDrop: { '0%': { transform: 'translateY(-100px)' }, '60%': { transform: 'translateY(20px)' }, '100%': { transform: 'translateY(0)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Oswald:wght@500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #fff; overflow: hidden; touch-action: manipulation; }
        .glass-panel { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border-top: 1px solid rgba(255, 255, 255, 0.08); }
        .luxury-bg { background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
        input, select, button, textarea { outline: none; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }
        
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #FFD700; cursor: pointer; margin-top: -10px; box-shadow: 0 0 10px #FFD700; border: 2px solid white; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }
        
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        
        .confetti-piece { position: absolute; width: 8px; height: 8px; background: #FFD700; animation: fall 3s linear forwards; pointer-events: none; z-index: 100; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
        
        .btn-press:active { transform: scale(0.95); transition: transform 0.1s; }
        
        .slot-spin { animation: slotSpin 0.1s linear infinite; }
        @keyframes slotSpin { 0% { transform: translateY(-20px); filter: blur(5px); } 100% { transform: translateY(20px); filter: blur(5px); } }

        .coin-container { transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.4, 2, 0.55, 0.44); }
        .coin-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .coin-front { background: radial-gradient(#FFD700, #B8860B); transform: rotateY(0deg); }
        .coin-back { background: radial-gradient(#C0C0C0, #808080); transform: rotateY(180deg); }
        
        .star-bg { background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px; opacity: 0.2; }
        .card-shine { background: linear-gradient(105deg, transparent 20%, rgba(255,255,255,0.4) 25%, transparent 30%); animation: shine 3s infinite linear; background-size: 200% 100%; }
        
        .elite-card-bg { background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%); border: 1px solid rgba(255, 215, 0, 0.3); }
        .hologram { background: linear-gradient(135deg, transparent 0%, rgba(255, 215, 0, 0.1) 50%, transparent 100%); }
        
        .checkbox-wrapper input:checked + div { background-color: #FFD700; border-color: #FFD700; }
        .checkbox-wrapper input:checked + div svg { display: block; }
        
        .loader { border: 3px solid rgba(255,255,255,0.1); border-left-color: #FFD700; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }

        /* New Games CSS */
        .wheel-pointer { width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid white; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5)); }
        .plinko-pin { width: 6px; height: 6px; border-radius: 50%; background: rgba(255,255,255,0.3); box-shadow: 0 0 5px rgba(255,255,255,0.2); }
        .plinko-ball { width: 12px; height: 12px; border-radius: 50%; background: #FFD700; box-shadow: 0 0 10px #FFD700; position: absolute; transition: all 0.3s ease-in; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.294.0",
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, Gamepad2, LogOut, Send, CheckCircle, XCircle, ChevronRight, ChevronLeft, Lock, Gem, Home, CreditCard, Wallet, ShieldCheck, Trophy, Instagram, Facebook, ExternalLink, Plus, Trash2, Smartphone, Zap, Check, Dices, RefreshCw, Menu, X, AlertTriangle, Settings, History, Globe, FileText, LifeBuoy, ArrowLeftRight, Bomb, ArrowUp, ArrowDown, HelpCircle, Flame, Percent, DollarSign, Image as ImageIcon, KeyRound, Upload, Disc, Rocket, Coins, Grid3X3, Target, Crown, Banknote, Landmark, Wifi, ThumbsUp, ThumbsDown, Users, Ban, Edit3, LockKeyhole, LayoutDashboard, UserCheck, PlayCircle, Copy, MessageCircle, Flag, Info, Loader2, Headphones, RotateCw } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, where, getDocs, orderBy, setDoc, getDoc, deleteDoc, limit, serverTimestamp } from 'firebase/firestore';

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyDJ5B7MncMfyjwb0ZnZ8p3d0bsoQAFqZQY",
            authDomain: "cd0777-casino.firebaseapp.com",
            projectId: "cd0777-casino",
            storageBucket: "cd0777-casino.firebasestorage.app",
            messagingSenderId: "320546250152",
            appId: "1:320546250152:web:730f6e581267b9b315919d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- GLOBAL HELPER FUNCTIONS ---
        
        // ** SECURITY: GAME LOGGING SYSTEM **
        const logGame = async (userId, username, game, bet, win, profit) => {
            try {
                await addDoc(collection(db, "game_logs"), {
                    userId,
                    username: username || "Unknown",
                    game,
                    bet: Number(bet),
                    win: Number(win),
                    profit: Number(profit),
                    result: Number(profit) > 0 ? 'WIN' : 'LOSS',
                    date: new Date().toISOString(),
                    timestamp: serverTimestamp()
                });
            } catch (error) {
                console.error("Logging Error:", error);
            }
        };

        const convertToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        const triggerConfetti = () => {
            const colors = ['#FFD700', '#FFFFFF', '#FFA500'];
            for(let i=0; i<50; i++) {
                const el = document.createElement('div');
                el.className = 'confetti-piece';
                el.style.left = Math.random() * 100 + 'vw';
                el.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                el.style.animationDuration = (Math.random() * 2 + 1) + 's';
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }
        };

        // --- CONSTANTS & TEXTS ---
        const DEFAULT_TERMS = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ CD0777 Elite Club.\n\n1. Ø§Ù„Ø£Ù‡Ù„ÙŠØ©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¹Ù…Ø±Ùƒ 18 Ø¹Ø§Ù…Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø§ØªÙ†Ø§.\n2. Ø§Ù„Ø­Ø³Ø§Ø¨: Ø£Ù†Øª Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø³Ø±ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ.\n3. Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ø¹Ø§Ø¯Ù„: ÙŠÙ…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠ Ø¨Ø±Ø§Ù…Ø¬ Ø£Ùˆ Ø£Ø¯ÙˆØ§Øª Ù„Ù„ØºØ´. Ø³ÙŠØªÙ… Ø­Ø¸Ø± Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© ÙÙˆØ±Ø§Ù‹ Ø¯ÙˆÙ† Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø£Ù…ÙˆØ§Ù„.\n4. Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª: Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ ÙˆØ§Ù„Ø³Ø­Ø¨ ØªØ®Ø¶Ø¹ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©.\n5. Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª: ØªØ­ØªÙØ¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ· ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.";
        const DEFAULT_POLICY = "Ù†Ø­Ù† ÙÙŠ CD0777 Elite Club Ù†Ù„ØªØ²Ù… Ø¨Ø­Ù…Ø§ÙŠØ© Ø®ØµÙˆØµÙŠØªÙƒ.\n\n1. Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ù†Ù‚ÙˆÙ… Ø¨Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ ØªÙ‚Ø¯Ù…Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù‡Ø§ØªÙ) Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©.\n2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ù†Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„ØªØ­Ø³ÙŠÙ† Ø®Ø¯Ù…Ø§ØªÙ†Ø§ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©.\n3. Ø§Ù„Ø£Ù…Ø§Ù†: Ù†Ø³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ§Øª ØªØ´ÙÙŠØ± Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ.\n4. Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©: Ù„Ø§ Ù†Ø´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø© Ø¥Ù„Ø§ Ø¨Ù…ÙˆØ¬Ø¨ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†.";

        const COUNTRIES = [
            { code: 'MA', name: 'Morocco', prefix: '+212', flag: 'ðŸ‡²ðŸ‡¦' },
            { code: 'DZ', name: 'Algeria', prefix: '+213', flag: 'ðŸ‡©ðŸ‡¿' },
            { code: 'TN', name: 'Tunisia', prefix: '+216', flag: 'ðŸ‡¹ðŸ‡³' },
            { code: 'EG', name: 'Egypt', prefix: '+20', flag: 'ðŸ‡ªðŸ‡¬' },
            { code: 'SA', name: 'Saudi Arabia', prefix: '+966', flag: 'ðŸ‡¸ðŸ‡¦' },
            { code: 'AE', name: 'UAE', prefix: '+971', flag: 'ðŸ‡¦ðŸ‡ª' },
            { code: 'QA', name: 'Qatar', prefix: '+974', flag: 'ðŸ‡¶ðŸ‡¦' },
            { code: 'KW', name: 'Kuwait', prefix: '+965', flag: 'ðŸ‡°ðŸ‡¼' },
            { code: 'TR', name: 'Turkey', prefix: '+90', flag: 'ðŸ‡¹ðŸ‡·' },
            { code: 'US', name: 'USA', prefix: '+1', flag: 'ðŸ‡ºðŸ‡¸' },
            { code: 'FR', name: 'France', prefix: '+33', flag: 'ðŸ‡«ðŸ‡·' },
            { code: 'ES', name: 'Spain', prefix: '+34', flag: 'ðŸ‡ªðŸ‡¸' },
            { code: 'IT', name: 'Italy', prefix: '+39', flag: 'ðŸ‡®ðŸ‡¹' }
        ];

        const TEXTS = {
            ar: {
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹", login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", register: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
                name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„", phone: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", user: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
                home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", casino: "ÙƒØ§Ø²ÙŠÙ†Ùˆ", tasks: "Ø§Ù„Ù…Ù‡Ø§Ù…", wallet: "Ø§Ù„Ù…Ø­ÙØ¸Ø©",
                deposit: "Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨", withdraw: "Ø³Ø­Ø¨ Ø§Ù„Ø§Ø±Ø¨Ø§Ø­", offers: "Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©",
                crash: "ÙƒØ±Ø§Ø´ (Ø·ÙŠØ§Ø±)", slots: "Ø³Ù„ÙˆØªØ³", keno: "ÙƒÙŠÙ†Ùˆ", limbo: "Ù„ÙŠÙ…Ø¨Ùˆ", coinflip: "Ø¹Ù…Ù„Ø©",
                mines: "Ø§Ù„Ø£Ù„ØºØ§Ù…", plinko: "Ø¨Ù„ÙŠÙ†ÙƒÙˆ", dice: "Ù†Ø±Ø¯", wheel: "Ø§Ù„Ø¹Ø¬Ù„Ø©", hilo: "Ù‡Ø§ÙŠ Ù„Ùˆ",
                menu: "Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©", settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", logout: "Ø®Ø±ÙˆØ¬",
                success: "Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©", error: "Ø­Ø¯Ø« Ø®Ø·Ø£",
                you_get: "Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª", you_lose: "Ø­Ø¸ Ø£ÙˆÙØ±",
                upload_proof: "Ø±ÙØ¹ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ (Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª)", amount: "Ø§Ù„Ù…Ø¨Ù„Øº", pay_method: "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹",
                inputs_err: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©", personal_info: "Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©", no_tasks: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹",
                cashout: "Ø³Ø­Ø¨", multiplier: "Ø§Ù„Ù…Ø¶Ø§Ø¹Ù", rolling: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù„Ø¹Ø¨...",
                heads: "ØµÙˆØ±Ø©", tails: "ÙƒØªØ§Ø¨Ø©", target: "Ø§Ù„Ù‡Ø¯Ù", next_round: "Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©",
                bet_placed: "ØªÙ… Ø§Ù„Ø±Ù‡Ø§Ù†", crashed: "ØªØ­Ø·Ù…", waiting: "Ø§Ù†ØªØ¸Ø§Ø±...",
                history: "Ø§Ù„Ø³Ø¬Ù„", support: "Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ", lang: "Ø§Ù„Ù„ØºØ©", policy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©", terms: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø§Ø­ÙƒØ§Ù…", confirm: "ØªØ£ÙƒÙŠØ¯",
                acc_num: "Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ / Ø§Ù„Ù…Ø­ÙØ¸Ø©", bank_name: "Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ", proof_needed: "Ø§Ù„Ù…Ø±Ø¬Ùˆ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆØ±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©", pending: "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",
                recharge: "ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù‡Ø§ØªÙ", network: "Ø§Ù„Ø´Ø¨ÙƒØ©", cnie: "Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ©", rib: "Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¨Ù†ÙƒÙŠ (RIB)",
                wallet_addr: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© (USDT/Crypto)", select_network: "Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¨ÙƒØ©",
                method_bank: "ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ", method_cash: "ÙƒØ§Ø´ Ø¨Ù„Ø³ / ÙˆØ§ÙØ§", method_crypto: "Ø¹Ù…Ù„Ø§Øª Ø±Ù‚Ù…ÙŠØ©", method_recharge: "ØªØ¹Ø¨Ø¦Ø© Ø±ØµÙŠØ¯",
                win_chance: "Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ù„ÙÙˆØ²", odd: "Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ (ODD)",
                pending_title: "ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù…Ù„ÙƒÙŠØ©",
                step_1: "Ø³Ø¬Ù„ ÙÙŠ 1xBet Ø¨ÙƒÙˆØ¯: CD0777",
                step_2: "Ø§Ø±Ø³Ù„ Ø§Ù„Ø§ÙŠØ¯ÙŠ Ù„Ù„Ø§Ø¯Ù…Ù† ÙÙŠ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…",
                wait_admin: "Ø­Ø³Ø§Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...",
                admin_dash: "Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                select_country: "Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©",
                exchange: "ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª", exchange_rate: "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù", convert: "ØªØ­ÙˆÙŠÙ„",
                processing: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...", execute: "ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", req_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", req_wait: "Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹.",
                agree_terms: "Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ", terms_link: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…",
                must_agree: "ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…",
                reset_req: "Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", logging_in: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...", registering: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...",
                play: "Ù„Ø¹Ø¨", bet: "Ø±Ù‡Ø§Ù†"
            },
            en: {
                welcome: "Welcome", login: "Login", register: "Register",
                name: "Full Name", phone: "Phone", user: "Username", pass: "Password",
                home: "Home", casino: "Casino", tasks: "Tasks", wallet: "Wallet",
                deposit: "Deposit", withdraw: "Withdraw", offers: "Special Offers",
                crash: "Crash", slots: "Slots", keno: "Keno", limbo: "Limbo", coinflip: "CoinFlip",
                mines: "Mines", plinko: "Plinko", dice: "Dice", wheel: "Wheel", hilo: "HiLo",
                menu: "Menu", settings: "Settings", logout: "Logout",
                success: "Success", error: "Error",
                you_get: "YOU WIN", you_lose: "YOU LOSE",
                upload_proof: "Upload Proof", amount: "Amount", pay_method: "Payment Method",
                inputs_err: "Missing Inputs", personal_info: "Personal Info", no_tasks: "No Tasks",
                cashout: "CASHOUT", multiplier: "Multiplier", rolling: "Rolling...",
                heads: "Heads", tails: "Tails", target: "Target", next_round: "Next Round",
                bet_placed: "Bet Placed", crashed: "CRASHED", waiting: "Waiting...",
                history: "History", support: "Support", lang: "Language", policy: "Privacy Policy", terms: "Terms of Service", confirm: "Confirm",
                acc_num: "Account No.", bank_name: "Bank Name", proof_needed: "Transfer amount & upload proof", pending: "Pending",
                recharge: "Mobile Recharge", network: "Network", cnie: "National ID (CNIE)", rib: "RIB / Account Num",
                wallet_addr: "Wallet Address", select_network: "Select Network",
                method_bank: "Bank Transfer", method_cash: "Cash Plus", method_crypto: "Crypto", method_recharge: "Mobile Recharge",
                win_chance: "Win Chance", odd: "ODD",
                pending_title: "Royal Membership Activation",
                step_1: "Register 1xBet Code: CD0777",
                step_2: "Send ID to Admin on Telegram",
                wait_admin: "Account under review, please wait...",
                admin_dash: "Dashboard",
                select_country: "Select Country",
                exchange: "Exchange", exchange_rate: "Exchange Rate", convert: "Convert",
                processing: "Processing...", execute: "Execute", req_sent: "Request Sent", req_wait: "Your request is under review.",
                agree_terms: "I agree to ", terms_link: "Terms & Conditions",
                must_agree: "You must agree to the Terms",
                reset_req: "Password Reset", logging_in: "Logging in...", registering: "Registering...",
                play: "PLAY", bet: "BET"
            }
        };

        // --- UI COMPONENTS ---
        const Button = ({ children, onClick, disabled, variant='gold', full, className='', icon: Icon, loading }) => {
            const base = "relative font-bold py-3.5 px-6 rounded-xl transition-all flex items-center justify-center gap-2 btn-press disabled:opacity-50 disabled:grayscale select-none disabled:pointer-events-none";
            const styles = {
                gold: 'bg-gradient-to-b from-[#FFD700] to-[#B8860B] text-black shadow-[0_4px_15px_rgba(255,215,0,0.3)] border border-[#FFD700]',
                green: 'bg-gradient-to-b from-emerald-500 to-emerald-700 text-white border border-emerald-500 shadow-[0_4px_15px_rgba(16,185,129,0.3)]',
                red: 'bg-gradient-to-b from-red-500 to-red-700 text-white border border-red-500 shadow-[0_4px_15px_rgba(239,68,68,0.3)]',
                dark: 'bg-dark-800 text-gold-500 border border-gold-500/30 hover:bg-dark-700'
            };
            return React.createElement('button', { type: "button", onClick, disabled: disabled || loading, className: `${base} ${styles[variant]} ${full?'w-full':''} ${className}` }, 
                loading ? React.createElement('div', { className: "loader" }) : React.createElement(React.Fragment, null, Icon && React.createElement(Icon, { size: 20 }), children)
            );
        };

        const Input = (props) => React.createElement('div', { className: "relative group w-full" },
            props.icon && React.createElement(props.icon, { size: 18, className: "absolute top-1/2 -translate-y-1/2 right-4 text-gray-500 group-focus-within:text-gold-500 transition-colors" }),
            React.createElement('input', { ...props, className: `w-full bg-dark-900 border border-white/10 p-4 ${props.icon?'pr-12':''} rounded-xl text-white outline-none focus:border-gold-500 focus:shadow-[0_0_10px_rgba(255,215,0,0.2)] transition-all placeholder:text-gray-600 shadow-inner ${props.className}` })
        );

        const OddsBadge = ({ value, label }) => {
             return React.createElement('div', { className: "absolute top-2 left-2 z-20 flex items-center gap-1.5 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-gold-500/30 shadow-lg" },
                React.createElement(Target, { size: 12, className: "text-gold-500" }),
                React.createElement('div', { className: "flex flex-col leading-none" },
                    React.createElement('span', { className: "text-[8px] text-gray-400 font-bold uppercase" }, label || "ODD"),
                    React.createElement('span', { className: "text-[10px] font-mono font-bold text-white" }, value)
                )
             );
        };

        const StatusModal = ({ title, msg, type='success', onClose }) => {
            return React.createElement('div', { className: "fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6 animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 border border-gold-500/30 w-full max-w-sm rounded-2xl p-6 relative animate-pop text-center" },
                    React.createElement('div', { className: "w-20 h-20 mx-auto mb-4 rounded-full bg-green-500/20 flex items-center justify-center" },
                        React.createElement(CheckCircle, { size: 40, className: "text-green-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, title),
                    React.createElement('p', { className: "text-gray-400 mb-6 text-sm" }, msg),
                    React.createElement(Button, { full: true, onClick: onClose }, "OK")
                )
            );
        };// --- GAME 1: CRASH (The Pilot) ---
        function CrashGame({ user, back, showMsg, ArrowIcon, t, isRTL }) {
            const [gameState, setGameState] = useState('BETTING'); // BETTING, FLYING, CRASHED
            const [countdown, setCountdown] = useState(5);
            const [multiplier, setMultiplier] = useState(1.00);
            const [betAmount, setBetAmount] = useState(100);
            const [activeBet, setActiveBet] = useState(null); // Stores the bet amount if playing
            const [cashoutWin, setCashoutWin] = useState(0);

            const reqRef = useRef(null);
            const crashPointRef = useRef(0);
            const startTimeRef = useRef(0);

            // House Edge: 4% chance to crash instantly at 1.00x + standard crash curve
            const generateCrashPoint = () => {
                // 4% Instant Loss (House Edge)
                if (Math.random() < 0.04) return 1.00;
                
                // Standard Crash Curve (1 / (1-x)) with 1% house edge in distribution
                const r = Math.random();
                const crash = 0.99 / (1 - r);
                return Math.max(1.00, Math.floor(crash * 100) / 100);
            };

            useEffect(() => {
                let timer;
                if (gameState === 'BETTING') {
                    setMultiplier(1.00); 
                    setCashoutWin(0);
                    if (countdown > 0) {
                        timer = setTimeout(() => setCountdown(c => c - 1), 1000);
                    } else {
                        startFlight();
                    }
                }
                return () => clearTimeout(timer);
            }, [gameState, countdown]);

            const startFlight = () => {
                if (activeBet) {
                    // Logic handled in placeBet, just visual start here
                }
                crashPointRef.current = generateCrashPoint();
                startTimeRef.current = Date.now();
                setGameState('FLYING');
                loop();
            };

            const loop = () => {
                const now = Date.now();
                const elapsed = (now - startTimeRef.current) / 1000; // seconds
                
                // Growth function: 1 + (0.1 * t) + (0.08 * t^2) - Accelerates over time
                const nextMult = 1 + (0.15 * elapsed) + (0.06 * Math.pow(elapsed, 2)); 
                
                if (nextMult >= crashPointRef.current) {
                    crash(crashPointRef.current);
                } else {
                    setMultiplier(nextMult);
                    reqRef.current = requestAnimationFrame(loop);
                }
            };

            const crash = (finalValue) => {
                cancelAnimationFrame(reqRef.current);
                setMultiplier(finalValue);
                setGameState('CRASHED');
                
                // Log Loss if user didn't cash out
                if (activeBet) {
                    logGame(user.id, user.username, 'Crash', activeBet, 0, -activeBet);
                    setActiveBet(null);
                }
                
                // Reset after delay
                setTimeout(() => { 
                    setCountdown(5); 
                    setGameState('BETTING'); 
                }, 3000);
            };

            const placeBet = async () => {
                if (betAmount <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < betAmount) return showMsg("Insufficient Balance", "error");
                
                try {
                    // Deduct balance immediately
                    await updateDoc(doc(db,"users",user.id), { coins: Number(user.coins) - betAmount });
                    setActiveBet(betAmount);
                    showMsg(t('bet_placed'), 'success');
                } catch(e) {
                    showMsg(t('error'), 'error');
                }
            };

            const cashout = async () => {
                if (!activeBet || gameState !== 'FLYING') return;
                
                const winAmt = Math.floor(activeBet * multiplier);
                const profit = winAmt - activeBet;
                
                // Add winnings
                await updateDoc(doc(db,"users",user.id), { coins: Number(user.coins) + winAmt });
                
                setCashoutWin(winAmt);
                logGame(user.id, user.username, 'Crash', activeBet, winAmt, profit);
                setActiveBet(null); // Clear bet so we don't log loss on crash
                
                showMsg(`${t('you_get')} ${winAmt}`, 'success');
                triggerConfetti();
            };

            useEffect(() => { return () => cancelAnimationFrame(reqRef.current); }, []);

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/5", dir: isRTL?'rtl':'ltr' }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-red-500 tracking-widest font-oswald" }, "CRASH PRO"), 
                    React.createElement('span', { className: "text-xs font-mono bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                React.createElement('div', { className: "flex-1 relative flex flex-col items-center justify-center overflow-hidden star-bg" },
                    React.createElement(OddsBadge, { value: "3.5% Edge", label: "Fairness" }),
                    
                    // Rocket Animation
                    gameState === 'FLYING' && React.createElement('div', { className: "animate-rocket-fly mb-10 transition-transform duration-75", style: { transform: `scale(${1 + multiplier/10}) translateY(-${multiplier * 10}px)` } },
                         React.createElement(Rocket, { size: 100, className: "text-red-500 drop-shadow-[0_0_30px_rgba(239,68,68,0.8)] fill-red-600 rotate-[-45deg]" })
                    ),
                    
                    // Crash Explosion
                    gameState === 'CRASHED' && React.createElement('div', { className: "animate-pop flex flex-col items-center" },
                         React.createElement('div', { className: "text-6xl mb-4" }, "ðŸ’¥"),
                         React.createElement('h2', { className: "text-4xl font-black text-red-500 uppercase font-oswald tracking-widest" }, t('crashed'))
                    ),
                    
                    // Multiplier Display
                    React.createElement('div', { className: `z-10 font-mono font-black text-6xl drop-shadow-2xl transition-colors duration-200 ${gameState==='CRASHED'?'text-red-500':(gameState==='FLYING'?'text-white':'text-gray-500')}` }, 
                        gameState === 'BETTING' ? `00:0${countdown}` : `${multiplier.toFixed(2)}x`
                    ),
                    
                    // Win Popup
                    cashoutWin > 0 && React.createElement('div', { className: "absolute top-24 bg-green-500 text-black font-black px-8 py-4 rounded-2xl animate-float-up shadow-[0_0_30px_rgba(34,197,94,0.6)] z-30 text-2xl border-4 border-green-300" }, `+${cashoutWin}`)
                ),
                
                // Controls
                React.createElement('div', { className: "p-4 bg-dark-900 border-t border-white/10 flex gap-4 pb-safe", dir: isRTL?'rtl':'ltr' }, 
                    React.createElement('div', { className: "relative w-32" }, 
                        React.createElement('input', { type: "number", value: betAmount, onChange: e=>setBetAmount(Number(e.target.value)), disabled: gameState!=='BETTING' || activeBet, className: "w-full bg-black border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-gold-500" }), 
                        React.createElement(DollarSign, { size: 14, className: "absolute top-1/2 -translate-y-1/2 left-3 text-gold-500" })
                    ),
                    gameState === 'BETTING' ? 
                        (activeBet ? React.createElement(Button, { full: true, variant: 'dark', disabled: true, className: "opacity-50" }, t('bet_placed')) : React.createElement(Button, { full: true, onClick: placeBet }, t('play'))) : 
                        (gameState === 'FLYING' && activeBet ? React.createElement(Button, { full: true, variant: 'green', onClick: cashout, className: "animate-pulse" }, `${t('cashout')} (${Math.floor(activeBet*multiplier)})`) : React.createElement(Button, { full: true, disabled: true, variant: 'dark' }, gameState==='CRASHED' ? t('crashed') : t('waiting')))
                )
            );
        }

        // --- GAME 2: SLOTS (Royal 777) ---
        function SlotsGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [reels, setReels] = useState(['ðŸ’','ðŸ‹','ðŸ‡']);
            const [spinning, setSpinning] = useState(false);
            const [status, setStatus] = useState("READY"); 
            
            // Weighted Symbols (House Edge: High value symbols are rarer)
            const ITEMS = [
                { s: 'ðŸ’', weight: 45, val: 2 }, 
                { s: 'ðŸ‹', weight: 30, val: 3 }, 
                { s: 'ðŸ‡', weight: 15, val: 5 }, 
                { s: 'ðŸ’Ž', weight: 8, val: 15 }, 
                { s: '7ï¸âƒ£', weight: 2, val: 50 } 
            ];
            
            const getRandomSymbol = () => {
                let r = Math.random() * 100;
                for(let item of ITEMS) {
                    if(r < item.weight) return item.s;
                    r -= item.weight;
                }
                return 'ðŸ’';
            };

            const spin = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                if (spinning) return;

                setSpinning(true); 
                setStatus("SPINNING...");
                
                // Deduct Bet
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                let interval = setInterval(() => {
                    setReels([getRandomSymbol(), getRandomSymbol(), getRandomSymbol()]);
                }, 80);
                
                setTimeout(async () => {
                    clearInterval(interval);
                    const finalReels = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];
                    setReels(finalReels);
                    setSpinning(false);
                    
                    // Win Logic
                    let winMult = 0;
                    const [r1, r2, r3] = finalReels;
                    
                    // 3 of a Kind
                    if(r1 === r2 && r2 === r3) {
                        const item = ITEMS.find(i => i.s === r1);
                        winMult = item ? item.val * 3 : 10; 
                    } 
                    // 2 of a Kind (Consolation)
                    else if (r1 === r2 || r2 === r3 || r1 === r3) {
                        winMult = 1.2; 
                    }
                    
                    const winAmt = Math.floor(bet * winMult);
                    const profit = winAmt - bet;

                    if(winAmt > 0) {
                        await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                        setStatus(`WIN +${winAmt}`);
                        triggerConfetti();
                        logGame(user.id, user.username, 'Slots', bet, winAmt, profit);
                    } else {
                        setStatus("NO LUCK");
                        logGame(user.id, user.username, 'Slots', bet, 0, profit);
                    }
                }, 2000);
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/5" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-purple-500 tracking-widest font-oswald" }, "ROYAL SLOTS"), 
                    React.createElement('span', { className: "text-xs font-mono bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] relative" },
                    React.createElement(OddsBadge, { value: "Weighted", label: "RNG" }),
                    
                    // Status Badge
                    React.createElement('div', { className: `mb-8 px-10 py-4 rounded-full font-black text-xl shadow-[0_0_20px_rgba(0,0,0,0.5)] transition-all transform duration-300 font-oswald tracking-widest ${status.includes('WIN') ? 'bg-green-500 text-black scale-110 rotate-1' : 'bg-dark-800 text-gold-500 border border-gold-500/30'}` }, status),
                    
                    // Slot Machine UI
                    React.createElement('div', { className: "bg-gradient-to-b from-purple-900 to-black p-6 rounded-[2rem] border-4 border-gold-500 shadow-[0_0_50px_rgba(168,85,247,0.4)] relative" },
                        // Machine Lights
                        React.createElement('div', { className: "absolute top-2 left-2 right-2 h-2 bg-white/20 rounded-full animate-pulse" }),
                        
                        React.createElement('div', { className: "flex gap-3 bg-black/60 p-6 rounded-2xl border border-white/10 shadow-inner" },
                           reels.map((r, i) => React.createElement('div', { key: i, className: "w-20 h-28 bg-gradient-to-b from-white to-gray-200 rounded-lg flex items-center justify-center text-5xl shadow-[inset_0_2px_5px_rgba(0,0,0,0.2)] relative overflow-hidden border-2 border-gray-300" }, 
                               React.createElement('div', { className: `absolute inset-0 bg-gradient-to-b from-black/10 to-transparent pointer-events-none` }),
                               React.createElement('div', { className: spinning ? 'slot-spin blur-[1px]' : 'animate-pop' }, r)
                           ))
                        )
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 border-t border-white/10 flex gap-4 pb-safe" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: spinning, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold p-3 focus:border-purple-500 outline-none" }), 
                    React.createElement(Button, { full: true, onClick: spin, disabled: spinning, variant: spinning ? 'dark' : 'gold' }, spinning ? t('rolling') : "SPIN")
                )
            );
        }

        // --- GAME 3: LIMBO (The Greedy Game) ---
        function LimboGame({ user, back, showMsg, ArrowIcon, t }) {
            const [target, setTarget] = useState(2.0);
            const [bet, setBet] = useState(100);
            const [result, setResult] = useState(null); 
            const [playing, setPlaying] = useState(false);
            
            const play = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if(Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                setPlaying(true); 
                setResult(null);
                
                // Deduct Bet
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                // House Edge: Win Chance = 95 / Target (5% Edge)
                const winChance = 95 / target; 
                const isWin = (Math.random() * 100) < winChance;
                
                let finalVal;
                if (isWin) {
                    // Generate a number ABOVE target
                    finalVal = target + (Math.random() * (100 - target)); 
                } else {
                    // Generate a number BELOW target
                    finalVal = 1.00 + (Math.random() * (target - 1.01));
                }
                
                // Animation
                let count = 1.00;
                const interval = setInterval(() => {
                    count += Math.random() * 5; 
                    if(count >= finalVal) {
                        clearInterval(interval);
                        const displayVal = finalVal.toFixed(2);
                        setResult({ val: displayVal, win: isWin });
                        setPlaying(false);
                        
                        const profit = isWin ? (Math.floor(bet * target) - bet) : -bet;
                        const winTotal = isWin ? Math.floor(bet * target) : 0;

                        if(isWin) {
                            updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winTotal});
                            triggerConfetti();
                            logGame(user.id, user.username, 'Limbo', bet, winTotal, profit);
                        } else {
                            logGame(user.id, user.username, 'Limbo', bet, 0, profit);
                        }
                    } else {
                        // Optimistic UI update for speed
                        const el = document.getElementById('limbo-val');
                        if(el) el.innerText = count.toFixed(2) + 'x';
                    }
                }, 50);
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/5" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-orange-500 tracking-widest font-oswald" }, "ROYAL LIMBO"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 relative" },
                    React.createElement(OddsBadge, { value: "Greedy", label: "Mode" }),
                    
                    // Main Result Circle
                    React.createElement('div', { className: "relative w-72 h-72 flex items-center justify-center mb-8" },
                        React.createElement('div', { className: "absolute inset-0 border-8 border-dark-800 rounded-full" }),
                        // Rotating ring effect
                        React.createElement('div', { className: `absolute inset-0 border-8 rounded-full transition-all duration-1000 ${result?.win ? 'border-green-500 shadow-[0_0_50px_#22c55e]' : (result ? 'border-red-500 shadow-[0_0_30px_#ef4444]' : 'border-gold-500 animate-spin-slow')}`, style: { borderTopColor: 'transparent', borderLeftColor: 'transparent' } }),
                        
                        React.createElement('div', { className: "text-center z-10" },
                            React.createElement('div', { id: "limbo-val", className: `text-6xl font-black font-mono tracking-tighter ${result?.win ? 'text-green-500' : (result ? 'text-red-500' : 'text-white')}` }, result ? result.val+'x' : "1.00x"),
                            React.createElement('div', { className: "text-xs text-gray-500 mt-2 font-bold uppercase tracking-widest" }, "Payout Target")
                        )
                    ),

                    // Target Controller
                    React.createElement('div', { className: "w-full max-w-sm bg-dark-900 p-6 rounded-2xl space-y-6 border border-white/5 shadow-xl" },
                          React.createElement('div', { className: "flex justify-between text-sm items-center" },
                              React.createElement('span', { className: "text-gray-400 font-bold" }, "Target Multiplier"),
                              React.createElement('span', { className: "text-gold-500 font-black font-mono text-lg" }, target.toFixed(2)+"x")
                          ),
                          React.createElement('input', { type: "range", min: "1.1", max: "100", step: "0.1", value: target, onChange: e=>setTarget(Number(e.target.value)), className: "accent-gold-500 w-full" }),
                          
                          React.createElement('div', { className: "flex justify-between text-xs font-mono text-gray-500 bg-black/40 p-3 rounded-lg border border-white/5" },
                              React.createElement('div', { className: "flex flex-col" },
                                  React.createElement('span', {}, "Win Chance"),
                                  React.createElement('span', { className: "text-white font-bold" }, (95/target).toFixed(2)+"%")
                              ),
                              React.createElement('div', { className: "flex flex-col text-right" },
                                  React.createElement('span', {}, "Potential Win"),
                                  React.createElement('span', { className: "text-green-400 font-bold" }, (bet * target).toFixed(0))
                              )
                          )
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold focus:border-orange-500 outline-none" }), 
                    React.createElement(Button, { full: true, onClick: play, disabled: playing, variant: playing ? 'dark' : 'gold' }, playing ? "..." : "BET")
                )
            );
        }// --- GAME 4: KENO (Classic) ---
        function KenoGame({ user, back, showMsg, ArrowIcon, t }) {
            const [selected, setSelected] = useState([]);
            const [drawn, setDrawn] = useState([]);
            const [bet, setBet] = useState(100);
            const [playing, setPlaying] = useState(false);
            const [gameResult, setGameResult] = useState(null);

            // House Edge: Payouts are slightly adjusted below mathematical probability
            const PAYOUTS = {
                1: [0, 1.8], // 1 pick: 0 hits=0x, 1 hit=1.8x
                2: [0, 0, 3.6],
                3: [0, 0, 1.1, 14],
                4: [0, 0, 0, 4, 30],
                5: [0, 0, 0, 1.5, 10, 50],
                6: [0, 0, 0, 0, 5, 25, 100],
                7: [0, 0, 0, 0, 2, 10, 50, 250],
                8: [0, 0, 0, 0, 0, 5, 20, 100, 500],
                9: [0, 0, 0, 0, 0, 2, 10, 50, 200, 800],
                10: [0, 0, 0, 0, 0, 0, 5, 25, 100, 400, 1000]
            };

            const toggle = (n) => {
                if(playing) return;
                if(selected.includes(n)) setSelected(selected.filter(i=>i!==n));
                else if(selected.length < 10) setSelected([...selected, n]);
            }

            const play = async () => {
                if(selected.length === 0) return showMsg("Pick at least 1 number", "error");
                if(bet <= 0) return showMsg(t('inputs_err'), 'error');
                if(Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                setPlaying(true); 
                setDrawn([]); 
                setGameResult(null);
                
                // Deduct Bet
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                // Generate 10 unique random numbers (1-40)
                const draws = [];
                while(draws.length < 10) {
                    const r = Math.ceil(Math.random() * 40);
                    if(!draws.includes(r)) draws.push(r);
                }
                
                // Animation loop
                let i = 0;
                const int = setInterval(async () => {
                    setDrawn(prev => [...prev, draws[i]]);
                    i++;
                    if(i >= 10) {
                        clearInterval(int);
                        
                        // Calculate Result
                        const matches = selected.filter(s => draws.includes(s)).length;
                        const table = PAYOUTS[selected.length] || [];
                        const mult = table[matches] || 0;
                        const winAmt = Math.floor(bet * mult);
                        const profit = winAmt - bet;
                        
                        setGameResult({ hits: matches, win: winAmt });
                        setPlaying(false);
                        
                        if(winAmt > 0) {
                            await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                            triggerConfetti();
                            showMsg(`${t('you_get')} ${winAmt}`, 'success');
                            logGame(user.id, user.username, 'Keno', bet, winAmt, profit);
                        } else {
                            logGame(user.id, user.username, 'Keno', bet, 0, profit);
                        }
                    }
                }, 150); // Speed of draw
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-emerald-500 font-oswald tracking-widest" }, "KENO"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                
                // Result Overlay
                gameResult && React.createElement('div', { className: "absolute inset-0 z-20 flex items-center justify-center bg-black/80 backdrop-blur-sm animate-fade-in", onClick: ()=>setGameResult(null) },
                    React.createElement('div', { className: "bg-dark-900 p-8 rounded-2xl border border-emerald-500/50 text-center animate-pop shadow-[0_0_50px_rgba(16,185,129,0.3)]" },
                        React.createElement('h2', { className: "text-3xl font-black text-white mb-2 font-oswald" }, gameResult.win > 0 ? "WINNER!" : "TRY AGAIN"),
                        React.createElement('p', { className: "text-gray-400 mb-4" }, `${gameResult.hits} Matches`),
                        gameResult.win > 0 && React.createElement('p', { className: "text-5xl font-mono text-emerald-400 font-bold drop-shadow-md" }, `+${gameResult.win}`),
                    )
                ),
                
                React.createElement('div', { className: "flex-1 p-4 flex flex-col items-center justify-center relative overflow-y-auto" },
                    React.createElement('div', { className: "grid grid-cols-5 gap-2 w-full max-w-md" },
                        Array(40).fill(0).map((_, i) => {
                            const n = i+1;
                            const isSel = selected.includes(n);
                            const isDrawn = drawn.includes(n);
                            const isHit = isSel && isDrawn;
                            let classes = "h-10 sm:h-12 rounded-lg font-bold text-sm transition-all duration-300 relative overflow-hidden ";
                            
                            if (isHit) classes += "bg-emerald-500 text-black shadow-[0_0_15px_#22c55e] z-10 animate-pop border border-emerald-300";
                            else if (isDrawn) classes += "bg-red-500/20 text-red-200 border border-red-500/50";
                            else if (isSel) classes += "bg-white text-black shadow-lg border border-gray-300";
                            else classes += "bg-dark-800 text-gray-600 hover:bg-dark-700 border border-white/5";
                            
                            return React.createElement('button', { key: n, onClick: ()=>toggle(n), className: classes }, 
                                React.createElement('span', { className: "relative z-10" }, n),
                                isDrawn && !isHit && React.createElement('div', { className: "absolute inset-0 bg-red-500/10 animate-pulse" })
                            );
                        })
                    )
                ),
                
                // Payout Table Hint
                selected.length > 0 && React.createElement('div', { className: "px-4 py-2 bg-dark-900 border-t border-white/5 overflow-x-auto whitespace-nowrap scrollbar-hide" },
                    React.createElement('div', { className: "flex gap-2" },
                        PAYOUTS[selected.length].map((mult, i) => mult > 0 && 
                            React.createElement('div', { key: i, className: `px-3 py-1 rounded text-xs font-mono border ${gameResult?.hits === i ? 'bg-emerald-500 text-black border-emerald-500' : 'bg-dark-800 text-gray-400 border-white/10'}` }, 
                                `${i}x: ${mult}x`
                            )
                        )
                    )
                ),

                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-emerald-500" }), 
                    React.createElement(Button, { full: true, onClick: play, disabled: playing, variant: playing ? 'dark' : 'green' }, playing ? "DRAWING..." : "PLAY KENO")
                )
            );
        }

        // --- GAME 5: COIN FLIP (3D Animation) ---
        function CoinFlipGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [choice, setChoice] = useState('HEADS'); 
            const [flipping, setFlipping] = useState(false);
            const [rotation, setRotation] = useState(0);
            const [winAmt, setWinAmt] = useState(0);

            // House Edge: Payout is 1.95x (instead of 2.0x) = 2.5% Edge
            const PAYOUT_MULT = 1.95;

            const flip = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                if (flipping) return;
                
                setFlipping(true); 
                setWinAmt(0);
                
                // Deduct Bet
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});

                const isHeads = Math.random() > 0.5;
                const result = isHeads ? 'HEADS' : 'TAILS';
                
                // Animation Logic: Add 5 full rotations (1800deg) + result offset
                const extra = isHeads ? 0 : 180;
                const newRotation = rotation + 1800 + extra; 
                setRotation(newRotation);

                setTimeout(async () => {
                    setFlipping(false);
                    const win = result === choice;
                    
                    if(win) {
                        const winTotal = Math.floor(bet * PAYOUT_MULT);
                        const profit = winTotal - bet;
                        
                        await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winTotal});
                        setWinAmt(winTotal);
                        triggerConfetti();
                        showMsg(`WIN! ${result}`, 'success');
                        logGame(user.id, user.username, 'CoinFlip', bet, winTotal, profit);
                    } else {
                        showMsg(`LOSE. It was ${result}`, 'error');
                        logGame(user.id, user.username, 'CoinFlip', bet, 0, -bet);
                    }
                }, 1100); // Wait for CSS transition
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-blue-500 font-oswald tracking-widest" }, "COIN FLIP"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center gap-10 perspective-1000 relative" },
                    React.createElement(OddsBadge, { value: "1.95x", label: "Payout" }),
                    
                    // Win Animation Text
                    winAmt > 0 && React.createElement('div', { className: "absolute top-24 text-green-500 font-black text-5xl animate-pop z-20 drop-shadow-[0_0_20px_rgba(34,197,94,0.5)] font-oswald" }, `+${winAmt}`),
                    
                    // 3D Coin Container
                    React.createElement('div', { className: "relative w-56 h-56 coin-container", style: { transform: `rotateY(${rotation}deg)` } },
                        // Front (Heads)
                        React.createElement('div', { className: "coin-face coin-front border-8 border-yellow-600 flex flex-col bg-gradient-to-br from-yellow-300 to-yellow-600" }, 
                            React.createElement(Crown, { size: 80, className: "text-yellow-900 mb-2 drop-shadow-sm" }), 
                            React.createElement('span', { className: "font-black text-yellow-900 text-2xl tracking-widest" }, "HEADS")
                        ),
                        // Back (Tails)
                        React.createElement('div', { className: "coin-face coin-back border-8 border-slate-500 flex flex-col bg-gradient-to-br from-slate-300 to-slate-500" }, 
                            React.createElement(Coins, { size: 80, className: "text-slate-800 mb-2 drop-shadow-sm" }), 
                            React.createElement('span', { className: "font-black text-slate-800 text-2xl tracking-widest" }, "TAILS")
                        )
                    ),
                    
                    // Selection Buttons
                    React.createElement('div', { className: "flex bg-dark-800 p-2 rounded-2xl border border-white/10 gap-2 shadow-xl" },
                        React.createElement('button', { onClick: ()=>setChoice('HEADS'), className: `px-8 py-4 rounded-xl font-bold transition-all flex flex-col items-center min-w-[100px] ${choice==='HEADS'?'bg-gradient-to-br from-yellow-400 to-yellow-600 text-black shadow-lg scale-105':'text-gray-400 hover:bg-white/5'}` }, 
                            React.createElement(Crown, {size:24, className:"mb-1"}), "HEADS"
                        ),
                        React.createElement('button', { onClick: ()=>setChoice('TAILS'), className: `px-8 py-4 rounded-xl font-bold transition-all flex flex-col items-center min-w-[100px] ${choice==='TAILS'?'bg-gradient-to-br from-slate-300 to-slate-500 text-black shadow-lg scale-105':'text-gray-400 hover:bg-white/5'}` }, 
                            React.createElement(Coins, {size:24, className:"mb-1"}), "TAILS"
                        )
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: flipping, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold focus:border-blue-500 outline-none" }), 
                    React.createElement(Button, { full: true, onClick: flip, disabled: flipping, variant: flipping ? 'dark' : 'gold' }, flipping ? t('rolling') : "FLIP COIN")
                )
            );
        }

        // --- GAME 6: MINES (Grid Logic) ---
        function MinesGame({ user, back, showMsg, ArrowIcon, t }) {
            const [grid, setGrid] = useState(Array(25).fill({ revealed: false, value: 'safe' }));
            const [minesCount, setMinesCount] = useState(3);
            const [gameState, setGameState] = useState('IDLE'); // IDLE, PLAYING, CASHED_OUT, BOOM
            const [bet, setBet] = useState(100);
            const [currentMult, setCurrentMult] = useState(1.00);
            const [profit, setProfit] = useState(0);

            // House Edge: 5% reduction on mathematical fair probability
            // Formula: Multiplier = (Total Spots / Safe Spots Remaining) * (1 - HouseEdge)
            // But usually accumulated: NextMult = CurrentMult * ( (25 - revealed) / (25 - revealed - mines) ) * 0.99
            
            const getNextMult = (curr, revealedCount) => {
                const remainingTiles = 25 - revealedCount;
                const remainingSafe = remainingTiles - minesCount;
                if (remainingSafe <= 0) return curr;
                
                // Calculate raw probability multiplier
                const rawOdds = remainingTiles / remainingSafe; 
                // Apply 3% house edge per step to keep it profitable for house
                return curr * rawOdds * 0.97; 
            };

            const startGame = async () => {
                if(bet <= 0) return showMsg(t('inputs_err'), 'error');
                if(Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                // Initialize Grid
                const newGrid = Array(25).fill(null).map((_,i)=>({ id: i, revealed: false, value: 'safe' }));
                
                // Place Mines (Hidden)
                let placed = 0;
                while(placed < minesCount) {
                    const idx = Math.floor(Math.random() * 25);
                    if(newGrid[idx].value !== 'mine') {
                        newGrid[idx].value = 'mine';
                        placed++;
                    }
                }
                
                setGrid(newGrid);
                setGameState('PLAYING');
                setCurrentMult(1.00);
                setProfit(0);
            };

            const handleTileClick = (index) => {
                if(gameState !== 'PLAYING') return;
                const tile = grid[index];
                if(tile.revealed) return;

                const newGrid = [...grid];
                newGrid[index] = { ...tile, revealed: true };
                
                if(tile.value === 'mine') {
                    // BOOM
                    setGameState('BOOM');
                    setGrid(newGrid.map(t => ({ ...t, revealed: true }))); // Reveal all
                    // Log Loss
                    logGame(user.id, user.username, 'Mines', bet, 0, -bet);
                } else {
                    // GEM
                    // Calculate multiplier based on how many gems revealed so far (including this one)
                    const revealedCount = newGrid.filter(t => t.revealed).length;
                    // Note: 'revealedCount - 1' was the count BEFORE this click
                    const nextM = getNextMult(currentMult, revealedCount - 1); 
                    
                    setCurrentMult(nextM);
                    setGrid(newGrid);
                }
            };

            const cashOut = async () => {
                if(gameState !== 'PLAYING') return;
                
                const winAmt = Math.floor(bet * currentMult);
                const prof = winAmt - bet;
                
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                setGameState('CASHED_OUT');
                setProfit(prof);
                setGrid(grid.map(t => ({ ...t, revealed: true }))); // Reveal map
                
                triggerConfetti();
                showMsg(`${t('you_get')} ${winAmt}`, 'success');
                logGame(user.id, user.username, 'Mines', bet, winAmt, prof);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-rose-500 font-oswald tracking-widest" }, "MINES SWEEPER"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-4" },
                    // Multiplier Badge
                    React.createElement('div', { className: `mb-6 text-4xl font-black font-mono transition-colors drop-shadow-lg ${gameState === 'BOOM' ? 'text-red-500' : 'text-green-400'}` }, 
                        `${currentMult.toFixed(2)}x`
                    ),

                    // Mines Grid
                    React.createElement('div', { className: "grid grid-cols-5 gap-2 sm:gap-3 w-full max-w-sm bg-dark-900 p-3 rounded-2xl border border-white/5 shadow-2xl" },
                        grid.map((tile, i) => {
                            let content = null;
                            let style = "bg-dark-800 hover:bg-dark-700 border-white/5 shadow-inner"; // Hidden state

                            if (tile.revealed) {
                                if (tile.value === 'mine') {
                                    style = "bg-red-500/80 border-red-500 shadow-[0_0_15px_#ef4444] z-10 scale-105";
                                    content = React.createElement(Bomb, { size: 24, className: "text-white animate-pop" });
                                } else {
                                    style = "bg-green-500/20 border-green-500 shadow-[0_0_10px_rgba(34,197,94,0.2)]";
                                    content = React.createElement(Gem, { size: 24, className: "text-green-400 animate-pop" });
                                }
                            } else if (gameState !== 'PLAYING' && gameState !== 'IDLE' && tile.value === 'mine') {
                                // Reveal mines at end of game (dimmed)
                                style = "bg-dark-800 opacity-50";
                                content = React.createElement(Bomb, { size: 20, className: "text-red-500/50" });
                            }

                            return React.createElement('button', {
                                key: i,
                                onClick: () => handleTileClick(i),
                                disabled: gameState !== 'PLAYING' || tile.revealed,
                                className: `aspect-square rounded-xl border flex items-center justify-center transition-all duration-200 active:scale-95 ${style}`
                            }, content);
                        })
                    ),

                    // Mines Slider (Only when IDLE)
                    gameState === 'IDLE' && React.createElement('div', { className: "mt-8 w-full max-w-sm bg-dark-900 p-4 rounded-xl border border-white/5" },
                        React.createElement('div', { className: "flex justify-between text-xs text-gray-400 mb-2" }, React.createElement('span', {}, "Mines Amount"), React.createElement('span', { className: "text-rose-500 font-bold" }, minesCount)),
                        React.createElement('input', { 
                            type: "range", min: "1", max: "24", value: minesCount, 
                            onChange: (e) => setMinesCount(Number(e.target.value)),
                            className: "w-full accent-rose-500" 
                        })
                    )
                ),

                // Controls
                React.createElement('div', { className: "p-4 bg-dark-900 border-t border-white/10 flex flex-col gap-3 pb-safe" },
                    gameState === 'PLAYING' 
                        ? React.createElement(Button, { 
                            full: true, 
                            variant: 'green',
                            onClick: cashOut,
                            className: "animate-pulse"
                          }, `CASHOUT ${(bet * currentMult).toFixed(0)} (${currentMult.toFixed(2)}x)`)
                        : React.createElement('div', { className: "flex gap-4" },
                            React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-rose-500" }),
                            React.createElement(Button, { full: true, onClick: startGame, variant: 'gold' }, "BET")
                          )
                )
            );
        }// --- GAME 7: PLINKO (Simplified CSS Physics) ---
        function PlinkoGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [balls, setBalls] = useState([]); // Active balls
            const [history, setHistory] = useState([]);
            
            // 8 Rows Configuration
            const ROWS = 8;
            // Multipliers (High variance at edges, <1 in middle)
            // Indices: 0 to 8
            const MULTIPLIERS = [29, 4, 1.5, 0.3, 0.3, 1.5, 4, 29];
            const COLORS = ['#ef4444', '#f97316', '#eab308', '#3b82f6', '#3b82f6', '#eab308', '#f97316', '#ef4444'];

            const dropBall = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                // Deduct balance
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});

                // Pre-calculate path
                // House Edge: Slight bias towards center indices (0.3x)
                let currentPos = 0; 
                const path = [];
                for (let i = 0; i < ROWS; i++) {
                    // 0 = Left, 1 = Right. 
                    // Bias: 52% chance to go towards center? 
                    // Simple random walk: 50/50
                    const dir = Math.random() < 0.5 ? 0 : 1; 
                    currentPos += dir;
                    path.push(currentPos); // store cumulative position
                }
                
                // Final Index matches the sum of rights taken (0 to 8)
                const finalIndex = currentPos;
                const multiplier = MULTIPLIERS[finalIndex];
                
                const ballId = Date.now() + Math.random();
                
                // Add ball
                setBalls(prev => [...prev, { id: ballId, row: 0, pos: 0 }]);

                // Animate
                let step = 0;
                const interval = setInterval(() => {
                    step++;
                    if (step <= ROWS) {
                        setBalls(prev => prev.map(b => 
                            b.id === ballId ? { ...b, row: step, pos: path[step-1] } : b
                        ));
                    } else {
                        clearInterval(interval);
                        finishBall(ballId, multiplier);
                    }
                }, 300); // Drop speed
            };

            const finishBall = async (id, multiplier) => {
                // Remove ball after delay
                setTimeout(() => setBalls(prev => prev.filter(b => b.id !== id)), 200);
                
                const winAmt = Math.floor(bet * multiplier);
                const profit = winAmt - bet;
                
                if (winAmt > 0) await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                
                // Log
                logGame(user.id, user.username, 'Plinko', bet, winAmt, profit);
                setHistory(prev => [multiplier, ...prev].slice(0, 5));
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-pink-500 font-oswald tracking-widest" }, "PLINKO"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-4 relative overflow-hidden" },
                    // Pyramid Container
                    React.createElement('div', { className: "relative mt-10 mb-4" },
                        // Pins
                        Array.from({ length: ROWS }).map((_, row) => 
                            React.createElement('div', { key: row, className: "flex justify-center gap-4 mb-8" },
                                Array.from({ length: row + 3 }).map((_, col) => 
                                    React.createElement('div', { key: col, className: "plinko-pin" })
                                )
                            )
                        ),
                        
                        // Active Balls
                        balls.map(b => 
                            React.createElement('div', { 
                                key: b.id, 
                                className: "plinko-ball",
                                style: {
                                    top: `${b.row * 38}px`, // Vertical spacing matches pin margin
                                    // Calculate logic: (Row Width / 2) + (Pos * Gap) - centering offset
                                    // Simplified: Relative to center
                                    left: `calc(50% + ${(b.pos - (b.row / 2)) * 24}px - 6px)` 
                                }
                            })
                        )
                    ),
                    
                    // Multiplier Bins
                    React.createElement('div', { className: "flex gap-1 justify-center w-full max-w-sm" },
                        MULTIPLIERS.map((m, i) => 
                            React.createElement('div', { 
                                key: i, 
                                className: `h-8 w-8 flex items-center justify-center text-[9px] font-bold rounded text-black shadow-lg animate-pop`,
                                style: { backgroundColor: COLORS[i] }
                            }, `${m}x`)
                        )
                    ),
                    
                    // History
                    React.createElement('div', { className: "absolute top-4 right-4 flex flex-col gap-1" },
                        history.map((h, i) => React.createElement('div', { key: i, className: `text-xs font-mono px-2 py-1 rounded bg-dark-800 text-pink-500 border border-pink-500/30` }, `${h}x`))
                    )
                ),

                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold focus:border-pink-500 outline-none" }), 
                    React.createElement(Button, { full: true, onClick: dropBall, variant: 'gold' }, "DROP BALL")
                )
            );
        }

        // --- GAME 8: DICE (Over/Under) ---
        function DiceGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [target, setTarget] = useState(50);
            const [rollResult, setRollResult] = useState(null);
            const [rolling, setRolling] = useState(false);
            const [direction, setDirection] = useState('over'); // 'over' or 'under'
            const [profit, setProfit] = useState(0);

            // House Edge: 2%
            const winChance = direction === 'over' ? (100 - target) : target;
            const multiplier = (98 / winChance).toFixed(4); // 98 payout / chance

            const rollDice = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setRolling(true); setRollResult(null); setProfit(0);

                let count = 0;
                const int = setInterval(() => {
                    setRollResult((Math.random() * 100).toFixed(2));
                    count++;
                    if (count > 10) {
                        clearInterval(int);
                        finalizeRoll();
                    }
                }, 50);
            };

            const finalizeRoll = async () => {
                const finalRoll = Math.random() * 100;
                setRollResult(finalRoll.toFixed(2));
                setRolling(false);

                let win = false;
                if (direction === 'over' && finalRoll > target) win = true;
                if (direction === 'under' && finalRoll < target) win = true;

                if (win) {
                    const winAmt = Math.floor(bet * multiplier);
                    const prof = winAmt - bet;
                    setProfit(prof);
                    await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                    triggerConfetti();
                    logGame(user.id, user.username, 'Dice', bet, winAmt, prof);
                } else {
                    logGame(user.id, user.username, 'Dice', bet, 0, -bet);
                }
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-blue-400 font-oswald tracking-widest" }, "DICE PRO"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    
                    // Result Box
                    React.createElement('div', { className: "relative mb-10 w-full max-w-lg bg-dark-800 rounded-2xl h-16 flex items-center px-2 border border-white/5 overflow-hidden" },
                        // Green Win Zone Overlay
                        React.createElement('div', { 
                            className: `absolute top-0 bottom-0 bg-green-500/20 transition-all duration-300`,
                            style: { 
                                left: direction === 'over' ? `${target}%` : '0%', 
                                right: direction === 'over' ? '0%' : `${100 - target}%` 
                            } 
                        }),
                        // Target Marker
                        React.createElement('div', { 
                            className: "absolute top-0 bottom-0 w-1 bg-white z-10 shadow-[0_0_10px_white]", 
                            style: { left: `${target}%` } 
                        }),
                        // Result Marker
                        rollResult !== null && React.createElement('div', {
                            className: `absolute w-12 h-12 -ml-6 bg-white rounded-xl shadow-xl z-20 flex items-center justify-center font-bold text-black border-4 ${profit > 0 ? 'border-green-500' : 'border-red-500'}`,
                            style: { left: `${rollResult}%` }
                        }, Math.floor(rollResult))
                    ),

                    // Big Number Display
                    React.createElement('div', { className: "text-center mb-8" },
                        React.createElement('div', { className: "text-6xl font-black font-mono text-white" }, rollResult || "50.00")
                    ),

                    // Control Panel
                    React.createElement('div', { className: "w-full max-w-sm bg-dark-900 p-6 rounded-2xl border border-white/5 shadow-xl space-y-6" },
                        React.createElement('div', { className: "flex justify-between items-center" },
                            React.createElement('div', {}, 
                                React.createElement('div', {className:"text-xs text-gray-400"}, "Multiplier"),
                                React.createElement('div', {className:"text-gold-500 font-bold text-xl"}, multiplier+"x")
                            ),
                            React.createElement('div', { className: "flex bg-dark-950 p-1 rounded-lg border border-white/10" },
                                React.createElement('button', { onClick: ()=>setDirection('under'), className: `px-4 py-2 rounded text-xs font-bold transition-all ${direction==='under'?'bg-blue-600 text-white':'text-gray-500'}` }, "UNDER"),
                                React.createElement('button', { onClick: ()=>setDirection('over'), className: `px-4 py-2 rounded text-xs font-bold transition-all ${direction==='over'?'bg-blue-600 text-white':'text-gray-500'}` }, "OVER")
                            ),
                            React.createElement('div', { className:"text-right" }, 
                                React.createElement('div', {className:"text-xs text-gray-400"}, "Win Chance"),
                                React.createElement('div', {className:"text-white font-bold text-xl"}, winChance.toFixed(0)+"%")
                            ),
                        ),
                        React.createElement('input', { 
                            type: "range", min: "2", max: "98", value: target, 
                            onChange: (e) => setTarget(Number(e.target.value)), 
                            className: "w-full accent-blue-500" 
                        })
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: rolling, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold outline-none focus:border-blue-500" }), 
                    React.createElement(Button, { full: true, onClick: rollDice, disabled: rolling, variant: rolling ? 'dark' : 'gold' }, rolling ? "ROLLING..." : "ROLL DICE")
                )
            );
        }

        // --- GAME 9: WHEEL (Spin to Win) ---
        function WheelGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [spinning, setSpinning] = useState(false);
            const [rotation, setRotation] = useState(0);
            const [profit, setProfit] = useState(0);

            // 8 Segments: 0x (Grey), 2x (Green), 0x, 3x (Blue), 0x, 5x (Gold), 0x, 2x
            const SEGMENTS = [0, 2, 0, 3, 0, 5, 0, 2];
            const COLORS = ['#374151', '#22c55e', '#374151', '#3b82f6', '#374151', '#eab308', '#374151', '#22c55e'];

            const spinWheel = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setSpinning(true); setProfit(0);

                // Math: Random outcome
                // House Edge: Heavy weight on 0x
                const rand = Math.random();
                let outcomeIdx;
                
                if (rand < 0.5) outcomeIdx = [0, 2, 4, 6][Math.floor(Math.random()*4)]; // 50% Loss
                else if (rand < 0.8) outcomeIdx = [1, 7][Math.floor(Math.random()*2)]; // 30% 2x
                else if (rand < 0.95) outcomeIdx = 3; // 15% 3x
                else outcomeIdx = 5; // 5% 5x

                // Calculate Rotation
                // Base 5 spins (1800) + Target Angle
                // Segment angle = 360 / 8 = 45deg
                // To land index 0 at top (pointer), we usually align it. 
                // Let's assume standard rotation: index 0 starts at 0deg.
                // Target rotation = (360 * 5) - (outcomeIdx * 45) + Random jitter
                const segAngle = 360 / 8;
                const targetRot = 1800 + (360 - (outcomeIdx * segAngle)) + (Math.random() * 30 - 15);
                const finalRot = rotation + targetRot;
                
                setRotation(finalRot);

                setTimeout(async () => {
                    setSpinning(false);
                    const mult = SEGMENTS[outcomeIdx];
                    if (mult > 0) {
                        const winAmt = Math.floor(bet * mult);
                        const prof = winAmt - bet;
                        setProfit(prof);
                        await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                        triggerConfetti();
                        showMsg(`${t('you_get')} ${winAmt}`, 'success');
                        logGame(user.id, user.username, 'Wheel', bet, winAmt, prof);
                    } else {
                        showMsg(t('you_lose'), 'error');
                        logGame(user.id, user.username, 'Wheel', bet, 0, -bet);
                    }
                }, 3000); // 3s spin
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-purple-500 font-oswald tracking-widest" }, "MEGA WHEEL"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center overflow-hidden relative" },
                    // Pointer
                    React.createElement('div', { className: "absolute top-[15%] z-20 wheel-pointer" }),
                    
                    // Wheel
                    React.createElement('div', { 
                        className: "relative w-[300px] h-[300px] rounded-full border-4 border-dark-800 shadow-[0_0_50px_rgba(168,85,247,0.3)] overflow-hidden transition-transform duration-[3000ms] cubic-bezier(0.1, 0.7, 0.1, 1)",
                        style: { transform: `rotate(${rotation}deg)` }
                    },
                        // Render Segments using Conic Gradient Logic visualization
                        // Since standard DOM nodes are easier to manage for labels:
                        SEGMENTS.map((seg, i) => 
                            React.createElement('div', {
                                key: i,
                                className: "absolute top-0 left-0 w-full h-full",
                                style: { 
                                    transform: `rotate(${i * 45}deg)`,
                                    clipPath: 'polygon(50% 50%, 100% 0, 100% 0, 100% 0)', // This is complex in CSS-in-JS without SVG
                                    // Fallback: Use simple SVG or pre-made background.
                                    // Better approach for lightweight: Use standard divs rotated around center
                                }
                            })
                        ),
                        // Simpler Visual: SVG Background
                        React.createElement('svg', { viewBox: "0 0 100 100", className: "w-full h-full transform -rotate-90" },
                            SEGMENTS.map((seg, i) => {
                                // Calculate arc path
                                const startAngle = (i * 45) * Math.PI / 180;
                                const endAngle = ((i + 1) * 45) * Math.PI / 180;
                                const x1 = 50 + 50 * Math.cos(startAngle);
                                const y1 = 50 + 50 * Math.sin(startAngle);
                                const x2 = 50 + 50 * Math.cos(endAngle);
                                const y2 = 50 + 50 * Math.sin(endAngle);
                                return React.createElement('path', {
                                    key: i,
                                    d: `M50,50 L${x1},${y1} A50,50 0 0,1 ${x2},${y2} Z`,
                                    fill: COLORS[i],
                                    stroke: "#1f2937",
                                    strokeWidth: "0.5"
                                });
                            })
                        ),
                        
                        // Labels
                        SEGMENTS.map((seg, i) => 
                            React.createElement('div', {
                                key: i,
                                className: "absolute w-full h-full flex justify-center pt-4 font-bold text-white text-lg",
                                style: { transform: `rotate(${i * 45 + 22.5}deg)` }
                            }, seg + 'x')
                        )
                    ),
                    
                    // Center Hub
                    React.createElement('div', { className: "absolute w-12 h-12 bg-dark-900 rounded-full border-2 border-white/20 z-10 flex items-center justify-center" },
                        React.createElement(RotateCw, { size: 20, className: "text-purple-500" })
                    )
                ),

                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" }, 
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: spinning, className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold outline-none focus:border-purple-500" }), 
                    React.createElement(Button, { full: true, onClick: spinWheel, disabled: spinning, variant: spinning ? 'dark' : 'gold' }, spinning ? "SPINNING..." : "SPIN WHEEL")
                )
            );
        }

        // --- GAME 10: HI-LO (Card Guessing) ---
        function HiLoGame({ user, back, showMsg, ArrowIcon, t }) {
            const [bet, setBet] = useState(100);
            const [gameState, setGameState] = useState('IDLE'); // IDLE, ACTIVE
            const [currentCard, setCurrentCard] = useState({ rank: 'A', suit: 'â™ ', value: 1, color: 'black' });
            const [streak, setStreak] = useState(0);
            const [profit, setProfit] = useState(0);

            // Card Deck Logic
            const RANKS = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            const SUITS = ['â™ ', 'â™¥', 'â™£', 'â™¦'];
            
            const drawCard = () => {
                const rIdx = Math.floor(Math.random() * 13);
                const sIdx = Math.floor(Math.random() * 4);
                const suit = SUITS[sIdx];
                return {
                    rank: RANKS[rIdx],
                    suit: suit,
                    value: rIdx + 1, // 1 to 13
                    color: (suit === 'â™¥' || suit === 'â™¦') ? 'red' : 'black'
                };
            };

            const startGame = async () => {
                if (bet <= 0) return showMsg(t('inputs_err'), 'error');
                if (Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setGameState('ACTIVE');
                setStreak(0);
                setProfit(0);
                setCurrentCard(drawCard());
            };

            const guess = async (type) => { // 'hi' or 'lo'
                const nextCard = drawCard();
                
                // Tie Rules: Standard Casino = Push or Loss. Here we make it a LOSS for House Edge.
                let win = false;
                if (type === 'hi' && nextCard.value > currentCard.value) win = true;
                if (type === 'lo' && nextCard.value < currentCard.value) win = true;
                
                setCurrentCard(nextCard); // Show next card

                if (win) {
                    // Logic: Accumulate profit based on probability
                    // Simplified: Fixed 1.3x gain per correct guess for demo
                    const gain = bet * 0.3; // 30% of base bet added to profit stack
                    setProfit(p => p + gain);
                    setStreak(s => s + 1);
                } else {
                    // Loss
                    logGame(user.id, user.username, 'HiLo', bet, 0, -bet);
                    setGameState('IDLE');
                    setProfit(0);
                    showMsg(t('you_lose'), 'error');
                }
            };

            const cashOut = async () => {
                const totalWin = bet + profit;
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+totalWin});
                
                logGame(user.id, user.username, 'HiLo', bet, totalWin, profit);
                setGameState('IDLE');
                triggerConfetti();
                showMsg(`${t('you_get')} ${Math.floor(totalWin)}`, 'success');
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-bold text-white font-oswald tracking-widest" }, "HI-LO PRO"), 
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500 border border-gold-500/30" }, user.coins.toFixed(2))
                ),
                
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    // Profit Stack
                    gameState === 'ACTIVE' && React.createElement('div', { className: "mb-6 text-center" },
                        React.createElement('div', { className: "text-xs text-gray-400 uppercase" }, "Current Profit"),
                        React.createElement('div', { className: "text-3xl font-black text-green-500 animate-pulse" }, `+${profit.toFixed(0)}`)
                    ),

                    // The Card
                    React.createElement('div', { className: "relative w-48 h-72 bg-white rounded-2xl shadow-2xl border-4 border-gray-200 flex flex-col items-center justify-between p-4 animate-flip" },
                        React.createElement('div', { className: `text-4xl font-black self-start ${currentCard.color === 'red' ? 'text-red-600' : 'text-black'}` }, currentCard.rank),
                        React.createElement('div', { className: `text-8xl ${currentCard.color === 'red' ? 'text-red-600' : 'text-black'}` }, currentCard.suit),
                        React.createElement('div', { className: `text-4xl font-black self-end rotate-180 ${currentCard.color === 'red' ? 'text-red-600' : 'text-black'}` }, currentCard.rank),
                    ),
                    
                    // Helper Text
                    React.createElement('div', { className: "mt-8 text-xs text-gray-500 font-mono" }, "ACE IS LOW â€¢ KING IS HIGH â€¢ TIE LOSES")
                ),

                React.createElement('div', { className: "p-4 bg-dark-900 flex flex-col gap-3 pb-safe border-t border-white/10" }, 
                    gameState === 'ACTIVE' ? React.createElement(React.Fragment, null,
                        React.createElement('div', { className: "flex gap-2" },
                            React.createElement(Button, { onClick: ()=>guess('hi'), full: true, className: "bg-emerald-600 border-emerald-500" }, 
                                React.createElement('div', { className: "flex flex-col items-center" }, React.createElement(ArrowUp, {size:16}), "HIGHER")
                            ),
                            React.createElement(Button, { onClick: ()=>guess('lo'), full: true, className: "bg-red-600 border-red-500" }, 
                                React.createElement('div', { className: "flex flex-col items-center" }, React.createElement(ArrowDown, {size:16}), "LOWER")
                            )
                        ),
                        React.createElement(Button, { onClick: cashOut, full: true, variant: 'gold' }, "CASHOUT")
                    ) : React.createElement('div', { className: "flex gap-4" },
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), className: "w-28 bg-black border border-white/20 rounded-xl text-center text-white font-bold outline-none focus:border-white" }),
                        React.createElement(Button, { full: true, onClick: startGame, variant: 'gold' }, "DEAL CARDS")
                    )
                )
            );
        }// --- ADMIN DASHBOARD ---
        function AdminDashboard({ user, onClose, t }) {
            const [activeTab, setActiveTab] = useState('logs');
            const [logs, setLogs] = useState([]);
            const [users, setUsers] = useState([]);

            // Fetch Game Logs (Real-time, Secure)
            useEffect(() => {
                if (activeTab === 'logs') {
                    // Query: Collection 'game_logs', ordered by 'timestamp' desc, limit 50
                    const q = query(collection(db, "game_logs"), orderBy("timestamp", "desc"), limit(50));
                    const unsub = onSnapshot(q, (snapshot) => {
                        const data = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                        setLogs(data);
                    });
                    return () => unsub();
                }
            }, [activeTab]);

            // Fetch Users (Real-time)
            useEffect(() => {
                if (activeTab === 'users') {
                    const q = query(collection(db, "users"), limit(50));
                    const unsub = onSnapshot(q, (snapshot) => {
                        const data = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                        setUsers(data);
                    });
                    return () => unsub();
                }
            }, [activeTab]);

            return React.createElement('div', { className: "fixed inset-0 z-[100] bg-dark-950 flex flex-col animate-slide-up" },
                // Admin Header
                React.createElement('div', { className: "flex items-center justify-between p-4 border-b border-white/10 bg-dark-900" },
                    React.createElement('h2', { className: "text-gold-500 font-bold text-xl flex items-center gap-2 font-oswald" }, 
                        React.createElement(ShieldCheck, { size: 24 }), "ADMIN CONTROL PANEL"
                    ),
                    React.createElement('button', { onClick: onClose, className: "p-2 bg-dark-800 rounded-lg hover:bg-red-900/50 text-white transition-colors" }, React.createElement(X, { size: 20 }))
                ),

                // Admin Tabs
                React.createElement('div', { className: "flex p-4 gap-4 border-b border-white/5 bg-dark-900/50" },
                    React.createElement('button', { onClick: () => setActiveTab('logs'), className: `px-6 py-2 rounded-xl font-bold text-sm transition-all ${activeTab === 'logs' ? 'bg-gold-500 text-black shadow-lg' : 'bg-dark-800 text-gray-400 hover:text-white'}` }, "GAME LOGS"),
                    React.createElement('button', { onClick: () => setActiveTab('users'), className: `px-6 py-2 rounded-xl font-bold text-sm transition-all ${activeTab === 'users' ? 'bg-blue-500 text-white shadow-lg' : 'bg-dark-800 text-gray-400 hover:text-white'}` }, "USER MGMT"),
                ),

                // Admin Content
                React.createElement('div', { className: "flex-1 overflow-auto p-4 bg-dark-950" },
                    
                    // TAB: GAME LOGS
                    activeTab === 'logs' && React.createElement('div', { className: "overflow-x-auto rounded-2xl border border-white/10 shadow-2xl" },
                        React.createElement('table', { className: "w-full text-left border-collapse bg-dark-900" },
                            React.createElement('thead', { className: "bg-dark-800 text-gray-400 text-xs uppercase font-bold tracking-wider" },
                                React.createElement('tr', {},
                                    React.createElement('th', { className: "p-4" }, "Time"),
                                    React.createElement('th', { className: "p-4" }, "User"),
                                    React.createElement('th', { className: "p-4" }, "Game"),
                                    React.createElement('th', { className: "p-4 text-right" }, "Bet"),
                                    React.createElement('th', { className: "p-4 text-center" }, "Result"),
                                    React.createElement('th', { className: "p-4 text-right" }, "Profit")
                                )
                            ),
                            React.createElement('tbody', { className: "text-sm text-gray-300 divide-y divide-white/5" },
                                logs.length === 0 ? 
                                React.createElement('tr', {}, React.createElement('td', { colSpan: 6, className: "p-8 text-center text-gray-500 italic" }, "No logs found.")) :
                                logs.map(log => React.createElement('tr', { key: log.id, className: "hover:bg-white/5 transition-colors" },
                                    React.createElement('td', { className: "p-4 font-mono text-xs text-gray-500" }, log.date ? new Date(log.date).toLocaleTimeString() : 'N/A'),
                                    React.createElement('td', { className: "p-4 font-bold text-white" }, log.username),
                                    React.createElement('td', { className: "p-4 font-bold text-gold-500" }, log.game),
                                    React.createElement('td', { className: "p-4 font-mono text-right" }, log.bet.toFixed(2)),
                                    React.createElement('td', { className: "p-4 text-center" }, 
                                        React.createElement('span', { className: `px-3 py-1 rounded-full text-[10px] font-black tracking-wide ${log.result === 'WIN' ? 'bg-green-500/20 text-green-400 border border-green-500/30' : 'bg-red-500/20 text-red-400 border border-red-500/30'}` }, log.result)
                                    ),
                                    React.createElement('td', { className: `p-4 font-mono font-bold text-right ${log.profit > 0 ? 'text-green-400' : 'text-red-400'}` }, 
                                        (log.profit > 0 ? '+' : '') + log.profit.toFixed(2)
                                    )
                                ))
                            )
                        )
                    ),

                    // TAB: USERS
                    activeTab === 'users' && React.createElement('div', { className: "grid gap-4 md:grid-cols-2 lg:grid-cols-3" },
                        users.map(u => React.createElement('div', { key: u.id, className: "bg-dark-900 p-5 rounded-2xl border border-white/5 flex justify-between items-center hover:border-blue-500/30 transition-all" },
                            React.createElement('div', {},
                                React.createElement('div', { className: "font-bold text-white flex items-center gap-2" }, 
                                    React.createElement(User, { size: 16, className: "text-blue-500" }), u.username
                                ),
                                React.createElement('div', { className: "text-xs text-gray-500 font-mono mt-1" }, u.memberId || "ID: N/A"),
                                React.createElement('div', { className: "text-[10px] text-gray-600 mt-2" }, u.email || "No Email")
                            ),
                            React.createElement('div', { className: "text-right" },
                                React.createElement('div', { className: "text-xs text-gray-400 uppercase" }, "Coins"),
                                React.createElement('div', { className: "font-mono text-xl font-bold text-gold-500" }, u.coins?.toFixed(0) || '0')
                            )
                        ))
                    )
                )
            );
        }

        // --- MAIN APP LOGIC ---
        function App() {
            // App State
            const [user, setUser] = useState(null);
            const [view, setView] = useState('auth'); // 'auth', 'home', 'casino', 'wallet', 'game-x', 'admin'
            const [lang, setLang] = useState('ar');
            const [menuOpen, setMenuOpen] = useState(false);
            const [notify, setNotify] = useState(null);
            const [settings, setSettings] = useState({});

            const t = (k) => TEXTS[lang][k] || k;
            const isRTL = lang === 'ar';

            // Initial Load
            useEffect(() => {
                // Fetch Global Settings
                if(db) onSnapshot(doc(db, "settings", "global"), (s) => s.exists() && setSettings(s.data()));
                
                // Check Local Auth
                const uid = localStorage.getItem('cd0777_uid');
                if (uid && db) {
                    if (uid === 'admin') {
                        setUser({ role: 'admin', username: 'Admin', coins: 999999 });
                        setView('admin');
                        return;
                    }
                    // Real User Listener
                    const unsub = onSnapshot(doc(db, "users", uid), (s) => {
                        if (s.exists()) {
                            const userData = s.data();
                            if(userData.status === 'banned') {
                                localStorage.removeItem('cd0777_uid');
                                setUser(null);
                                setView('auth');
                                showMsg('Account Banned', 'error');
                            } else {
                                setUser({ id: s.id, ...userData });
                                if(view === 'auth') setView('home'); // Auto redirect to home on load
                            }
                        } else {
                            setUser(null);
                            localStorage.removeItem('cd0777_uid');
                            setView('auth');
                        }
                    }, err => console.error(err));
                    return () => unsub();
                }
            }, []);

            // Notification Helper
            const showMsg = (msg, type='success') => { 
                setNotify({msg, type}); 
                setTimeout(()=>setNotify(null), 3000); 
            };

            // Navigation Helper
            const navTo = (v) => { 
                setView(v); 
                setMenuOpen(false); 
            };

            // Logout
            const logout = () => { 
                localStorage.removeItem('cd0777_uid'); 
                setUser(null); 
                setView('auth'); 
            };

            // --- VIEW ROUTER ---
            const renderView = () => {
                if (!user) return React.createElement(AuthScreen, { setUser, setView, showMsg, t, lang, setLang });
                
                // Pending Activation State
                if (user.status === 'pending') {
                    return React.createElement(PendingActivationScreen, { user, logout, t, isRTL, showMsg, settings });
                }

                // Admin View
                if (view === 'admin' && user.role === 'admin') {
                    return React.createElement(AdminPanel, { user, logout, db, showMsg, t }); // Existing Admin from Part 1
                }

                switch(view) {
                    case 'home': return React.createElement(HomeScreen, { user, navTo, t });
                    case 'casino': return React.createElement(CasinoScreen, { navTo, t });
                    case 'tasks': return React.createElement(TasksScreen, { user, showMsg, t });
                    case 'profile': return React.createElement(WalletScreen, { user, showMsg, t, isRTL, navTo });
                    case 'deposit': return React.createElement(DepositScreen, { user, showMsg, t, settings, back: ()=>navTo('profile') });
                    case 'withdraw': return React.createElement(WithdrawScreen, { user, showMsg, t, back: ()=>navTo('profile') });
                    case 'exchange': return React.createElement(ExchangeScreen, { user, showMsg, t, back: ()=>navTo('profile') });
                    case 'history': return React.createElement(HistoryScreen, { user, t, back: ()=>navTo('profile') });
                    case 'settings': return React.createElement(SettingsScreen, { user, showMsg, t, back: ()=>navTo('profile') });
                    
                    // Games
                    case 'game-crash': return React.createElement(CrashGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t, isRTL });
                    case 'game-slots': return React.createElement(SlotsGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-limbo': return React.createElement(LimboGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-keno': return React.createElement(KenoGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-coinflip': return React.createElement(CoinFlipGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-mines': return React.createElement(MinesGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-plinko': return React.createElement(PlinkoGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-dice': return React.createElement(DiceGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-wheel': return React.createElement(WheelGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    case 'game-hilo': return React.createElement(HiLoGame, { user, back: ()=>navTo('casino'), showMsg, ArrowIcon: isRTL ? ChevronRight : ChevronLeft, t });
                    
                    // Public Pages
                    case 'terms': return React.createElement(InfoPage, { title: t('terms'), content: settings.terms || DEFAULT_TERMS, back: ()=> user ? navTo('profile') : setView('auth'), settings });
                    case 'policy': return React.createElement(InfoPage, { title: t('policy'), content: settings.policy || DEFAULT_POLICY, back: ()=> user ? navTo('profile') : setView('auth'), settings });
                    
                    default: return React.createElement(HomeScreen, { user, navTo, t });
                }
            };

            const ArrowIcon = isRTL ? ChevronRight : ChevronLeft;

            return React.createElement('div', { className: `h-screen flex flex-col bg-dark-950 text-white relative selection:bg-gold-500 selection:text-black font-cairo`, dir: isRTL ? 'rtl' : 'ltr' },
                // Notification Toast
                notify && React.createElement('div', { className: `fixed top-6 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-xl shadow-2xl border flex items-center gap-3 animate-pop glass-panel w-max max-w-[90%] ${notify.type==='error'?'bg-red-950/90 border-red-500':'bg-green-950/90 border-green-500'}` }, 
                    notify.type==='success' ? React.createElement(CheckCircle,{size:24, className:"text-green-400"}) : React.createElement(XCircle,{size:24, className:"text-red-400"}), 
                    React.createElement('span', { className: "font-bold text-sm" }, notify.msg)
                ),
                
                // Admin Toggle (Hidden for regular users, accessible for admins in mobile view)
                (user && user.role === 'admin' && view !== 'admin') && 
                React.createElement('button', { 
                    onClick: () => setView('admin'), 
                    className: "fixed bottom-24 right-4 z-40 bg-gold-500 text-black p-3 rounded-full shadow-2xl border-2 border-white animate-bounce" 
                }, React.createElement(ShieldCheck)),

                // App Layout
                (user && view !== 'auth' && user.status !== 'pending' && view !== 'admin' && !view.startsWith('game-')) && React.createElement(React.Fragment, null,
                    React.createElement(Header, { user, toggleMenu: ()=>setMenuOpen(true) }),
                    menuOpen && React.createElement(Sidebar, { user, close: ()=>setMenuOpen(false), navTo, t, lang, setLang, settings, logout }),
                    React.createElement('main', { className: "flex-1 overflow-y-auto p-5 pb-28 z-10 scrollbar-hide" }, renderView()),
                    React.createElement('nav', { className: "fixed bottom-4 left-4 right-4 h-16 glass-panel rounded-2xl z-40 flex justify-around items-center shadow-2xl border border-white/10 backdrop-blur-md" },
                        React.createElement(NavBtn, { icon: Home, label: t('home'), active: view==='home', onClick:()=>navTo('home') }),
                        React.createElement(NavBtn, { icon: Dices, label: t('casino'), active: view==='casino', onClick:()=>navTo('casino') }),
                        React.createElement(NavBtn, { icon: Trophy, label: t('tasks'), active: view==='tasks', onClick:()=>navTo('tasks') }),
                        React.createElement(NavBtn, { icon: Wallet, label: t('wallet'), active: view==='profile', onClick:()=>navTo('profile') })
                    )
                ),

                // Game/Auth Full Screens
                ((!user) || (user && (user.status === 'pending' || view.startsWith('game-') || view === 'admin' || view === 'terms' || view === 'policy'))) && renderView()
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
