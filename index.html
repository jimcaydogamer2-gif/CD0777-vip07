<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CD0777 Royal Club - Pro V7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: { 400: '#FFD700', 500: '#FFC107', 600: '#FFA000' },
                        dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' }
                    },
                    animation: { 'pop': 'pop 0.3s ease-out', 'shake': 'shake 0.4s ease-in-out' },
                    keyframes: {
                        pop: { '0%': { transform: 'scale(0.9)' }, '100%': { transform: 'scale(1)' } },
                        shake: { '0%, 100%': { transform: 'translateX(0)' }, '25%': { transform: 'translateX(-5px)' }, '75%': { transform: 'translateX(5px)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #fff; font-family: 'Cairo', sans-serif; overflow: hidden; touch-action: manipulation; }
        .glass-panel { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border-top: 1px solid rgba(255, 255, 255, 0.1); }
        .btn-press:active { transform: scale(0.95); }
        ::-webkit-scrollbar { width: 0px; }
        .confetti { position: absolute; width: 8px; height: 8px; animation: fall 3s linear forwards; z-index: 100; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.294.0",
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, Gamepad2, LogOut, CheckCircle, XCircle, ChevronRight, ChevronLeft, Lock, Gem, Home, Wallet, Trophy, Smartphone, Check, Dices, Menu, X, Settings, Bomb, Star, TrendingUp, Upload, DollarSign } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, where, getDocs, getDoc } from 'firebase/firestore';

        // --- Firebase ---
        const firebaseConfig = {
            apiKey: "AIzaSyDJ5B7MncMfyjwb0ZnZ8p3d0bsoQAFqZQY",
            authDomain: "cd0777-casino.firebaseapp.com",
            projectId: "cd0777-casino",
            storageBucket: "cd0777-casino.firebasestorage.app",
            messagingSenderId: "320546250152",
            appId: "1:320546250152:web:730f6e581267b9b315919d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- VIP Logic ---
        const getVIP = (xp = 0) => {
            if (xp >= 100000) return { rank: 'Royal Diamond', color: '#ff00ff', bonus: 500, icon: 'ðŸ’Ž' };
            if (xp >= 10000) return { rank: 'Gold', color: '#FFD700', bonus: 100, icon: 'ðŸ‘‘' };
            if (xp >= 2000) return { rank: 'Silver', color: '#C0C0C0', bonus: 50, icon: 'ðŸ¥ˆ' };
            return { rank: 'Bronze', color: '#CD7F32', bonus: 10, icon: 'ðŸ¥‰' };
        };

        const triggerConfetti = () => {
            for(let i=0; i<30; i++) {
                const el = document.createElement('div');
                el.className = 'confetti';
                el.style.left = Math.random() * 100 + 'vw';
                el.style.backgroundColor = '#FFD700';
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }
        };

        // --- App Component ---
        export default function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('auth');
            const [splash, setSplash] = useState(true);
            const [notify, setNotify] = useState(null);
            const [menuOpen, setMenuOpen] = useState(false);
            const [settings, setSettings] = useState({});

            useEffect(() => { setTimeout(() => setSplash(false), 2000); }, []);
            useEffect(() => { if(db) onSnapshot(doc(db, "settings", "global"), s => s.exists() && setSettings(s.data())); }, []);

            useEffect(() => {
                const uid = localStorage.getItem('cd0777_uid');
                if (uid && db) {
                    return onSnapshot(doc(db, "users", uid), s => {
                        if (s.exists()) {
                            setUser({ id: s.id, ...s.data() });
                            if(view === 'auth') setView(s.data().role === 'admin' ? 'admin' : 'home');
                        } else { setUser(null); setView('auth'); }
                    });
                }
            }, []);

            const showMsg = (msg, type='success') => { setNotify({msg, type}); setTimeout(()=>setNotify(null), 3000); };
            const navTo = (v) => { setView(v); setMenuOpen(false); };
            const logout = () => { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); };

            if (splash) return React.createElement('div', { className: "fixed inset-0 bg-black flex items-center justify-center" }, React.createElement('h1', { className: "text-4xl font-black text-gold-500 animate-pulse" }, "CD0777 ROYAL"));

            if (!user && view === 'auth') return React.createElement(AuthScreen, { setUser, setView, showMsg });
            if (user?.role === 'admin' && view === 'admin') return React.createElement(AdminPanel, { user, logout, db });

            const isGame = view.startsWith('game-');

            return React.createElement('div', { className: "h-screen flex flex-col bg-dark-950 text-white relative" },
                notify && React.createElement('div', { className: `fixed top-10 left-1/2 -translate-x-1/2 z-[2000] px-6 py-3 rounded-xl border glass-panel animate-pop ${notify.type==='error'?'border-red-500 text-red-500':'border-green-500 text-green-500'}` }, notify.msg),
                
                !isGame && React.createElement('header', { className: "p-4 flex justify-between items-center border-b border-white/5" },
                    React.createElement('button', { onClick: ()=>setMenuOpen(true) }, React.createElement(Menu)),
                    React.createElement('div', { className: "bg-dark-900 px-4 py-1 rounded-full flex items-center gap-2 border border-white/10" }, React.createElement(Gem, { size: 16, className: "text-gold-500" }), React.createElement('span', { className: "font-mono font-bold" }, user.coins))
                ),

                menuOpen && React.createElement(Sidebar, { close: ()=>setMenuOpen(false), navTo, logout }),

                React.createElement('main', { className: `flex-1 overflow-y-auto ${isGame?'p-0':'p-5 pb-24'}` },
                    view === 'home' && React.createElement(HomeScreen, { user, navTo }),
                    view === 'casino' && React.createElement(CasinoScreen, { navTo }),
                    view === 'game-crash' && React.createElement(CrashGame, { user, back: ()=>navTo('casino'), showMsg }),
                    view === 'game-mines' && React.createElement(MinesGame, { user, back: ()=>navTo('casino'), showMsg }),
                    view === 'game-diamonds' && React.createElement(DiamondsGame, { user, back: ()=>navTo('casino'), showMsg }),
                    view === 'game-flip' && React.createElement(CoinFlipGame, { user, back: ()=>navTo('casino'), showMsg }),
                    view === 'tasks' && React.createElement(TasksScreen, { user, showMsg }),
                    view === 'profile' && React.createElement(WalletScreen, { user, navTo, showMsg }),
                    view === 'deposit' && React.createElement(DepositScreen, { user, settings, showMsg, back: ()=>navTo('profile') }),
                    view === 'withdraw' && React.createElement(WithdrawScreen, { user, showMsg, back: ()=>navTo('profile') }),
                    view === 'settings' && React.createElement(SettingsScreen, { user })
                ),

                !isGame && React.createElement('nav', { className: "fixed bottom-4 left-4 right-4 h-16 glass-panel rounded-2xl flex justify-around items-center border border-white/10 z-50" },
                    React.createElement(NavBtn, { icon: Home, active: view==='home', onClick:()=>navTo('home') }),
                    React.createElement(NavBtn, { icon: Dices, active: view==='casino' || isGame, onClick:()=>navTo('casino') }),
                    React.createElement(NavBtn, { icon: Trophy, active: view==='tasks', onClick:()=>navTo('tasks') }),
                    React.createElement(NavBtn, { icon: Wallet, active: view==='profile', onClick:()=>navTo('profile') })
                )
            );
        }

        // --- UI Components ---
        const NavBtn = ({ icon: Icon, active, onClick }) => React.createElement('button', { onClick, className: `p-2 transition-all ${active?'text-gold-500 scale-125':'text-gray-500'}` }, React.createElement(Icon));
        
        function Sidebar({ close, navTo, logout }) {
            return React.createElement('div', { className: "fixed inset-0 z-[100] flex" },
                React.createElement('div', { className: "absolute inset-0 bg-black/80", onClick: close }),
                React.createElement('div', { className: "relative w-64 bg-dark-900 h-full p-6 space-y-4" },
                    React.createElement('h2', { className: "text-gold-500 font-bold text-xl mb-6" }, "Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©"),
                    ['home', 'casino', 'profile', 'settings'].map(v => React.createElement('button', { key: v, onClick: ()=>navTo(v), className: "w-full text-right p-3 hover:bg-white/5 rounded-xl block capitalize" }, v)),
                    React.createElement('button', { onClick: logout, className: "text-red-500 p-3 block" }, "Ø®Ø±ÙˆØ¬")
                )
            );
        }

        // --- Auth ---
        function AuthScreen({ setUser, setView, showMsg }) {
            const [isReg, setIsReg] = useState(false);
            const [f, setF] = useState({ u: '', p: '' });
            const handle = async () => {
                if(!f.u || !f.p) return showMsg("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "error");
                if(f.u==='admin' && f.p==='admin123') { localStorage.setItem('cd0777_uid', 'admin'); setUser({role:'admin'}); return; }
                const q = query(collection(db, "users"), where("username", "==", f.u));
                const s = await getDocs(q);
                if(isReg) {
                    if(!s.empty) return showMsg("Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯", "error");
                    const nu = { username: f.u, password: f.p, coins: 100, balance: 0, xp: 0, memberId: 'CD'+Math.floor(Math.random()*9000), role: 'user', status: 'active', completedTasks: [] };
                    const ref = await addDoc(collection(db, "users"), nu);
                    localStorage.setItem('cd0777_uid', ref.id); setUser({id:ref.id, ...nu});
                } else {
                    if(s.empty || s.docs[0].data().password !== f.p) return showMsg("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "error");
                    localStorage.setItem('cd0777_uid', s.docs[0].id); setUser({id:s.docs[0].id, ...s.docs[0].data()});
                }
            };
            return React.createElement('div', { className: "h-full flex flex-col items-center justify-center p-6" },
                React.createElement('div', { className: "w-20 h-20 bg-gold-500 rounded-2xl mb-8 flex items-center justify-center text-black font-black text-3xl" }, "CD"),
                React.createElement('div', { className: "w-full max-w-sm space-y-4" },
                    React.createElement('input', { placeholder: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", onChange: e=>setF({...f,u:e.target.value}), className: "w-full p-4 bg-dark-900 rounded-xl border border-white/10" }),
                    React.createElement('input', { type: "password", placeholder: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", onChange: e=>setF({...f,p:e.target.value}), className: "w-full p-4 bg-dark-900 rounded-xl border border-white/10" }),
                    React.createElement('button', { onClick: handle, className: "w-full bg-gold-500 p-4 rounded-xl text-black font-bold" }, isReg?'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨':'Ø¯Ø®ÙˆÙ„'),
                    React.createElement('button', { onClick: ()=>setIsReg(!isReg), className: "w-full text-gray-500 text-sm" }, isReg?'Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø¯Ø®ÙˆÙ„':'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„')
                )
            );
        }

        // --- Screens ---
        function HomeScreen({ user, navTo }) {
            return React.createElement('div', { className: "space-y-6" },
                React.createElement('div', { className: "bg-gradient-to-br from-dark-800 to-black p-6 rounded-3xl border border-white/10 shadow-2xl" },
                    React.createElement('p', { className: "text-gray-400 text-xs" }, "Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ"),
                    React.createElement('h2', { className: "text-4xl font-bold text-gold-500 font-mono" }, `$${Number(user.balance).toFixed(2)}`),
                    React.createElement('p', { className: "mt-4 text-xs opacity-50 font-mono" }, `ID: ${user.memberId}`)
                ),
                React.createElement('button', { onClick: ()=>navTo('casino'), className: "w-full h-32 bg-gold-500 rounded-3xl flex items-center justify-between p-8 text-black btn-press" },
                    React.createElement('div', { className: "text-right" }, React.createElement('h3', { className: "text-2xl font-black" }, "ÙƒØ§Ø²ÙŠÙ†Ùˆ CD0777"), React.createElement('p', { className: "font-bold" }, "Ø§Ù„Ø¹Ø¨ ÙˆØ§Ø±Ø¨Ø­ Ø§Ù„Ø¢Ù†")),
                    React.createElement(Gamepad2, { size: 48 })
                )
            );
        }

        function CasinoScreen({ navTo }) {
            return React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                React.createElement(GameCard, { title: "CRASH", icon: TrendingUp, color: "red", onClick: ()=>navTo('game-crash') }),
                React.createElement(GameCard, { title: "MINES", icon: Bomb, color: "emerald", onClick: ()=>navTo('game-mines') }),
                React.createElement(GameCard, { title: "DIAMONDS", icon: Gem, color: "blue", onClick: ()=>navTo('game-diamonds') }),
                React.createElement(GameCard, { title: "COIN FLIP", icon: Star, color: "gold", onClick: ()=>navTo('game-flip') })
            );
        }
        const GameCard = ({ title, icon: Icon, color, onClick }) => React.createElement('button', { onClick, className: "bg-dark-800 p-6 rounded-3xl border border-white/5 text-center space-y-3 btn-press" }, React.createElement(Icon, { size: 32, className: `mx-auto text-${color}-500` }), React.createElement('p', { className: "font-black text-xs" }, title));

        // --- Games ---
        function CrashGame({ user, back, showMsg }) {
            const [multi, setMulti] = useState(1.00);
            const [status, setStatus] = useState('IDLE'); // RUNNING, CRASHED, CASHED
            const [bet, setBet] = useState(10);
            const timer = useRef();
            const start = async () => {
                if(user.coins < bet) return showMsg("Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙ", "error");
                await updateDoc(doc(db,"users",user.id), { coins: user.coins - bet, xp: (user.xp||0)+(bet*0.1) });
                setStatus('RUNNING'); setMulti(1.00);
                const crashPoint = (Math.random() < 0.05) ? 1.00 : (1.00 + Math.random() * 10).toFixed(2);
                timer.current = setInterval(() => {
                    setMulti(p => {
                        const next = p + 0.01;
                        if(next >= crashPoint) { clearInterval(timer.current); setStatus('CRASHED'); return parseFloat(crashPoint); }
                        return next;
                    });
                }, 100);
            };
            const cashout = async () => {
                clearInterval(timer.current); const win = Math.floor(bet * multi);
                await updateDoc(doc(db,"users",user.id), { coins: user.coins + win });
                setStatus('CASHED'); showMsg(`Ø±Ø¨Ø­Øª ${win} Ø¹Ù…Ù„Ø©`); triggerConfetti();
            };
            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 flex flex-col p-6 z-[2000]" },
                React.createElement('div', { className: "flex justify-between" }, React.createElement('button', { onClick: back }, React.createElement(X)), React.createElement('p', { className: "font-mono" }, user.coins)),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center" },
                    React.createElement('h1', { className: `text-7xl font-black font-mono mb-4 ${status==='CRASHED'?'text-red-500':status==='CASHED'?'text-green-500':'text-white'}` }, multi.toFixed(2), "x"),
                    status==='CRASHED' && React.createElement('p', {className:"text-red-500 font-bold"}, "BOOM!")
                ),
                React.createElement('div', { className: "space-y-4" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), className: "w-full p-4 bg-black rounded-xl text-center font-bold" }),
                    status==='RUNNING' ? React.createElement('button', { onClick: cashout, className: "w-full bg-green-500 p-4 rounded-xl text-black font-bold" }, "CASHOUT") : React.createElement('button', { onClick: start, className: "w-full bg-gold-500 p-4 rounded-xl text-black font-bold" }, "START")
                )
            );
        }

        function MinesGame({ user, back, showMsg }) {
            const [mines, setMines] = useState([]);
            const [revealed, setRevealed] = useState([]);
            const [active, setActive] = useState(false);
            const [bet, setBet] = useState(10);
            const start = async () => {
                if(user.coins < bet) return showMsg("Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ", "error");
                await updateDoc(doc(db,"users",user.id), { coins: user.coins - bet, xp: (user.xp||0)+(bet*0.1) });
                const m = []; while(m.length<3) { const r = Math.floor(Math.random()*25); if(!m.includes(r)) m.push(r); }
                setMines(m); setRevealed([]); setActive(true);
            };
            const click = async (i) => {
                if(!active || revealed.includes(i)) return;
                if(mines.includes(i)) { setActive(false); setRevealed([...Array(25).keys()]); showMsg("Ø®Ø³Ø±Øª!", "error"); }
                else { setRevealed([...revealed, i]); }
            };
            const cash = async () => {
                const win = Math.floor(bet * (1 + revealed.length * 0.5));
                await updateDoc(doc(db,"users",user.id), { coins: user.coins + win });
                setActive(false); setRevealed([]); showMsg(`Ø±Ø¨Ø­Øª ${win}`); triggerConfetti();
            };
            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 flex flex-col p-6 z-[2000]" },
                React.createElement('div', { className: "flex justify-between mb-8" }, React.createElement('button', { onClick: back }, React.createElement(X)), React.createElement('p',{},"MINES")),
                React.createElement('div', { className: "grid grid-cols-5 gap-2 flex-1 items-center" },
                    Array(25).fill(0).map((_,i) => React.createElement('button', { key:i, onClick: ()=>click(i), className: `aspect-square rounded-xl border flex items-center justify-center text-xl ${revealed.includes(i)? (mines.includes(i)?'bg-red-500 border-red-400':'bg-green-500 border-green-400'):'bg-dark-800 border-white/10'}` }, revealed.includes(i)?(mines.includes(i)?'ðŸ’£':'ðŸ’Ž'):'?'))
                ),
                React.createElement('div', { className: "pt-6 space-y-4" },
                    !active ? React.createElement('button', { onClick: start, className: "w-full bg-gold-500 p-4 rounded-xl text-black font-bold" }, "START") : React.createElement('button', { onClick: cash, className: "w-full bg-green-500 p-4 rounded-xl text-black font-bold" }, `CASHOUT (${Math.floor(bet*(1+revealed.length*0.5))})`)
                )
            );
        }

        function DiamondsGame({ user, back, showMsg }) {
            const [items, setItems] = useState(['ðŸ’Ž','ðŸ’Ž','ðŸ’Ž']);
            const [spinning, setSpinning] = useState(false);
            const [bet, setBet] = useState(10);
            const roll = async () => {
                if(user.coins < bet) return showMsg("Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ", "error");
                setSpinning(true);
                await updateDoc(doc(db,"users",user.id), { coins: user.coins - bet, xp: (user.xp||0)+(bet*0.1) });
                const icons = ['ðŸ’Ž','ðŸ’','ðŸ‹','ðŸ‘‘','â­'];
                const cycle = setInterval(() => setItems(items.map(()=>icons[Math.floor(Math.random()*icons.length)])), 100);
                setTimeout(async () => {
                    clearInterval(cycle); const res = items.map(()=>icons[Math.floor(Math.random()*icons.length)]);
                    setItems(res); setSpinning(false);
                    if(res[0]===res[1] && res[1]===res[2]) {
                        const win = bet*10; await updateDoc(doc(db,"users",user.id), { coins: user.coins + win });
                        showMsg("JACKPOT!"); triggerConfetti();
                    } else showMsg("Ø­Ø¸ Ø£ÙˆÙØ±", "error");
                }, 1500);
            };
            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 flex flex-col p-6 z-[2000] items-center justify-center" },
                React.createElement('button', { onClick: back, className: "absolute top-6 left-6" }, React.createElement(X)),
                React.createElement('div', { className: "flex gap-4 mb-12" }, items.map((it,i)=>React.createElement('div',{key:i,className:`w-24 h-32 bg-dark-800 rounded-3xl border-2 border-gold-500/20 flex items-center justify-center text-5xl shadow-2xl ${spinning?'animate-bounce':''}`},it))),
                React.createElement('div', {className:"w-full max-w-xs space-y-4"},
                    React.createElement('input',{type:"number",value:bet,onChange:e=>setBet(Number(e.target.value)),className:"w-full p-4 bg-black rounded-xl text-center"}),
                    React.createElement('button',{onClick:roll,disabled:spinning,className:"w-full bg-gold-500 p-5 rounded-2xl text-black font-black text-xl"},"SPIN")
                )
            );
        }

        function CoinFlipGame({ user, back, showMsg }) {
            const [bet, setBet] = useState(10);
            const [flipping, setFlipping] = useState(false);
            const flip = async (side) => {
                if(user.coins < bet) return showMsg("Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ", "error");
                setFlipping(true);
                await updateDoc(doc(db,"users",user.id), { coins: user.coins - bet, xp: (user.xp||0)+(bet*0.1) });
                setTimeout(async () => {
                    setFlipping(false);
                    const win = Math.random() > 0.5;
                    if(win) { const winAmt = bet*1.9; await updateDoc(doc(db,"users",user.id), { coins: user.coins + winAmt }); showMsg("Ø±Ø¨Ø­Øª!"); triggerConfetti(); }
                    else showMsg("Ø®Ø³Ø±Øª", "error");
                }, 1000);
            };
            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 flex flex-col p-6 z-[2000] items-center justify-center" },
                React.createElement('button', { onClick: back, className: "absolute top-6 left-6" }, React.createElement(X)),
                React.createElement('div', { className: `w-40 h-40 bg-gold-500 rounded-full flex items-center justify-center text-6xl shadow-2xl mb-20 ${flipping?'animate-spin':''}` }, "ðŸª™"),
                React.createElement('div', {className:"grid grid-cols-2 gap-4 w-full max-w-xs"},
                    React.createElement('button', {onClick:()=>flip('H'), disabled:flipping, className:"bg-dark-800 p-5 rounded-2xl border border-white/10"},"HEADS"),
                    React.createElement('button', {onClick:()=>flip('T'), disabled:flipping, className:"bg-dark-800 p-5 rounded-2xl border border-white/10"},"TAILS")
                )
            );
        }

        // --- Profile & Wallet ---
        function WalletScreen({ user, navTo, showMsg }) {
            const vip = getVIP(user.xp || 0);
            const progress = ((user.xp || 0) / 10000) * 100;
            return React.createElement('div', { className: "space-y-6" },
                React.createElement('div', { className: "bg-dark-900 p-6 rounded-3xl border border-white/5 text-center" },
                    React.createElement('p', {className:"text-xs text-gray-500 font-bold uppercase mb-2"}, "XP MEMBER"),
                    React.createElement('div', { className: "flex items-center justify-center gap-4 mb-4" }, React.createElement('span',{className:"text-4xl"},vip.icon), React.createElement('p',{className:"text-2xl font-black", style:{color:vip.color}},vip.rank)),
                    React.createElement('div', { className: "h-2 w-full bg-black rounded-full overflow-hidden" }, React.createElement('div', { className: "h-full bg-gold-500", style:{width:`${progress}%`} }))
                ),
                React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                    React.createElement('button', { onClick:()=>navTo('deposit'), className: "bg-green-600 p-4 rounded-2xl font-bold" }, "Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨"),
                    React.createElement('button', { onClick:()=>navTo('withdraw'), className: "bg-dark-800 p-4 rounded-2xl font-bold border border-white/5" }, "Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­")
                )
            );
        }

        function DepositScreen({ user, settings, showMsg, back }) {
            const [proof, setProof] = useState('');
            const submit = async () => {
                if(!proof) return showMsg("Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø«Ø¨Ø§Øª", "error");
                await addDoc(collection(db, "deposits"), { userId: user.id, username: user.username, amount: 10, proof, status: 'pending', date: new Date().toISOString() });
                showMsg("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"); back();
            };
            return React.createElement('div', { className: "space-y-6" },
                React.createElement('div', { className: "flex justify-between" }, React.createElement('h2', {className:"text-gold-500 font-bold"}, "Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨"), React.createElement('button',{onClick:back},React.createElement(X))),
                React.createElement('div', { className: "bg-dark-800 p-6 rounded-3xl border border-white/5 space-y-4" },
                    React.createElement('div', {className:"p-4 bg-black rounded-xl text-xs break-all font-mono text-gold-500"}, settings.payments?.CashPlus || "Ø§Ø±Ø³Ù„ Ù„Ù€ CashPlus: 12345678"),
                    React.createElement('label', { className: "block w-full p-8 border-2 border-dashed border-gray-600 rounded-2xl text-center" },
                        React.createElement('input', { type: "file", className: "hidden", onChange: async e=>{ const r=new FileReader(); r.readAsDataURL(e.target.files[0]); r.onload=ev=>setProof(ev.target.result); } }),
                        proof ? "âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±Ø©" : "Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø«Ø¨Ø§Øª"
                    ),
                    React.createElement('button', { onClick: submit, className: "w-full bg-gold-500 p-4 rounded-xl text-black font-bold" }, "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„")
                )
            );
        }

        function WithdrawScreen({ user, showMsg, back }) {
            const [amt, setAmt] = useState('');
            const submit = async () => {
                if(!amt || user.balance < Number(amt)) return showMsg("Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ", "error");
                await addDoc(collection(db, "withdrawals"), { userId: user.id, username: user.username, amount: amt, status: 'pending', date: new Date().toISOString() });
                await updateDoc(doc(db,"users",user.id), { balance: user.balance - Number(amt) });
                showMsg("Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©"); back();
            };
            return React.createElement('div', { className: "space-y-6" },
                React.createElement('div', { className: "flex justify-between" }, React.createElement('h2', {className:"text-gold-500 font-bold"}, "Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"), React.createElement('button',{onClick:back},React.createElement(X))),
                React.createElement('input', { type: "number", placeholder: "Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø³Ø­Ø¨ ($)", onChange: e=>setAmt(e.target.value), className: "w-full p-4 bg-dark-900 border border-white/10 rounded-xl" }),
                React.createElement('button', { onClick: submit, className: "w-full bg-gold-500 p-4 rounded-xl text-black font-bold" }, "Ø·Ù„Ø¨ Ø³Ø­Ø¨")
            );
        }

        function TasksScreen({ user, showMsg }) {
            const [tasks, setTasks] = useState([]);
            useEffect(() => { if(db) getDocs(collection(db, "tasks")).then(s => setTasks(s.docs.map(d=>({id:d.id, ...d.data()})))); }, []);
            const handleTask = async (task) => {
                window.open(task.url, '_blank');
                if(!user.completedTasks?.includes(task.id)) {
                    await updateDoc(doc(db,"users",user.id), { coins: user.coins + Number(task.reward), completedTasks: [...(user.completedTasks||[]), task.id] });
                    showMsg("Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©!");
                }
            };
            return React.createElement('div', { className: "space-y-4" },
                React.createElement('h2', { className: "text-gold-500 font-bold" }, "Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"),
                tasks.map(t => React.createElement('div', { key: t.id, className: "bg-dark-800 p-4 rounded-2xl flex justify-between items-center" }, React.createElement('div', {}, React.createElement('p',{className:"font-bold"},t.title), React.createElement('p',{className:"text-gold-500 text-xs"},`+${t.reward} Ø¹Ù…Ù„Ø©`)), React.createElement('button',{onClick:()=>handleTask(t), className:"bg-gold-500 text-black px-4 py-2 rounded-lg text-xs font-bold"},"GO")))
            );
        }

        function SettingsScreen({ user }) { return React.createElement('div', { className: "space-y-6" }, React.createElement('h2', { className: "text-gold-500 font-bold" }, "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"), React.createElement('div', { className: "bg-dark-800 p-6 rounded-3xl space-y-4" }, React.createElement('div', {}, React.createElement('p',{className:"text-gray-500 text-xs font-bold uppercase"},"USERNAME"), React.createElement('p',{className:"text-lg font-black"},user.username)), React.createElement('div', {}, React.createElement('p',{className:"text-gray-500 text-xs font-bold uppercase"},"MEMBER ID"), React.createElement('p',{className:"text-lg font-mono text-gold-500"},user.memberId)))); }

        function AdminPanel({ user, logout, db }) {
            const [data, setData] = useState({ deposits: [], withdrawals: [] });
            useEffect(() => { 
                onSnapshot(collection(db, "deposits"), s => setData(p => ({ ...p, deposits: s.docs.map(d=>({id:d.id, ...d.data()})) })));
                onSnapshot(collection(db, "withdrawals"), s => setData(p => ({ ...p, withdrawals: s.docs.map(d=>({id:d.id, ...d.data()})) })));
            }, []);
            const updateStatus = async (col, id, status, amount, userId) => {
                await updateDoc(doc(db, col, id), { status });
                if(status === 'approved' && col === 'deposits') {
                    const u = await getDoc(doc(db, "users", userId));
                    await updateDoc(doc(db, "users", userId), { coins: Number(u.data().coins) + (10*1000) });
                }
            };
            return React.createElement('div', { className: "p-6 space-y-4 min-h-screen bg-dark-950 overflow-y-auto" }, 
                React.createElement('div', {className:"flex justify-between"}, React.createElement('h1',{className:"text-gold-500 font-bold uppercase"},"Admin Dashboard"), React.createElement('button',{onClick:logout},"EXIT")),
                data.deposits.map(d => React.createElement('div', { key: d.id, className: "bg-dark-800 p-4 rounded-xl border border-white/5 mb-4" }, React.createElement('p',{},`${d.username} - Pending`), d.proof && React.createElement('img',{src:d.proof, className:"w-full h-32 object-cover rounded mt-2"}), d.status==='pending' && React.createElement('button', { onClick:()=>updateStatus('deposits',d.id,'approved',10,d.userId), className:"bg-green-600 w-full mt-2 py-2 rounded" }, "Approve")))
            );
        }

        const root = createRoot(document.getElementById('root')); root.render(React.createElement(App));
    </script>
</body>
</html>
