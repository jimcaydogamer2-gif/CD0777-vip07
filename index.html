
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CD0777 Elite Club - Tier 1 Experience</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: { 100: '#FFF9C4', 300: '#FDD835', 400: '#FFD700', 500: '#FFC107', 600: '#FFB300', 700: '#FFA000', 800: '#C0A000', 900: '#3d2e07' },
                        dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' },
                        elite: { 500: '#e0e7ff', 900: '#312e81' }
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                        oswald: ['Oswald', 'sans-serif']
                    },
                    animation: {
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'shake-hard': 'shakeHard 0.4s ease-in-out',
                        'flip': 'flip 0.6s ease-in-out forwards',
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'float-up': 'floatUp 1.5s ease-out forwards',
                        'pulse-glow': 'pulseGlow 1.5s infinite',
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'rocket-fly': 'rocketFly 0.5s ease-in-out infinite alternate',
                        'shine': 'shine 2s infinite',
                        'spin-slow': 'spin 1s linear infinite',
                        'win-pulse': 'winPulse 0.8s infinite alternate',
                        'loss-shake': 'lossShake 0.5s',
                        'gold-rain': 'goldRain 3s linear infinite',
                        'slide-in-right': 'slideInRight 0.3s ease-out',
                    },
                    keyframes: {
                        pop: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        shakeHard: { '0%, 100%': { transform: 'translateX(0)' }, '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-10px)' }, '20%, 40%, 60%, 80%': { transform: 'translateX(10px)' } },
                        flip: { '0%': { transform: 'rotateY(0)' }, '100%': { transform: 'rotateY(180deg)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        floatUp: { '0%': { transform: 'translateY(0) scale(1)', opacity: '1' }, '100%': { transform: 'translateY(-50px) scale(1.2)', opacity: '0' } },
                        pulseGlow: { '0%, 100%': { boxShadow: '0 0 10px #FFD700' }, '50%': { boxShadow: '0 0 25px #FFD700' } },
                        slideUp: { '0%': { transform: 'translateY(50px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        rocketFly: { '0%': { transform: 'translateY(0)' }, '100%': { transform: 'translateY(-5px)' } },
                        shine: { '0%': { backgroundPosition: '200% center' }, '100%': { backgroundPosition: '-200% center' } },
                        winPulse: { '0%': { transform: 'scale(1)', filter: 'brightness(1)' }, '100%': { transform: 'scale(1.05)', filter: 'brightness(1.3)' } },
                        lossShake: { '0%, 100%': { transform: 'translate(0, 0)' }, '25%': { transform: 'translate(-5px, 5px)' }, '50%': { transform: 'translate(5px, -5px)' }, '75%': { transform: 'translate(-5px, -5px)' } },
                        goldRain: { '0%': { backgroundPosition: '0 0' }, '100%': { backgroundPosition: '0 1000px' } },
                        slideInRight: { '0%': { transform: 'translateX(100%)' }, '100%': { transform: 'translateX(0)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Oswald:wght@500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #fff; overflow: hidden; touch-action: manipulation; font-family: 'Cairo', sans-serif; }
        .glass-panel { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.08); }
        .luxury-bg { background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
        input, select, button, textarea { outline: none; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }
        
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #FFD700; cursor: pointer; margin-top: -10px; box-shadow: 0 0 10px #FFD700; border: 2px solid white; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }
        
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        
        .btn-press:active { transform: scale(0.95); transition: transform 0.05s; }
        
        .slot-spin { animation: slotSpin 0.08s linear infinite; }
        @keyframes slotSpin { 0% { transform: translateY(-20px); filter: blur(5px); } 100% { transform: translateY(20px); filter: blur(5px); } }

        .coin-container { transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.4, 2, 0.55, 0.44); }
        .coin-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .coin-front { background: radial-gradient(#FFD700, #B8860B); transform: rotateY(0deg); }
        .coin-back { background: radial-gradient(#C0C0C0, #808080); transform: rotateY(180deg); }
        
        .star-bg { background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px; opacity: 0.2; }
        .card-shine { background: linear-gradient(105deg, transparent 20%, rgba(255,255,255,0.4) 25%, transparent 30%); animation: shine 3s infinite linear; background-size: 200% 100%; }
        
        .elite-card-bg { background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%); border: 1px solid rgba(255, 215, 0, 0.3); }
        .hologram { background: linear-gradient(135deg, transparent 0%, rgba(255, 215, 0, 0.1) 50%, transparent 100%); }
        
        .checkbox-wrapper input:checked + div { background-color: #FFD700; border-color: #FFD700; }
        .checkbox-wrapper input:checked + div svg { display: block; }
        
        .loader { border: 3px solid rgba(255,255,255,0.1); border-left-color: #FFD700; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        
        .glass-modal { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 215, 0, 0.1); }
        .text-glow { text-shadow: 0 0 20px #FFD700, 0 0 40px #FFD700; }
        .text-glow-red { text-shadow: 0 0 20px #ef4444, 0 0 40px #991b1b; }
        .cracked-screen {
            position: fixed; inset: 0; pointer-events: none; z-index: 60;
            background: 
                radial-gradient(circle at 50% 50%, transparent 50%, rgba(255,0,0,0.1) 100%),
                linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.1) 50%, transparent 52%);
            box-shadow: inset 0 0 150px rgba(185, 28, 28, 0.5);
            background-size: 100% 100%, 200% 200%;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.294.0",
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>

    <script type="module">
        import React, { useState, useEffect, useRef, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, Gamepad2, LogOut, Send, CheckCircle, XCircle, ChevronRight, ChevronLeft, Lock, Gem, Home, CreditCard, Wallet, ShieldCheck, Trophy, Instagram, Facebook, ExternalLink, Plus, Trash2, Smartphone, Zap, Check, Dices, RefreshCw, Menu, X, AlertTriangle, Settings, History, Globe, FileText, LifeBuoy, ArrowLeftRight, Bomb, ArrowUp, HelpCircle, Flame, Percent, DollarSign, Image as ImageIcon, KeyRound, Upload, Disc, Rocket, Coins, Grid3X3, Target, Crown, Banknote, Landmark, Wifi, ThumbsUp, ThumbsDown, Users, Ban, Edit3, LockKeyhole, LayoutDashboard, UserCheck, PlayCircle, Copy, MessageCircle, Flag, Info, Loader2, Headphones, CircleDot, MoveUp, Mail, Star, Bell, Speaker } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, where, getDocs, orderBy, setDoc, getDoc, deleteDoc } from 'firebase/firestore';

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyDJ5B7MncMfyjwb0ZnZ8p3d0bsoQAFqZQY",
            authDomain: "cd0777-casino.firebaseapp.com",
            projectId: "cd0777-casino",
            storageBucket: "cd0777-casino.firebasestorage.app",
            messagingSenderId: "320546250152",
            appId: "1:320546250152:web:730f6e581267b9b315919d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- TIER 1: SOUND ENGINE (Procedural Audio) ---
        const AudioSys = {
            ctx: null,
            init: () => {
                if (!AudioSys.ctx) {
                    AudioSys.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
                if(AudioSys.ctx.state === 'suspended') AudioSys.ctx.resume();
            },
            playTone: (freq, type, duration, vol=0.1) => {
                if(!AudioSys.ctx) return;
                const osc = AudioSys.ctx.createOscillator();
                const gain = AudioSys.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, AudioSys.ctx.currentTime);
                gain.gain.setValueAtTime(vol, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, AudioSys.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                osc.start();
                osc.stop(AudioSys.ctx.currentTime + duration);
            },
            click: () => { AudioSys.init(); AudioSys.playTone(800, 'triangle', 0.05, 0.05); },
            success: () => { 
                AudioSys.init(); 
                [440, 554, 659].forEach((f,i) => setTimeout(() => AudioSys.playTone(f, 'sine', 0.3, 0.1), i*100)); 
            },
            error: () => { 
                AudioSys.init(); 
                AudioSys.playTone(150, 'sawtooth', 0.3, 0.1); 
            },
            spin: () => { AudioSys.init(); AudioSys.playTone(200, 'square', 0.05, 0.03); },
            win: () => {
                AudioSys.init();
                const notes = [523.25, 659.25, 783.99, 1046.50, 783.99, 1046.50];
                notes.forEach((n, i) => setTimeout(() => AudioSys.playTone(n, 'square', 0.2, 0.1), i*120));
            },
            crash: () => {
                AudioSys.init();
                const bufferSize = AudioSys.ctx.sampleRate * 0.5;
                const buffer = AudioSys.ctx.createBuffer(1, bufferSize, AudioSys.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for(let i=0; i<bufferSize; i++) data[i] = Math.random() * 2 - 1;
                const noise = AudioSys.ctx.createBufferSource();
                noise.buffer = buffer;
                const gain = AudioSys.ctx.createGain();
                gain.gain.setValueAtTime(0.2, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, AudioSys.ctx.currentTime + 0.5);
                noise.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                noise.start();
            },
            coins: () => {
                 AudioSys.init();
                 for(let i=0; i<5; i++) setTimeout(()=> AudioSys.playTone(2000 + Math.random()*1000, 'sine', 0.1, 0.05), i*50);
            }
        };

        // --- TIER 1: HAPTICS & UX ---
        const hapticFeedback = (type) => {
            if (navigator.vibrate) {
                if(type === 'soft') navigator.vibrate(10);
                if(type === 'success') navigator.vibrate([50, 50, 50]);
                if(type === 'error') navigator.vibrate([50, 100, 50]);
                if(type === 'impact') navigator.vibrate(40);
            }
        };

        // --- TIER 1: CANVAS VFX (PARTICLE SYSTEM) ---
        const WinParticles = ({ active }) => {
            const canvasRef = useRef(null);
            useEffect(() => {
                if(!active) return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                let particles = [];
                for(let i=0; i<100; i++) {
                    particles.push({
                        x: canvas.width/2, y: canvas.height/2,
                        vx: (Math.random() - 0.5) * 15, vy: (Math.random() - 0.5) * 15,
                        life: 1, color: Math.random() > 0.5 ? '#FFD700' : '#FFF'
                    });
                }
                const render = () => {
                    ctx.clearRect(0,0, canvas.width, canvas.height);
                    particles.forEach((p, i) => {
                        p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life -= 0.01;
                        ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI*2);
                        ctx.fillStyle = p.color; ctx.globalAlpha = p.life; ctx.fill();
                        if(p.life <= 0) particles.splice(i, 1);
                    });
                    if(particles.length > 0) requestAnimationFrame(render);
                };
                render();
            }, [active]);
            if(!active) return null;
            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[70]" });
        };

        // --- TIER 1: COMMUNITY CHAT WIDGET ---
        const ChatWidget = ({ user, t, isRTL }) => {
            const [isOpen, setIsOpen] = useState(false);
            const [msgs, setMsgs] = useState([
                { u: 'Ahmed_99', m: 'Big win on Crash! x50 ðŸš€', t: 'Just now' },
                { u: 'SarahPro', m: 'Anyone playing Slots?', t: '1m ago' },
                { u: 'CasinoKing', m: 'This platform is fire ðŸ”¥', t: '2m ago' }
            ]);
            const FAKE_MSGS = ["Just cashed out $500!", "Crash is rigged today lol", "x100 incoming on Plinko", "Who wants a code?", "Lost it all... again", "Admin is fast today", "Nice update!"];
            const FAKE_USERS = ["Momo_X", "RajaClub", "Wydad_Fan", "CryptoWhale", "Hassan22", "Layla_Q"];
            useEffect(() => {
                const interval = setInterval(() => {
                    if(Math.random() > 0.7) {
                        const newMsg = { u: FAKE_USERS[Math.floor(Math.random() * FAKE_USERS.length)], m: FAKE_MSGS[Math.floor(Math.random() * FAKE_MSGS.length)], t: 'Just now' };
                        setMsgs(prev => [newMsg, ...prev.slice(0, 8)]);
                    }
                }, 4000);
                return () => clearInterval(interval);
            }, []);
            return React.createElement(React.Fragment, null,
                React.createElement('button', { onClick: () => { setIsOpen(!isOpen); AudioSys.click(); }, className: "fixed bottom-24 right-4 z-40 bg-gold-500 text-black p-3 rounded-full shadow-[0_0_20px_#FFD700] btn-press" }, React.createElement(MessageCircle, { size: 24 })),
                isOpen && React.createElement('div', { className: `fixed inset-y-0 right-0 w-72 bg-dark-950/95 border-l border-gold-500/20 backdrop-blur-xl z-50 p-4 flex flex-col transition-transform ${isRTL?'left-0 border-r border-l-0':''} animate-slide-in-right` },
                    React.createElement('div', { className: "flex justify-between items-center mb-4 border-b border-white/10 pb-2" }, React.createElement('h3', { className: "text-gold-500 font-bold" }, "Elite Chat"), React.createElement('button', { onClick: ()=>setIsOpen(false) }, React.createElement(X, { className: "text-gray-400" }))),
                    React.createElement('div', { className: "flex-1 overflow-y-auto space-y-3 no-scrollbar" },
                        msgs.map((m, i) => React.createElement('div', { key: i, className: "bg-white/5 p-3 rounded-lg border border-white/5 animate-fade-in" },
                            React.createElement('div', { className: "flex justify-between items-baseline mb-1" }, React.createElement('span', { className: "text-gold-500 text-xs font-bold" }, m.u), React.createElement('span', { className: "text-gray-500 text-[9px]" }, m.t)),
                            React.createElement('p', { className: "text-xs text-gray-200" }, m.m)
                        ))
                    ),
                    React.createElement('div', { className: "mt-2 pt-2 border-t border-white/10" }, React.createElement('input', { disabled: true, placeholder: "Chat disabled for non-VIP", className: "w-full bg-black/40 text-xs p-2 rounded border border-white/5 text-center cursor-not-allowed" }))
                )
            );
        };

        // --- TIER 1: LIVE ACTIVITY TICKER ---
        const LiveTicker = ({ t }) => {
            const [ticker, setTicker] = useState("Welcome to CD0777 Elite Club");
            useEffect(() => {
                const ACTIONS = ["User **82 just withdrew $200 via Bank", "**99 Hit x50 on Crash!", "**12 Deposited $50 via CashPlus", "**05 Won 5000 Coins in Plinko"];
                const int = setInterval(() => { setTicker(ACTIONS[Math.floor(Math.random() * ACTIONS.length)]); }, 5000);
                return () => clearInterval(int);
            }, []);
            return React.createElement('div', { className: "bg-black/40 border-b border-white/5 py-1 px-4 flex justify-center overflow-hidden" }, React.createElement('p', { className: "text-[10px] text-gray-400 whitespace-nowrap animate-pulse flex items-center gap-2" }, React.createElement(CircleDot, { size: 8, className: "text-green-500 animate-ping" }), ticker));
        };

        const shouldHouseWin = () => Math.random() < 0.8;
        const logGame = async (userId, username, game, bet, win, profit) => {
            if(!userId || userId === 'admin') return;
            try { await addDoc(collection(db, "game_logs"), { userId, username, game, bet, win, profit, date: new Date().toISOString() }); } catch(e) { console.error("Log Error", e); }
        };

        // --- CONSTANTS ---
        const COUNTRIES = [{ code: 'MA', name: 'Morocco', prefix: '+212', flag: 'ðŸ‡²ðŸ‡¦' }, { code: 'DZ', name: 'Algeria', prefix: '+213', flag: 'ðŸ‡©ðŸ‡¿' }, { code: 'TN', name: 'Tunisia', prefix: '+216', flag: 'ðŸ‡¹ðŸ‡³' }, { code: 'EG', name: 'Egypt', prefix: '+20', flag: 'ðŸ‡ªðŸ‡¬' }, { code: 'SA', name: 'Saudi Arabia', prefix: '+966', flag: 'ðŸ‡¸ðŸ‡¦' }, { code: 'AE', name: 'UAE', prefix: '+971', flag: 'ðŸ‡¦ðŸ‡ª' }, { code: 'US', name: 'USA', prefix: '+1', flag: 'ðŸ‡ºðŸ‡¸' }];

        const TEXTS = {
            ar: {
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹", login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", register: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
                name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„", phone: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", user: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
                home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", casino: "ÙƒØ§Ø²ÙŠÙ†Ùˆ", tasks: "Ø§Ù„Ù…Ù‡Ø§Ù…", wallet: "Ø§Ù„Ù…Ø­ÙØ¸Ø©",
                settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", logout: "Ø®Ø±ÙˆØ¬", success: "Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©", error: "Ø­Ø¯Ø« Ø®Ø·Ø£",
                you_get: "Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª", you_lose: "Ø­Ø¸ Ø£ÙˆÙØ±",
                inputs_err: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©", must_agree: "ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·",
                reset_req: "Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", pass_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
                big_win: "ÙÙˆØ² Ø£Ø³Ø·ÙˆØ±ÙŠ!", you_lost: "Ø®Ø³Ø§Ø±Ø© Ù…Ø¤Ù„Ù…Ø©", update_success: "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                terms: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø§Ø­ÙƒØ§Ù…", policy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©", history: "Ø§Ù„Ø³Ø¬Ù„",
                deposit: "Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨", withdraw: "Ø³Ø­Ø¨ Ø§Ù„Ø§Ø±Ø¨Ø§Ø­", exchange: "ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª",
                amount: "Ø§Ù„Ù…Ø¨Ù„Øº", proof_needed: "Ø§Ù„Ù…Ø±Ø¬Ùˆ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆØ±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©", upload_proof: "Ø±ÙØ¹ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹",
                method_bank: "ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ", method_cash: "ÙƒØ§Ø´ Ø¨Ù„Ø³ / ÙˆØ§ÙØ§", method_crypto: "Ø¹Ù…Ù„Ø§Øª Ø±Ù‚Ù…ÙŠØ©", method_recharge: "ØªØ¹Ø¨Ø¦Ø© Ø±ØµÙŠØ¯",
                rib: "Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¨Ù†ÙƒÙŠ (RIB)", bank_name: "Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ", cnie: "Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ©", wallet_addr: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© (USDT)",
                req_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", req_wait: "Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹.", network: "Ø§Ù„Ø´Ø¨ÙƒØ©",
                personal_info: "Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©", old_pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©", new_pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
                wait_admin: "Ø­Ø³Ø§Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...", menu: "Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©", lang: "Ø§Ù„Ù„ØºØ©",
                crash: "ÙƒØ±Ø§Ø´ (Ø·ÙŠØ§Ø±)", slots: "Ø³Ù„ÙˆØªØ³", keno: "ÙƒÙŠÙ†Ùˆ", limbo: "Ù„ÙŠÙ…Ø¨Ùˆ", coinflip: "Ø¹Ù…Ù„Ø©",
                mines: "Ø§Ù„Ø£Ù„ØºØ§Ù…", plinko: "Ø¨Ù„ÙŠÙ†ÙƒÙˆ", dice: "Ù†Ø±Ø¯", wheel: "Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸", hilo: "Ù‡Ø§ÙŠ Ù„Ùˆ",
                crashed: "ØªØ­Ø·Ù…", bet_placed: "ØªÙ… Ø§Ù„Ø±Ù‡Ø§Ù†", play: "Ù„Ø¹Ø¨", cashout: "Ø³Ø­Ø¨", rolling: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù„Ø¹Ø¨...",
                convert: "ØªØ­ÙˆÙŠÙ„", processing: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...", execute: "ØªÙ†ÙÙŠØ°", no_tasks: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹",
                terms_link: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…", agree_terms: "Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ",
                user_id_label: "Ø§Ù„Ù…Ø¹Ø±Ù / Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                email_sent_title: "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­",
                email_sent_desc: "Ø±Ø§Ø¬Ø¹ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±."
            },
            en: {
                welcome: "Welcome", login: "Login", register: "Register",
                name: "Full Name", phone: "Phone", email: "Email", user: "Username", pass: "Password",
                home: "Home", casino: "Casino", tasks: "Tasks", wallet: "Wallet",
                settings: "Settings", logout: "Logout", success: "Success", error: "Error",
                you_get: "YOU WIN", you_lose: "YOU LOSE",
                inputs_err: "Missing Inputs", must_agree: "You must agree to the Terms",
                reset_req: "Password Reset", pass_sent: "Password sent to your email",
                big_win: "LEGENDARY WIN!", you_lost: "CRITICAL LOSS", update_success: "Info Updated",
                terms: "Terms of Service", policy: "Privacy Policy", history: "History",
                deposit: "Deposit", withdraw: "Withdraw", exchange: "Exchange",
                amount: "Amount", proof_needed: "Transfer amount & upload proof", upload_proof: "Upload Proof",
                method_bank: "Bank Transfer", method_cash: "Cash Plus", method_crypto: "Crypto", method_recharge: "Mobile Recharge",
                rib: "RIB / Account Num", bank_name: "Bank Name", cnie: "National ID", wallet_addr: "Wallet Address",
                req_sent: "Request Sent", req_wait: "Your request is under review.", network: "Network",
                personal_info: "Personal Info", old_pass: "Old Password", new_pass: "New Password",
                wait_admin: "Account under review, please wait...", menu: "Menu", lang: "Language",
                crash: "Crash", slots: "Slots", keno: "Keno", limbo: "Limbo", coinflip: "CoinFlip",
                mines: "Mines", plinko: "Plinko", dice: "Dice", wheel: "Wheel", hilo: "HiLo",
                crashed: "CRASHED", bet_placed: "Bet Placed", play: "PLAY", cashout: "CASHOUT", rolling: "Rolling...",
                convert: "Convert", processing: "Processing...", execute: "Execute", no_tasks: "No Tasks",
                terms_link: "Terms & Conditions", agree_terms: "I agree to ",
                user_id_label: "Username / ID",
                email_sent_title: "Email Sent",
                email_sent_desc: "Check your email inbox to recover password."
            }
        };

        const DEFAULT_TERMS = "Terms...";
        const DEFAULT_POLICY = "Policy...";

        // --- COMPONENTS ---
        const Button = ({ children, onClick, disabled, variant='gold', full, className='', icon: Icon, loading }) => {
            const base = "relative font-bold py-3.5 px-6 rounded-xl transition-all flex items-center justify-center gap-2 btn-press disabled:opacity-50 disabled:grayscale select-none disabled:pointer-events-none overflow-hidden";
            const styles = {
                gold: 'bg-gradient-to-b from-[#FFD700] to-[#B8860B] text-black shadow-[0_4px_15px_rgba(255,215,0,0.3)] border border-[#FFD700]',
                green: 'bg-gradient-to-b from-emerald-500 to-emerald-700 text-white border border-emerald-500 shadow-[0_4px_15px_rgba(16,185,129,0.3)]',
                red: 'bg-gradient-to-b from-red-500 to-red-700 text-white border border-red-500 shadow-[0_4px_15px_rgba(239,68,68,0.3)]',
                dark: 'bg-dark-800 text-gold-500 border border-gold-500/30 hover:bg-dark-700'
            };
            const clickHandler = (e) => {
                if(!disabled && !loading) {
                    AudioSys.click();
                    hapticFeedback('soft');
                    onClick && onClick(e);
                }
            }
            return React.createElement('button', { type: "button", onClick: clickHandler, disabled: disabled || loading, className: `${base} ${styles[variant]} ${full?'w-full':''} ${className}` }, 
                loading ? React.createElement('div', { className: "loader" }) : React.createElement(React.Fragment, null, Icon && React.createElement(Icon, { size: 20 }), children)
            );
        };

        const Input = (props) => React.createElement('div', { className: "relative group w-full" },
            props.icon && React.createElement(props.icon, { size: 18, className: "absolute top-1/2 -translate-y-1/2 right-4 text-gray-500 group-focus-within:text-gold-500 transition-colors" }),
            React.createElement('input', { ...props, className: `w-full bg-dark-900 border border-white/10 p-4 ${props.icon?'pr-12':''} rounded-xl text-white outline-none focus:border-gold-500 focus:shadow-[0_0_10px_rgba(255,215,0,0.2)] transition-all placeholder:text-gray-600 shadow-inner ${props.className}`, onFocus: () => AudioSys.init() })
        );

        const OddsBadge = ({ value, label }) => {
             return React.createElement('div', { className: "absolute top-2 left-2 z-20 flex items-center gap-1.5 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-gold-500/30 shadow-lg" },
                React.createElement(Target, { size: 12, className: "text-gold-500" }),
                React.createElement('div', { className: "flex flex-col leading-none" },
                    React.createElement('span', { className: "text-[8px] text-gray-400 font-bold uppercase" }, label || "ODD"),
                    React.createElement('span', { className: "text-[10px] font-mono font-bold text-white" }, value)
                )
             );
        };

        const StatusModal = ({ title, msg, type='success', onClose }) => {
            useEffect(() => { type==='success'?AudioSys.success():AudioSys.error(); }, []);
            return React.createElement('div', { className: "fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6 animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 border border-gold-500/30 w-full max-w-sm rounded-2xl p-6 relative animate-pop text-center" },
                    React.createElement('div', { className: "w-20 h-20 mx-auto mb-4 rounded-full bg-green-500/20 flex items-center justify-center" },
                        React.createElement(CheckCircle, { size: 40, className: "text-green-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, title),
                    React.createElement('p', { className: "text-gray-400 mb-6 text-sm" }, msg),
                    React.createElement(Button, { full: true, onClick: onClose }, "OK")
                )
            );
        };

        const GameResultModal = ({ win, amount, onClose, t }) => {
            useEffect(() => {
                if(win) { AudioSys.win(); hapticFeedback('success'); }
                else { AudioSys.error(); hapticFeedback('error'); }
                const timer = setTimeout(onClose, 2500);
                return () => clearTimeout(timer);
            }, [onClose]);

            return React.createElement('div', { className: "fixed inset-0 z-[60] flex items-center justify-center glass-modal animate-fade-in" },
                React.createElement(WinParticles, { active: win }),
                !win && React.createElement('div', { className: "cracked-screen animate-loss-shake" }),
                win && React.createElement('div', { className: "absolute inset-0 gold-sparkle pointer-events-none" }),
                
                React.createElement('div', { className: `relative p-10 rounded-3xl text-center transform transition-all border border-white/10 shadow-2xl ${win ? 'bg-gradient-to-br from-gold-900/80 to-black animate-pop scale-110' : 'bg-gradient-to-br from-red-950/90 to-black animate-shake-hard'}` },
                    win ? React.createElement(React.Fragment, null,
                        React.createElement('div', { className: "absolute inset-0 bg-gold-500/20 blur-3xl rounded-full animate-pulse-glow" }),
                        React.createElement('div', { className: "relative z-10" },
                            React.createElement(Crown, { size: 80, className: "mx-auto text-gold-400 mb-4 animate-win-pulse drop-shadow-[0_0_20px_#FFD700]" }),
                            React.createElement('h1', { className: "text-6xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-100 to-yellow-600 font-oswald text-glow uppercase tracking-widest" }, t('big_win')),
                            React.createElement('p', { className: "text-5xl font-mono font-black text-white mt-4 text-glow" }, `+${amount}`)
                        )
                    ) : React.createElement(React.Fragment, null,
                        React.createElement('div', { className: "absolute inset-0 bg-red-600/10 blur-3xl rounded-full" }),
                        React.createElement('div', { className: "relative z-10" },
                            React.createElement(Ban, { size: 80, className: "mx-auto text-red-600 mb-4 opacity-80 drop-shadow-[0_0_15px_red]" }),
                            React.createElement('h1', { className: "text-5xl font-black text-red-600 font-oswald text-glow-red uppercase tracking-widest" }, t('you_lost')),
                            React.createElement('p', { className: "text-xl text-gray-400 mt-2 font-bold tracking-wide" }, "BETTER LUCK NEXT TIME")
                        )
                    )
                )
            );
        };

        const convertToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        // --- APP ROOT ---
        export default function App() {
            const [splash, setSplash] = useState(true);
            const [user, setUser] = useState(null);
            const [view, setView] = useState('auth'); 
            const [lang, setLang] = useState('ar');
            const [notify, setNotify] = useState(null);
            const [menuOpen, setMenuOpen] = useState(false);
            const [settings, setSettings] = useState({});

            const t = (k) => TEXTS[lang][k] || k;
            
            useEffect(() => { 
                const initAudio = () => AudioSys.init();
                window.addEventListener('click', initAudio, { once: true });
                setTimeout(() => setSplash(false), 2500); 
                return () => window.removeEventListener('click', initAudio);
            }, []);
            
            useEffect(() => { if(db) onSnapshot(doc(db, "settings", "global"), (s) => s.exists() && setSettings(s.data())); }, []);

            useEffect(() => {
                const uid = localStorage.getItem('cd0777_uid');
                if (uid && db) {
                    if (uid === 'admin') { setUser({role: 'admin', username: 'Admin'}); return; }
                    const unsub = onSnapshot(doc(db, "users", uid), (s) => {
                        if (s.exists()) {
                            setUser({ id: s.id, ...s.data() });
                            if(s.data().status === 'banned') { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); }
                        } else { setUser(null); localStorage.removeItem('cd0777_uid'); setView('auth'); }
                    });
                    return () => unsub();
                }
            }, []);

            useEffect(() => { if (user && view === 'auth') setView(user.role === 'admin' ? 'admin' : 'home'); }, [user]);

            const showMsg = (msg, type='success') => { 
                setNotify({msg, type}); 
                if(type === 'success') AudioSys.coins();
                else hapticFeedback('error');
                setTimeout(()=>setNotify(null), 3000); 
            };
            const navTo = (v) => { setView(v); setMenuOpen(false); AudioSys.click(); };
            const logout = () => { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); };
            const isRTL = lang === 'ar';
            const ArrowIcon = isRTL ? ChevronRight : ChevronLeft;

            if (splash) return React.createElement(SplashScreen);
            if (!user && (view === 'auth' || view === 'forgot')) {
                if(view === 'auth') return React.createElement(AuthScreen, { setUser, setView, showMsg, t, lang, setLang });
                if(view === 'forgot') return React.createElement(ForgotPassScreen, { setView, showMsg, t, ArrowIcon });
            }
            if (user && user.status === 'pending') return React.createElement(PendingActivationScreen, { user, logout, t, isRTL, showMsg, settings });
            if (user?.role === 'admin' && view === 'admin') return React.createElement(AdminPanel, { user, logout, db, showMsg, t });

            const GameProps = { user, back: ()=>navTo('casino'), showMsg, ArrowIcon, t, isRTL, db, logGame };

            if (view === 'game-crash') return React.createElement(CrashGame, GameProps);
            if (view === 'game-slots') return React.createElement(SlotsGame, GameProps);
            if (view === 'game-keno') return React.createElement(KenoGame, GameProps);
            if (view === 'game-limbo') return React.createElement(LimboGame, GameProps);
            if (view === 'game-coinflip') return React.createElement(CoinFlipGame, GameProps);
            if (view === 'game-mines') return React.createElement(MinesGame, GameProps);
            if (view === 'game-plinko') return React.createElement(PlinkoGame, GameProps);
            if (view === 'game-dice') return React.createElement(DiceGame, GameProps);
            if (view === 'game-wheel') return React.createElement(WheelGame, GameProps);
            if (view === 'game-hilo') return React.createElement(HiLoGame, GameProps);

            return React.createElement('div', { className: `h-screen flex flex-col bg-dark-950 text-white relative selection:bg-gold-500 selection:text-black`, dir: isRTL ? 'rtl' : 'ltr' },
                notify && React.createElement('div', { className: `fixed top-12 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-xl shadow-2xl border flex items-center gap-3 animate-pop glass-panel w-max max-w-[90%] ${notify.type==='error'?'bg-red-950/90 border-red-500':'bg-green-950/90 border-green-500'}` }, 
                    notify.type==='success'?React.createElement(CheckCircle,{size:24, className:"text-green-400"}):React.createElement(XCircle,{size:24, className:"text-red-400"}), 
                    React.createElement('span', { className: "font-bold text-sm" }, notify.msg)
                ),
                React.createElement(LiveTicker, { t }),
                React.createElement(Header, { user, toggleMenu: ()=>setMenuOpen(true) }),
                menuOpen && React.createElement(Sidebar, { user, close: ()=>setMenuOpen(false), navTo, t, lang, setLang, settings, logout }),
                React.createElement(ChatWidget, { user, t, isRTL }),
                React.createElement('main', { className: "flex-1 overflow-y-auto p-5 pb-28 z-10 scrollbar-hide" },
                    view === 'home' && React.createElement(HomeScreen, { user, navTo, t }),
                    view === 'casino' && React.createElement(CasinoScreen, { navTo, t }),
                    view === 'tasks' && React.createElement(TasksScreen, { user, showMsg, t }),
                    view === 'profile' && React.createElement(WalletScreen, { user, showMsg, t, isRTL, navTo }),
                    view === 'deposit' && React.createElement(DepositScreen, { user, showMsg, t, settings, back: ()=>navTo('profile') }),
                    view === 'withdraw' && React.createElement(WithdrawScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'exchange' && React.createElement(ExchangeScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'history' && React.createElement(HistoryScreen, { user, t, back: ()=>navTo('profile') }),
                    view === 'settings' && React.createElement(SettingsScreen, { user, showMsg, t, back: ()=>navTo('profile'), db }),
                    view === 'terms' && React.createElement(InfoPage, { title: t('terms'), content: settings.terms || DEFAULT_TERMS, back: ()=>navTo('profile'), settings }),
                    view === 'policy' && React.createElement(InfoPage, { title: t('policy'), content: settings.policy || DEFAULT_POLICY, back: ()=>navTo('profile'), settings })
                ),
                view !== 'settings' && React.createElement('nav', { className: "fixed bottom-4 left-4 right-4 h-16 glass-panel rounded-2xl z-40 flex justify-around items-center shadow-2xl border border-white/10 backdrop-blur-md" },
                    React.createElement(NavBtn, { icon: Home, label: t('home'), active: view==='home', onClick:()=>navTo('home') }),
                    React.createElement(NavBtn, { icon: Dices, label: t('casino'), active: view==='casino', onClick:()=>navTo('casino') }),
                    React.createElement(NavBtn, { icon: Trophy, label: t('tasks'), active: view==='tasks', onClick:()=>navTo('tasks') }),
                    React.createElement(NavBtn, { icon: Wallet, label: t('wallet'), active: view==='profile', onClick:()=>navTo('profile') })
                )
            );
        }
        <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CD0777 Elite Club - Tier 1 Experience</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: { 100: '#FFF9C4', 300: '#FDD835', 400: '#FFD700', 500: '#FFC107', 600: '#FFB300', 700: '#FFA000', 800: '#C0A000', 900: '#3d2e07' },
                        dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' },
                        elite: { 500: '#e0e7ff', 900: '#312e81' }
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                        oswald: ['Oswald', 'sans-serif']
                    },
                    animation: {
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'shake-hard': 'shakeHard 0.4s ease-in-out',
                        'flip': 'flip 0.6s ease-in-out forwards',
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'float-up': 'floatUp 1.5s ease-out forwards',
                        'pulse-glow': 'pulseGlow 1.5s infinite',
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'rocket-fly': 'rocketFly 0.5s ease-in-out infinite alternate',
                        'shine': 'shine 2s infinite',
                        'spin-slow': 'spin 1s linear infinite',
                        'win-pulse': 'winPulse 0.8s infinite alternate',
                        'loss-shake': 'lossShake 0.5s',
                        'gold-rain': 'goldRain 3s linear infinite',
                        'slide-in-right': 'slideInRight 0.3s ease-out',
                    },
                    keyframes: {
                        pop: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        shakeHard: { '0%, 100%': { transform: 'translateX(0)' }, '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-10px)' }, '20%, 40%, 60%, 80%': { transform: 'translateX(10px)' } },
                        flip: { '0%': { transform: 'rotateY(0)' }, '100%': { transform: 'rotateY(180deg)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        floatUp: { '0%': { transform: 'translateY(0) scale(1)', opacity: '1' }, '100%': { transform: 'translateY(-50px) scale(1.2)', opacity: '0' } },
                        pulseGlow: { '0%, 100%': { boxShadow: '0 0 10px #FFD700' }, '50%': { boxShadow: '0 0 25px #FFD700' } },
                        slideUp: { '0%': { transform: 'translateY(50px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        rocketFly: { '0%': { transform: 'translateY(0)' }, '100%': { transform: 'translateY(-5px)' } },
                        shine: { '0%': { backgroundPosition: '200% center' }, '100%': { backgroundPosition: '-200% center' } },
                        winPulse: { '0%': { transform: 'scale(1)', filter: 'brightness(1)' }, '100%': { transform: 'scale(1.05)', filter: 'brightness(1.3)' } },
                        lossShake: { '0%, 100%': { transform: 'translate(0, 0)' }, '25%': { transform: 'translate(-5px, 5px)' }, '50%': { transform: 'translate(5px, -5px)' }, '75%': { transform: 'translate(-5px, -5px)' } },
                        goldRain: { '0%': { backgroundPosition: '0 0' }, '100%': { backgroundPosition: '0 1000px' } },
                        slideInRight: { '0%': { transform: 'translateX(100%)' }, '100%': { transform: 'translateX(0)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Oswald:wght@500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #fff; overflow: hidden; touch-action: manipulation; font-family: 'Cairo', sans-serif; }
        .glass-panel { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.08); }
        .luxury-bg { background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
        input, select, button, textarea { outline: none; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }
        
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #FFD700; cursor: pointer; margin-top: -10px; box-shadow: 0 0 10px #FFD700; border: 2px solid white; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }
        
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        
        .btn-press:active { transform: scale(0.95); transition: transform 0.05s; }
        
        .slot-spin { animation: slotSpin 0.08s linear infinite; }
        @keyframes slotSpin { 0% { transform: translateY(-20px); filter: blur(5px); } 100% { transform: translateY(20px); filter: blur(5px); } }

        .coin-container { transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.4, 2, 0.55, 0.44); }
        .coin-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .coin-front { background: radial-gradient(#FFD700, #B8860B); transform: rotateY(0deg); }
        .coin-back { background: radial-gradient(#C0C0C0, #808080); transform: rotateY(180deg); }
        
        .star-bg { background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px; opacity: 0.2; }
        .card-shine { background: linear-gradient(105deg, transparent 20%, rgba(255,255,255,0.4) 25%, transparent 30%); animation: shine 3s infinite linear; background-size: 200% 100%; }
        
        .elite-card-bg { background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%); border: 1px solid rgba(255, 215, 0, 0.3); }
        .hologram { background: linear-gradient(135deg, transparent 0%, rgba(255, 215, 0, 0.1) 50%, transparent 100%); }
        
        .checkbox-wrapper input:checked + div { background-color: #FFD700; border-color: #FFD700; }
        .checkbox-wrapper input:checked + div svg { display: block; }
        
        .loader { border: 3px solid rgba(255,255,255,0.1); border-left-color: #FFD700; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        
        .glass-modal { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 215, 0, 0.1); }
        .text-glow { text-shadow: 0 0 20px #FFD700, 0 0 40px #FFD700; }
        .text-glow-red { text-shadow: 0 0 20px #ef4444, 0 0 40px #991b1b; }
        .cracked-screen {
            position: fixed; inset: 0; pointer-events: none; z-index: 60;
            background: 
                radial-gradient(circle at 50% 50%, transparent 50%, rgba(255,0,0,0.1) 100%),
                linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.1) 50%, transparent 52%);
            box-shadow: inset 0 0 150px rgba(185, 28, 28, 0.5);
            background-size: 100% 100%, 200% 200%;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.294.0",
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>

    <script type="module">
        import React, { useState, useEffect, useRef, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, Gamepad2, LogOut, Send, CheckCircle, XCircle, ChevronRight, ChevronLeft, Lock, Gem, Home, CreditCard, Wallet, ShieldCheck, Trophy, Instagram, Facebook, ExternalLink, Plus, Trash2, Smartphone, Zap, Check, Dices, RefreshCw, Menu, X, AlertTriangle, Settings, History, Globe, FileText, LifeBuoy, ArrowLeftRight, Bomb, ArrowUp, HelpCircle, Flame, Percent, DollarSign, Image as ImageIcon, KeyRound, Upload, Disc, Rocket, Coins, Grid3X3, Target, Crown, Banknote, Landmark, Wifi, ThumbsUp, ThumbsDown, Users, Ban, Edit3, LockKeyhole, LayoutDashboard, UserCheck, PlayCircle, Copy, MessageCircle, Flag, Info, Loader2, Headphones, CircleDot, MoveUp, Mail, Star, Bell, Speaker } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, where, getDocs, orderBy, setDoc, getDoc, deleteDoc } from 'firebase/firestore';

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyDJ5B7MncMfyjwb0ZnZ8p3d0bsoQAFqZQY",
            authDomain: "cd0777-casino.firebaseapp.com",
            projectId: "cd0777-casino",
            storageBucket: "cd0777-casino.firebasestorage.app",
            messagingSenderId: "320546250152",
            appId: "1:320546250152:web:730f6e581267b9b315919d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- TIER 1: SOUND ENGINE (Procedural Audio) ---
        const AudioSys = {
            ctx: null,
            init: () => {
                if (!AudioSys.ctx) {
                    AudioSys.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
                if(AudioSys.ctx.state === 'suspended') AudioSys.ctx.resume();
            },
            playTone: (freq, type, duration, vol=0.1) => {
                if(!AudioSys.ctx) return;
                const osc = AudioSys.ctx.createOscillator();
                const gain = AudioSys.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, AudioSys.ctx.currentTime);
                gain.gain.setValueAtTime(vol, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, AudioSys.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                osc.start();
                osc.stop(AudioSys.ctx.currentTime + duration);
            },
            click: () => { AudioSys.init(); AudioSys.playTone(800, 'triangle', 0.05, 0.05); },
            success: () => { 
                AudioSys.init(); 
                [440, 554, 659].forEach((f,i) => setTimeout(() => AudioSys.playTone(f, 'sine', 0.3, 0.1), i*100)); 
            },
            error: () => { 
                AudioSys.init(); 
                AudioSys.playTone(150, 'sawtooth', 0.3, 0.1); 
            },
            spin: () => { AudioSys.init(); AudioSys.playTone(200, 'square', 0.05, 0.03); },
            win: () => {
                AudioSys.init();
                const notes = [523.25, 659.25, 783.99, 1046.50, 783.99, 1046.50];
                notes.forEach((n, i) => setTimeout(() => AudioSys.playTone(n, 'square', 0.2, 0.1), i*120));
            },
            crash: () => {
                AudioSys.init();
                const bufferSize = AudioSys.ctx.sampleRate * 0.5;
                const buffer = AudioSys.ctx.createBuffer(1, bufferSize, AudioSys.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for(let i=0; i<bufferSize; i++) data[i] = Math.random() * 2 - 1;
                const noise = AudioSys.ctx.createBufferSource();
                noise.buffer = buffer;
                const gain = AudioSys.ctx.createGain();
                gain.gain.setValueAtTime(0.2, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, AudioSys.ctx.currentTime + 0.5);
                noise.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                noise.start();
            },
            coins: () => {
                 AudioSys.init();
                 for(let i=0; i<5; i++) setTimeout(()=> AudioSys.playTone(2000 + Math.random()*1000, 'sine', 0.1, 0.05), i*50);
            }
        };

        // --- TIER 1: HAPTICS & UX ---
        const hapticFeedback = (type) => {
            if (navigator.vibrate) {
                if(type === 'soft') navigator.vibrate(10);
                if(type === 'success') navigator.vibrate([50, 50, 50]);
                if(type === 'error') navigator.vibrate([50, 100, 50]);
                if(type === 'impact') navigator.vibrate(40);
            }
        };

        // --- TIER 1: CANVAS VFX (PARTICLE SYSTEM) ---
        const WinParticles = ({ active }) => {
            const canvasRef = useRef(null);
            useEffect(() => {
                if(!active) return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                let particles = [];
                for(let i=0; i<100; i++) {
                    particles.push({
                        x: canvas.width/2, y: canvas.height/2,
                        vx: (Math.random() - 0.5) * 15, vy: (Math.random() - 0.5) * 15,
                        life: 1, color: Math.random() > 0.5 ? '#FFD700' : '#FFF'
                    });
                }
                const render = () => {
                    ctx.clearRect(0,0, canvas.width, canvas.height);
                    particles.forEach((p, i) => {
                        p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life -= 0.01;
                        ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI*2);
                        ctx.fillStyle = p.color; ctx.globalAlpha = p.life; ctx.fill();
                        if(p.life <= 0) particles.splice(i, 1);
                    });
                    if(particles.length > 0) requestAnimationFrame(render);
                };
                render();
            }, [active]);
            if(!active) return null;
            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[70]" });
        };

        // --- TIER 1: COMMUNITY CHAT WIDGET ---
        const ChatWidget = ({ user, t, isRTL }) => {
            const [isOpen, setIsOpen] = useState(false);
            const [msgs, setMsgs] = useState([
                { u: 'Ahmed_99', m: 'Big win on Crash! x50 ðŸš€', t: 'Just now' },
                { u: 'SarahPro', m: 'Anyone playing Slots?', t: '1m ago' },
                { u: 'CasinoKing', m: 'This platform is fire ðŸ”¥', t: '2m ago' }
            ]);
            const FAKE_MSGS = ["Just cashed out $500!", "Crash is rigged today lol", "x100 incoming on Plinko", "Who wants a code?", "Lost it all... again", "Admin is fast today", "Nice update!"];
            const FAKE_USERS = ["Momo_X", "RajaClub", "Wydad_Fan", "CryptoWhale", "Hassan22", "Layla_Q"];
            useEffect(() => {
                const interval = setInterval(() => {
                    if(Math.random() > 0.7) {
                        const newMsg = { u: FAKE_USERS[Math.floor(Math.random() * FAKE_USERS.length)], m: FAKE_MSGS[Math.floor(Math.random() * FAKE_MSGS.length)], t: 'Just now' };
                        setMsgs(prev => [newMsg, ...prev.slice(0, 8)]);
                    }
                }, 4000);
                return () => clearInterval(interval);
            }, []);
            return React.createElement(React.Fragment, null,
                React.createElement('button', { onClick: () => { setIsOpen(!isOpen); AudioSys.click(); }, className: "fixed bottom-24 right-4 z-40 bg-gold-500 text-black p-3 rounded-full shadow-[0_0_20px_#FFD700] btn-press" }, React.createElement(MessageCircle, { size: 24 })),
                isOpen && React.createElement('div', { className: `fixed inset-y-0 right-0 w-72 bg-dark-950/95 border-l border-gold-500/20 backdrop-blur-xl z-50 p-4 flex flex-col transition-transform ${isRTL?'left-0 border-r border-l-0':''} animate-slide-in-right` },
                    React.createElement('div', { className: "flex justify-between items-center mb-4 border-b border-white/10 pb-2" }, React.createElement('h3', { className: "text-gold-500 font-bold" }, "Elite Chat"), React.createElement('button', { onClick: ()=>setIsOpen(false) }, React.createElement(X, { className: "text-gray-400" }))),
                    React.createElement('div', { className: "flex-1 overflow-y-auto space-y-3 no-scrollbar" },
                        msgs.map((m, i) => React.createElement('div', { key: i, className: "bg-white/5 p-3 rounded-lg border border-white/5 animate-fade-in" },
                            React.createElement('div', { className: "flex justify-between items-baseline mb-1" }, React.createElement('span', { className: "text-gold-500 text-xs font-bold" }, m.u), React.createElement('span', { className: "text-gray-500 text-[9px]" }, m.t)),
                            React.createElement('p', { className: "text-xs text-gray-200" }, m.m)
                        ))
                    ),
                    React.createElement('div', { className: "mt-2 pt-2 border-t border-white/10" }, React.createElement('input', { disabled: true, placeholder: "Chat disabled for non-VIP", className: "w-full bg-black/40 text-xs p-2 rounded border border-white/5 text-center cursor-not-allowed" }))
                )
            );
        };

        // --- TIER 1: LIVE ACTIVITY TICKER ---
        const LiveTicker = ({ t }) => {
            const [ticker, setTicker] = useState("Welcome to CD0777 Elite Club");
            useEffect(() => {
                const ACTIONS = ["User **82 just withdrew $200 via Bank", "**99 Hit x50 on Crash!", "**12 Deposited $50 via CashPlus", "**05 Won 5000 Coins in Plinko"];
                const int = setInterval(() => { setTicker(ACTIONS[Math.floor(Math.random() * ACTIONS.length)]); }, 5000);
                return () => clearInterval(int);
            }, []);
            return React.createElement('div', { className: "bg-black/40 border-b border-white/5 py-1 px-4 flex justify-center overflow-hidden" }, React.createElement('p', { className: "text-[10px] text-gray-400 whitespace-nowrap animate-pulse flex items-center gap-2" }, React.createElement(CircleDot, { size: 8, className: "text-green-500 animate-ping" }), ticker));
        };

        const shouldHouseWin = () => Math.random() < 0.8;
        const logGame = async (userId, username, game, bet, win, profit) => {
            if(!userId || userId === 'admin') return;
            try { await addDoc(collection(db, "game_logs"), { userId, username, game, bet, win, profit, date: new Date().toISOString() }); } catch(e) { console.error("Log Error", e); }
        };

        // --- CONSTANTS ---
        const COUNTRIES = [{ code: 'MA', name: 'Morocco', prefix: '+212', flag: 'ðŸ‡²ðŸ‡¦' }, { code: 'DZ', name: 'Algeria', prefix: '+213', flag: 'ðŸ‡©ðŸ‡¿' }, { code: 'TN', name: 'Tunisia', prefix: '+216', flag: 'ðŸ‡¹ðŸ‡³' }, { code: 'EG', name: 'Egypt', prefix: '+20', flag: 'ðŸ‡ªðŸ‡¬' }, { code: 'SA', name: 'Saudi Arabia', prefix: '+966', flag: 'ðŸ‡¸ðŸ‡¦' }, { code: 'AE', name: 'UAE', prefix: '+971', flag: 'ðŸ‡¦ðŸ‡ª' }, { code: 'US', name: 'USA', prefix: '+1', flag: 'ðŸ‡ºðŸ‡¸' }];

        const TEXTS = {
            ar: {
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹", login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", register: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
                name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„", phone: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", user: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
                home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", casino: "ÙƒØ§Ø²ÙŠÙ†Ùˆ", tasks: "Ø§Ù„Ù…Ù‡Ø§Ù…", wallet: "Ø§Ù„Ù…Ø­ÙØ¸Ø©",
                settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", logout: "Ø®Ø±ÙˆØ¬", success: "Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©", error: "Ø­Ø¯Ø« Ø®Ø·Ø£",
                you_get: "Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª", you_lose: "Ø­Ø¸ Ø£ÙˆÙØ±",
                inputs_err: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©", must_agree: "ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·",
                reset_req: "Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", pass_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
                big_win: "ÙÙˆØ² Ø£Ø³Ø·ÙˆØ±ÙŠ!", you_lost: "Ø®Ø³Ø§Ø±Ø© Ù…Ø¤Ù„Ù…Ø©", update_success: "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                terms: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø§Ø­ÙƒØ§Ù…", policy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©", history: "Ø§Ù„Ø³Ø¬Ù„",
                deposit: "Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨", withdraw: "Ø³Ø­Ø¨ Ø§Ù„Ø§Ø±Ø¨Ø§Ø­", exchange: "ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª",
                amount: "Ø§Ù„Ù…Ø¨Ù„Øº", proof_needed: "Ø§Ù„Ù…Ø±Ø¬Ùˆ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆØ±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©", upload_proof: "Ø±ÙØ¹ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹",
                method_bank: "ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ", method_cash: "ÙƒØ§Ø´ Ø¨Ù„Ø³ / ÙˆØ§ÙØ§", method_crypto: "Ø¹Ù…Ù„Ø§Øª Ø±Ù‚Ù…ÙŠØ©", method_recharge: "ØªØ¹Ø¨Ø¦Ø© Ø±ØµÙŠØ¯",
                rib: "Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¨Ù†ÙƒÙŠ (RIB)", bank_name: "Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ", cnie: "Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ©", wallet_addr: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© (USDT)",
                req_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", req_wait: "Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹.", network: "Ø§Ù„Ø´Ø¨ÙƒØ©",
                personal_info: "Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©", old_pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©", new_pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
                wait_admin: "Ø­Ø³Ø§Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...", menu: "Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©", lang: "Ø§Ù„Ù„ØºØ©",
                crash: "ÙƒØ±Ø§Ø´ (Ø·ÙŠØ§Ø±)", slots: "Ø³Ù„ÙˆØªØ³", keno: "ÙƒÙŠÙ†Ùˆ", limbo: "Ù„ÙŠÙ…Ø¨Ùˆ", coinflip: "Ø¹Ù…Ù„Ø©",
                mines: "Ø§Ù„Ø£Ù„ØºØ§Ù…", plinko: "Ø¨Ù„ÙŠÙ†ÙƒÙˆ", dice: "Ù†Ø±Ø¯", wheel: "Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸", hilo: "Ù‡Ø§ÙŠ Ù„Ùˆ",
                crashed: "ØªØ­Ø·Ù…", bet_placed: "ØªÙ… Ø§Ù„Ø±Ù‡Ø§Ù†", play: "Ù„Ø¹Ø¨", cashout: "Ø³Ø­Ø¨", rolling: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù„Ø¹Ø¨...",
                convert: "ØªØ­ÙˆÙŠÙ„", processing: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...", execute: "ØªÙ†ÙÙŠØ°", no_tasks: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹",
                terms_link: "Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…", agree_terms: "Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ",
                user_id_label: "Ø§Ù„Ù…Ø¹Ø±Ù / Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                email_sent_title: "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­",
                email_sent_desc: "Ø±Ø§Ø¬Ø¹ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±."
            },
            en: {
                welcome: "Welcome", login: "Login", register: "Register",
                name: "Full Name", phone: "Phone", email: "Email", user: "Username", pass: "Password",
                home: "Home", casino: "Casino", tasks: "Tasks", wallet: "Wallet",
                settings: "Settings", logout: "Logout", success: "Success", error: "Error",
                you_get: "YOU WIN", you_lose: "YOU LOSE",
                inputs_err: "Missing Inputs", must_agree: "You must agree to the Terms",
                reset_req: "Password Reset", pass_sent: "Password sent to your email",
                big_win: "LEGENDARY WIN!", you_lost: "CRITICAL LOSS", update_success: "Info Updated",
                terms: "Terms of Service", policy: "Privacy Policy", history: "History",
                deposit: "Deposit", withdraw: "Withdraw", exchange: "Exchange",
                amount: "Amount", proof_needed: "Transfer amount & upload proof", upload_proof: "Upload Proof",
                method_bank: "Bank Transfer", method_cash: "Cash Plus", method_crypto: "Crypto", method_recharge: "Mobile Recharge",
                rib: "RIB / Account Num", bank_name: "Bank Name", cnie: "National ID", wallet_addr: "Wallet Address",
                req_sent: "Request Sent", req_wait: "Your request is under review.", network: "Network",
                personal_info: "Personal Info", old_pass: "Old Password", new_pass: "New Password",
                wait_admin: "Account under review, please wait...", menu: "Menu", lang: "Language",
                crash: "Crash", slots: "Slots", keno: "Keno", limbo: "Limbo", coinflip: "CoinFlip",
                mines: "Mines", plinko: "Plinko", dice: "Dice", wheel: "Wheel", hilo: "HiLo",
                crashed: "CRASHED", bet_placed: "Bet Placed", play: "PLAY", cashout: "CASHOUT", rolling: "Rolling...",
                convert: "Convert", processing: "Processing...", execute: "Execute", no_tasks: "No Tasks",
                terms_link: "Terms & Conditions", agree_terms: "I agree to ",
                user_id_label: "Username / ID",
                email_sent_title: "Email Sent",
                email_sent_desc: "Check your email inbox to recover password."
            }
        };

        const DEFAULT_TERMS = "Terms...";
        const DEFAULT_POLICY = "Policy...";

        // --- COMPONENTS ---
        const Button = ({ children, onClick, disabled, variant='gold', full, className='', icon: Icon, loading }) => {
            const base = "relative font-bold py-3.5 px-6 rounded-xl transition-all flex items-center justify-center gap-2 btn-press disabled:opacity-50 disabled:grayscale select-none disabled:pointer-events-none overflow-hidden";
            const styles = {
                gold: 'bg-gradient-to-b from-[#FFD700] to-[#B8860B] text-black shadow-[0_4px_15px_rgba(255,215,0,0.3)] border border-[#FFD700]',
                green: 'bg-gradient-to-b from-emerald-500 to-emerald-700 text-white border border-emerald-500 shadow-[0_4px_15px_rgba(16,185,129,0.3)]',
                red: 'bg-gradient-to-b from-red-500 to-red-700 text-white border border-red-500 shadow-[0_4px_15px_rgba(239,68,68,0.3)]',
                dark: 'bg-dark-800 text-gold-500 border border-gold-500/30 hover:bg-dark-700'
            };
            const clickHandler = (e) => {
                if(!disabled && !loading) {
                    AudioSys.click();
                    hapticFeedback('soft');
                    onClick && onClick(e);
                }
            }
            return React.createElement('button', { type: "button", onClick: clickHandler, disabled: disabled || loading, className: `${base} ${styles[variant]} ${full?'w-full':''} ${className}` }, 
                loading ? React.createElement('div', { className: "loader" }) : React.createElement(React.Fragment, null, Icon && React.createElement(Icon, { size: 20 }), children)
            );
        };

        const Input = (props) => React.createElement('div', { className: "relative group w-full" },
            props.icon && React.createElement(props.icon, { size: 18, className: "absolute top-1/2 -translate-y-1/2 right-4 text-gray-500 group-focus-within:text-gold-500 transition-colors" }),
            React.createElement('input', { ...props, className: `w-full bg-dark-900 border border-white/10 p-4 ${props.icon?'pr-12':''} rounded-xl text-white outline-none focus:border-gold-500 focus:shadow-[0_0_10px_rgba(255,215,0,0.2)] transition-all placeholder:text-gray-600 shadow-inner ${props.className}`, onFocus: () => AudioSys.init() })
        );

        const OddsBadge = ({ value, label }) => {
             return React.createElement('div', { className: "absolute top-2 left-2 z-20 flex items-center gap-1.5 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-gold-500/30 shadow-lg" },
                React.createElement(Target, { size: 12, className: "text-gold-500" }),
                React.createElement('div', { className: "flex flex-col leading-none" },
                    React.createElement('span', { className: "text-[8px] text-gray-400 font-bold uppercase" }, label || "ODD"),
                    React.createElement('span', { className: "text-[10px] font-mono font-bold text-white" }, value)
                )
             );
        };

        const StatusModal = ({ title, msg, type='success', onClose }) => {
            useEffect(() => { type==='success'?AudioSys.success():AudioSys.error(); }, []);
            return React.createElement('div', { className: "fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6 animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 border border-gold-500/30 w-full max-w-sm rounded-2xl p-6 relative animate-pop text-center" },
                    React.createElement('div', { className: "w-20 h-20 mx-auto mb-4 rounded-full bg-green-500/20 flex items-center justify-center" },
                        React.createElement(CheckCircle, { size: 40, className: "text-green-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, title),
                    React.createElement('p', { className: "text-gray-400 mb-6 text-sm" }, msg),
                    React.createElement(Button, { full: true, onClick: onClose }, "OK")
                )
            );
        };

        const GameResultModal = ({ win, amount, onClose, t }) => {
            useEffect(() => {
                if(win) { AudioSys.win(); hapticFeedback('success'); }
                else { AudioSys.error(); hapticFeedback('error'); }
                const timer = setTimeout(onClose, 2500);
                return () => clearTimeout(timer);
            }, [onClose]);

            return React.createElement('div', { className: "fixed inset-0 z-[60] flex items-center justify-center glass-modal animate-fade-in" },
                React.createElement(WinParticles, { active: win }),
                !win && React.createElement('div', { className: "cracked-screen animate-loss-shake" }),
                win && React.createElement('div', { className: "absolute inset-0 gold-sparkle pointer-events-none" }),
                
                React.createElement('div', { className: `relative p-10 rounded-3xl text-center transform transition-all border border-white/10 shadow-2xl ${win ? 'bg-gradient-to-br from-gold-900/80 to-black animate-pop scale-110' : 'bg-gradient-to-br from-red-950/90 to-black animate-shake-hard'}` },
                    win ? React.createElement(React.Fragment, null,
                        React.createElement('div', { className: "absolute inset-0 bg-gold-500/20 blur-3xl rounded-full animate-pulse-glow" }),
                        React.createElement('div', { className: "relative z-10" },
                            React.createElement(Crown, { size: 80, className: "mx-auto text-gold-400 mb-4 animate-win-pulse drop-shadow-[0_0_20px_#FFD700]" }),
                            React.createElement('h1', { className: "text-6xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-100 to-yellow-600 font-oswald text-glow uppercase tracking-widest" }, t('big_win')),
                            React.createElement('p', { className: "text-5xl font-mono font-black text-white mt-4 text-glow" }, `+${amount}`)
                        )
                    ) : React.createElement(React.Fragment, null,
                        React.createElement('div', { className: "absolute inset-0 bg-red-600/10 blur-3xl rounded-full" }),
                        React.createElement('div', { className: "relative z-10" },
                            React.createElement(Ban, { size: 80, className: "mx-auto text-red-600 mb-4 opacity-80 drop-shadow-[0_0_15px_red]" }),
                            React.createElement('h1', { className: "text-5xl font-black text-red-600 font-oswald text-glow-red uppercase tracking-widest" }, t('you_lost')),
                            React.createElement('p', { className: "text-xl text-gray-400 mt-2 font-bold tracking-wide" }, "BETTER LUCK NEXT TIME")
                        )
                    )
                )
            );
        };

        const convertToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        // --- APP ROOT ---
        export default function App() {
            const [splash, setSplash] = useState(true);
            const [user, setUser] = useState(null);
            const [view, setView] = useState('auth'); 
            const [lang, setLang] = useState('ar');
            const [notify, setNotify] = useState(null);
            const [menuOpen, setMenuOpen] = useState(false);
            const [settings, setSettings] = useState({});

            const t = (k) => TEXTS[lang][k] || k;
            
            useEffect(() => { 
                const initAudio = () => AudioSys.init();
                window.addEventListener('click', initAudio, { once: true });
                setTimeout(() => setSplash(false), 2500); 
                return () => window.removeEventListener('click', initAudio);
            }, []);
            
            useEffect(() => { if(db) onSnapshot(doc(db, "settings", "global"), (s) => s.exists() && setSettings(s.data())); }, []);

            useEffect(() => {
                const uid = localStorage.getItem('cd0777_uid');
                if (uid && db) {
                    if (uid === 'admin') { setUser({role: 'admin', username: 'Admin'}); return; }
                    const unsub = onSnapshot(doc(db, "users", uid), (s) => {
                        if (s.exists()) {
                            setUser({ id: s.id, ...s.data() });
                            if(s.data().status === 'banned') { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); }
                        } else { setUser(null); localStorage.removeItem('cd0777_uid'); setView('auth'); }
                    });
                    return () => unsub();
                }
            }, []);

            useEffect(() => { if (user && view === 'auth') setView(user.role === 'admin' ? 'admin' : 'home'); }, [user]);

            const showMsg = (msg, type='success') => { 
                setNotify({msg, type}); 
                if(type === 'success') AudioSys.coins();
                else hapticFeedback('error');
                setTimeout(()=>setNotify(null), 3000); 
            };
            const navTo = (v) => { setView(v); setMenuOpen(false); AudioSys.click(); };
            const logout = () => { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); };
            const isRTL = lang === 'ar';
            const ArrowIcon = isRTL ? ChevronRight : ChevronLeft;

            if (splash) return React.createElement(SplashScreen);
            if (!user && (view === 'auth' || view === 'forgot')) {
                if(view === 'auth') return React.createElement(AuthScreen, { setUser, setView, showMsg, t, lang, setLang });
                if(view === 'forgot') return React.createElement(ForgotPassScreen, { setView, showMsg, t, ArrowIcon });
            }
            if (user && user.status === 'pending') return React.createElement(PendingActivationScreen, { user, logout, t, isRTL, showMsg, settings });
            if (user?.role === 'admin' && view === 'admin') return React.createElement(AdminPanel, { user, logout, db, showMsg, t });

            const GameProps = { user, back: ()=>navTo('casino'), showMsg, ArrowIcon, t, isRTL, db, logGame };

            if (view === 'game-crash') return React.createElement(CrashGame, GameProps);
            if (view === 'game-slots') return React.createElement(SlotsGame, GameProps);
            if (view === 'game-keno') return React.createElement(KenoGame, GameProps);
            if (view === 'game-limbo') return React.createElement(LimboGame, GameProps);
            if (view === 'game-coinflip') return React.createElement(CoinFlipGame, GameProps);
            if (view === 'game-mines') return React.createElement(MinesGame, GameProps);
            if (view === 'game-plinko') return React.createElement(PlinkoGame, GameProps);
            if (view === 'game-dice') return React.createElement(DiceGame, GameProps);
            if (view === 'game-wheel') return React.createElement(WheelGame, GameProps);
            if (view === 'game-hilo') return React.createElement(HiLoGame, GameProps);

            return React.createElement('div', { className: `h-screen flex flex-col bg-dark-950 text-white relative selection:bg-gold-500 selection:text-black`, dir: isRTL ? 'rtl' : 'ltr' },
                notify && React.createElement('div', { className: `fixed top-12 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-xl shadow-2xl border flex items-center gap-3 animate-pop glass-panel w-max max-w-[90%] ${notify.type==='error'?'bg-red-950/90 border-red-500':'bg-green-950/90 border-green-500'}` }, 
                    notify.type==='success'?React.createElement(CheckCircle,{size:24, className:"text-green-400"}):React.createElement(XCircle,{size:24, className:"text-red-400"}), 
                    React.createElement('span', { className: "font-bold text-sm" }, notify.msg)
                ),
                React.createElement(LiveTicker, { t }),
                React.createElement(Header, { user, toggleMenu: ()=>setMenuOpen(true) }),
                menuOpen && React.createElement(Sidebar, { user, close: ()=>setMenuOpen(false), navTo, t, lang, setLang, settings, logout }),
                React.createElement(ChatWidget, { user, t, isRTL }),
                React.createElement('main', { className: "flex-1 overflow-y-auto p-5 pb-28 z-10 scrollbar-hide" },
                    view === 'home' && React.createElement(HomeScreen, { user, navTo, t }),
                    view === 'casino' && React.createElement(CasinoScreen, { navTo, t }),
                    view === 'tasks' && React.createElement(TasksScreen, { user, showMsg, t }),
                    view === 'profile' && React.createElement(WalletScreen, { user, showMsg, t, isRTL, navTo }),
                    view === 'deposit' && React.createElement(DepositScreen, { user, showMsg, t, settings, back: ()=>navTo('profile') }),
                    view === 'withdraw' && React.createElement(WithdrawScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'exchange' && React.createElement(ExchangeScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'history' && React.createElement(HistoryScreen, { user, t, back: ()=>navTo('profile') }),
                    view === 'settings' && React.createElement(SettingsScreen, { user, showMsg, t, back: ()=>navTo('profile'), db }),
                    view === 'terms' && React.createElement(InfoPage, { title: t('terms'), content: settings.terms || DEFAULT_TERMS, back: ()=>navTo('profile'), settings }),
                    view === 'policy' && React.createElement(InfoPage, { title: t('policy'), content: settings.policy || DEFAULT_POLICY, back: ()=>navTo('profile'), settings })
                ),
                view !== 'settings' && React.createElement('nav', { className: "fixed bottom-4 left-4 right-4 h-16 glass-panel rounded-2xl z-40 flex justify-around items-center shadow-2xl border border-white/10 backdrop-blur-md" },
                    React.createElement(NavBtn, { icon: Home, label: t('home'), active: view==='home', onClick:()=>navTo('home') }),
                    React.createElement(NavBtn, { icon: Dices, label: t('casino'), active: view==='casino', onClick:()=>navTo('casino') }),
                    React.createElement(NavBtn, { icon: Trophy, label: t('tasks'), active: view==='tasks', onClick:()=>navTo('tasks') }),
                    React.createElement(NavBtn, { icon: Wallet, label: t('wallet'), active: view==='profile', onClick:()=>navTo('profile') })
                )
            );
        }
        function MinesGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [playing, setPlaying] = useState(false);
            const [grid, setGrid] = useState(Array(25).fill(null)); 
            const [revealed, setRevealed] = useState(Array(25).fill(false));
            const [bombsCount, setBombsCount] = useState(3);
            const [profit, setProfit] = useState(0);
            const [gameOver, setGameOver] = useState(false);
            const [resultModal, setResultModal] = useState(null);

            const startGame = async () => {
                if(user.coins < bet) return showMsg("No Balance", "error");
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                let newGrid = Array(25).fill('gem');
                let placed = 0;
                while(placed < bombsCount) {
                    let idx = Math.floor(Math.random() * 25);
                    if(newGrid[idx] === 'gem') { newGrid[idx] = 'bomb'; placed++; }
                }
                setGrid(newGrid); setRevealed(Array(25).fill(false)); setPlaying(true); setGameOver(false); setProfit(0); setResultModal(null);
            };

            const clickTile = async (i) => {
                if(!playing || revealed[i] || gameOver) return;
                AudioSys.click();
                
                let currentVal = grid[i];
                if (currentVal === 'gem' && profit > bet * 0.5 && shouldHouseWin()) {
                    currentVal = 'bomb';
                    const newGrid = [...grid]; newGrid[i] = 'bomb'; setGrid(newGrid);
                }

                const newRevealed = [...revealed]; newRevealed[i] = true; setRevealed(newRevealed);
                
                if(currentVal === 'bomb') {
                    setGameOver(true); setPlaying(false);
                    AudioSys.crash(); hapticFeedback('impact');
                    logGame(user.id, user.username, 'Mines', bet, 0, -bet);
                    setResultModal({ win: false, amount: 0 });
                } else {
                    AudioSys.playTone(600 + (profit/10), 'sine', 0.1);
                    const gemsFound = newRevealed.filter((r, idx) => r && grid[idx] === 'gem').length;
                    const nextMult = 1 + (gemsFound * (bombsCount / (25 - bombsCount))); 
                    setProfit(Math.floor(bet * nextMult) - bet);
                }
            };

            const cashout = async () => {
                if(!playing || gameOver) return;
                const win = bet + profit;
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                logGame(user.id, user.username, 'Mines', bet, win, profit);
                setPlaying(false); setGameOver(true); 
                setResultModal({ win: true, amount: win });
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" },
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-bold text-red-500" }, "MINES"),
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500" }, user.coins)
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    React.createElement('div', { className: "grid grid-cols-5 gap-2 w-full max-w-sm mb-6" },
                        grid.map((val, i) => React.createElement('button', {
                            key: i, onClick: ()=>clickTile(i),
                            className: `h-14 rounded-lg flex items-center justify-center text-xl transition-all ${revealed[i] ? (val==='bomb'?'bg-red-500':'bg-green-500') : 'bg-dark-800 hover:bg-dark-700'}`
                        }, revealed[i] ? (val==='bomb' ? React.createElement(Bomb) : React.createElement(Gem)) : ''))
                    ),
                    !playing && !gameOver && React.createElement('div', {className:"flex gap-4 items-center mb-4"}, 
                        React.createElement('span', {className:"text-gray-400 text-xs"}, "Bombs:"),
                        [1,3,5,10].map(b => React.createElement('button', {key:b, onClick:()=>setBombsCount(b), className:`px-3 py-1 rounded border ${bombsCount===b?'bg-gold-500 text-black border-gold-500':'border-white/10'}`}, b))
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-24 bg-black border border-white/20 rounded-xl text-center text-white font-bold" }),
                    playing ? React.createElement(Button, { full: true, onClick: cashout, variant:'green' }, `CASHOUT (+${profit})`) : React.createElement(Button, { full: true, onClick: startGame }, "PLAY")
                )
            );
        }

        function PlinkoGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [dropping, setDropping] = useState(false);
            const [ballPos, setBallPos] = useState(50); 
            const [resultModal, setResultModal] = useState(null);
            
            const drop = async () => {
                if(user.coins < bet) return showMsg("No Balance", "error");
                setDropping(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.playTone(600, 'square', 0.1); 
                
                const buckets = [5.6, 2.1, 1.1, 1, 0.5, 1, 1.1, 2.1, 5.6]; 
                let bucketIdx;
                if (shouldHouseWin()) {
                    bucketIdx = 3 + Math.floor(Math.random() * 3); 
                } else {
                    let r = 0; for(let i=0; i<6; i++) r += Math.random();
                    bucketIdx = Math.floor(r * (buckets.length / 6)); 
                }
                const safeIdx = Math.min(Math.max(bucketIdx, 0), buckets.length-1);
                const multiplier = buckets[safeIdx];
                
                let steps = 0;
                const int = setInterval(() => {
                    setBallPos(prev => prev + (Math.random() > 0.5 ? 2 : -2)); 
                    if(steps%2===0) AudioSys.click();
                    steps++;
                    if(steps > 20) {
                        clearInterval(int);
                        setBallPos(10 + (safeIdx * 10)); 
                        setTimeout(async () => {
                            const win = Math.floor(bet * multiplier);
                            logGame(user.id, user.username, 'Plinko', bet, win, win-bet);
                            if(win > 0) {
                                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                                if(win > bet) {
                                    setResultModal({ win: true, amount: win });
                                } else {
                                    showMsg(`x${multiplier}`, 'success');
                                }
                            } else {
                                setResultModal({ win: false, amount: 0 });
                            }
                            setDropping(false); setBallPos(50);
                        }, 500);
                    }
                }, 50);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" },
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-bold text-pink-500" }, "PLINKO"),
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500" }, user.coins)
                ),
                React.createElement('div', { className: "flex-1 relative overflow-hidden flex flex-col items-center justify-end pb-10" },
                    React.createElement('div', {className:"absolute top-10 flex flex-col items-center gap-4 opacity-50"},
                        Array(8).fill(0).map((_,i) => React.createElement('div', {key:i, className:"flex gap-6"}, Array(i+3).fill(0).map((__,j)=>React.createElement('div',{key:j, className:"w-2 h-2 rounded-full bg-white"}))))
                    ),
                    dropping && React.createElement('div', {className:"absolute top-10 w-4 h-4 rounded-full bg-red-500 shadow-[0_0_10px_red] transition-all duration-75", style:{left:`${ballPos}%`, top:`${dropping ? '80%' : '10%'}`}}),
                    React.createElement('div', {className:"flex gap-1 w-full px-4 mb-20"},
                        [5.6, 2.1, 1.1, 1, 0.5, 1, 1.1, 2.1, 5.6].map((m,i) => 
                            React.createElement('div', {key:i, className:`flex-1 h-8 rounded text-[9px] flex items-center justify-center font-bold ${m>=2?'bg-red-500':(m<1?'bg-blue-500':'bg-orange-500')}`}, m+'x')
                        )
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: dropping, className: "w-24 bg-black border border-white/20 rounded-xl text-center text-white font-bold" }),
                    React.createElement(Button, { full: true, onClick: drop, disabled: dropping }, "DROP")
                )
            );
        }

        function DiceGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [target, setTarget] = useState(50);
            const [rollUnder, setRollUnder] = useState(true);
            const [rolling, setRolling] = useState(false);
            const [lastRoll, setLastRoll] = useState(null);
            const [resultModal, setResultModal] = useState(null);

            const multiplier = 98 / (rollUnder ? target : (100-target));
            
            const roll = async () => {
                if(user.coins < bet) return showMsg("No Balance", "error");
                setRolling(true); setLastRoll(null); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.spin();
                
                setTimeout(async () => {
                    let r;
                    if (shouldHouseWin()) {
                        if (rollUnder) r = target + Math.floor(Math.random() * (100-target));
                        else r = Math.floor(Math.random() * target);
                    } else {
                        r = Math.floor(Math.random() * 100);
                    }
                    
                    setLastRoll(r);
                    const win = (rollUnder ? r < target : r > target);
                    const winAmt = win ? Math.floor(bet * multiplier) : 0;
                    
                    logGame(user.id, user.username, 'Dice', bet, winAmt, winAmt-bet);
                    if(win) { 
                        await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt}); 
                        setResultModal({ win: true, amount: winAmt });
                    } else {
                        setResultModal({ win: false, amount: 0 });
                    }
                    setRolling(false);
                }, 500);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" },
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-bold text-blue-400" }, "DICE"),
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500" }, user.coins)
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    React.createElement('div', {className:"text-6xl font-black mb-10 font-mono text-white"}, lastRoll ?? "00"),
                    React.createElement('div', {className:"w-full max-w-sm bg-dark-800 p-6 rounded-2xl border border-white/5"},
                        React.createElement('div', {className:"flex justify-between mb-2"}, 
                            React.createElement('span', {className:"text-gray-400"}, "Multiplier"),
                            React.createElement('span', {className:"text-gold-500 font-bold"}, multiplier.toFixed(4)+'x')
                        ),
                        React.createElement('input', { type: "range", min: "2", max: "98", value: target, onChange: e=>setTarget(Number(e.target.value)), className: "accent-blue-500 mb-4" }),
                        React.createElement('div', {className:"flex justify-between text-xs font-bold text-white"}, 
                            React.createElement('span', {}, "0"), React.createElement('span', {}, target), React.createElement('span', {}, "100")
                        ),
                        React.createElement('button', {onClick: ()=>setRollUnder(!rollUnder), className:"w-full mt-4 p-3 bg-white/5 rounded border border-white/10 text-sm"}, `Roll ${rollUnder?'Under':'Over'} ${target}`)
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: rolling, className: "w-24 bg-black border border-white/20 rounded-xl text-center text-white font-bold" }),
                    React.createElement(Button, { full: true, onClick: roll, disabled: rolling }, rolling ? "..." : "ROLL")
                )
            );
        }

        function WheelGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [spinning, setSpinning] = useState(false);
            const [rotation, setRotation] = useState(0);
            const [resultModal, setResultModal] = useState(null);

            const SEGMENTS = [
                { color: '#222', mult: 2, chance: 0.5 },
                { color: '#ef4444', mult: 3, chance: 0.3 },
                { color: '#22c55e', mult: 5, chance: 0.15 },
                { color: '#eab308', mult: 50, chance: 0.05 }
            ];

            const spin = async () => {
                if(user.coins < bet) return showMsg("No Balance", "error");
                setSpinning(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.spin();

                let outcome;
                if (shouldHouseWin()) {
                    outcome = SEGMENTS[0]; 
                } else {
                    const r = Math.random();
                    let acc = 0;
                    outcome = SEGMENTS[0];
                    for(let s of SEGMENTS) { acc += s.chance; if(r <= acc) { outcome = s; break; } }
                }
                
                const extraDeg = Math.floor(Math.random() * 30); 
                const finalRot = rotation + 1800 + extraDeg; 
                setRotation(finalRot);

                setTimeout(async () => {
                    const win = Math.floor(bet * outcome.mult);
                    logGame(user.id, user.username, 'Wheel', bet, win, win-bet);
                    await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                    
                    if(win > bet * 4) {
                        setResultModal({ win: true, amount: win });
                    } else {
                        showMsg(`x${outcome.mult}`, 'success'); 
                    }
                    setSpinning(false);
                }, 3000);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" },
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-bold text-yellow-500" }, "WHEEL"),
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500" }, user.coins)
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 relative overflow-hidden" },
                      React.createElement('div', { className: "absolute top-20 text-gold-500 z-20" }, React.createElement(ArrowUp, {size:40, className:"rotate-180 drop-shadow-lg"})),
                      React.createElement('div', { 
                          className: "w-64 h-64 rounded-full border-4 border-white/10 relative transition-all duration-[3000ms] cubic-bezier(0.2, 0.8, 0.2, 1)",
                          style: { transform: `rotate(${rotation}deg)`, background: 'conic-gradient(#222 0% 50%, #ef4444 50% 80%, #22c55e 80% 95%, #eab308 95% 100%)' }
                      }),
                      React.createElement('div', {className:"mt-10 flex gap-4 text-xs font-bold"},
                        SEGMENTS.map((s,i) => React.createElement('div', {key:i, className:"flex flex-col items-center"},
                            React.createElement('div', {className:"w-4 h-4 rounded-full mb-1", style:{background:s.color}}),
                            React.createElement('span', {}, s.mult+'x')
                        ))
                      )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: spinning, className: "w-24 bg-black border border-white/20 rounded-xl text-center text-white font-bold" }),
                    React.createElement(Button, { full: true, onClick: spin, disabled: spinning }, "SPIN")
                )
            );
        }

        function HiLoGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [currentCard, setCurrentCard] = useState(Math.floor(Math.random()*13)+1); 
            const [playing, setPlaying] = useState(false);
            const [roundWin, setRoundWin] = useState(0);
            const [resultModal, setResultModal] = useState(null);

            const cards = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];

            const startGame = async () => {
                if(user.coins < bet) return showMsg("No Balance", "error");
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setPlaying(true); setRoundWin(bet); setResultModal(null);
                setCurrentCard(Math.floor(Math.random()*13)+1);
            };

            const guess = async (dir) => { 
                AudioSys.click();
                let nextCard = Math.floor(Math.random()*13)+1;
                
                if (shouldHouseWin()) {
                    if (dir === 'hi' && nextCard > currentCard) nextCard = Math.max(1, currentCard - 1);
                    if (dir === 'lo' && nextCard < currentCard) nextCard = Math.min(13, currentCard + 1);
                }

                let win = false;
                if(dir === 'hi' && nextCard > currentCard) win = true;
                else if(dir === 'lo' && nextCard < currentCard) win = true;
                else if(dir === 'same' && nextCard === currentCard) win = true; 

                setCurrentCard(nextCard);

                if(win) {
                    const mult = dir === 'same' ? 10 : 1.5; 
                    const newWin = Math.floor(roundWin * mult);
                    setRoundWin(newWin);
                    AudioSys.playTone(600, 'sine', 0.1);
                } else {
                    logGame(user.id, user.username, 'HiLo', bet, 0, -bet);
                    setPlaying(false); setRoundWin(0); 
                    setResultModal({ win: false, amount: 0 });
                }
            };

            const cashout = async () => {
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+roundWin});
                logGame(user.id, user.username, 'HiLo', bet, roundWin, roundWin-bet);
                setPlaying(false); 
                setResultModal({ win: true, amount: roundWin });
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 bg-dark-900 border-b border-white/10" },
                    React.createElement('button', { onClick: back, className: "text-slate-400" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-bold text-gray-200" }, "HI-LO"),
                    React.createElement('span', { className: "text-xs bg-black px-2 py-1 rounded text-gold-500" }, user.coins)
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    React.createElement('div', { className: "w-32 h-48 bg-white rounded-xl flex items-center justify-center text-6xl font-black text-black shadow-2xl mb-8 border-4 border-gray-300 animate-pop" },
                        cards[currentCard-1]
                    ),
                    playing && React.createElement('div', {className:"text-green-500 font-mono text-xl font-bold mb-4"}, `Win: ${roundWin}`),
                    playing && React.createElement('div', {className:"flex gap-2 w-full max-w-sm"},
                        React.createElement('button', {onClick:()=>guess('lo'), className:"flex-1 p-4 bg-red-500/20 text-red-500 border border-red-500/50 rounded-xl font-bold hover:bg-red-500/40"}, "LO"),
                        React.createElement('button', {onClick:()=>guess('hi'), className:"flex-1 p-4 bg-green-500/20 text-green-500 border border-green-500/50 rounded-xl font-bold hover:bg-green-500/40"}, "HI")
                    )
                ),
                React.createElement('div', { className: "p-4 bg-dark-900 flex gap-4 pb-safe border-t border-white/10" },
                    React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-24 bg-black border border-white/20 rounded-xl text-center text-white font-bold" }),
                    playing ? React.createElement(Button, { full: true, onClick: cashout, variant:'gold' }, "CASHOUT") : React.createElement(Button, { full: true, onClick: startGame }, "START")
                )
            );
        }

        // --- DASHBOARD AND WALLET ---
        function HomeScreen({ user, navTo, t }) {
            return React.createElement('div', { className: "space-y-6 animate-pop" },
                React.createElement('div', { className: "relative aspect-[1.58/1] rounded-2xl overflow-hidden shadow-2xl border border-white/10 hover:border-gold-500/40 transition-all transform hover:rotate-1" },
                    React.createElement('div', { className: "absolute inset-0 bg-gradient-to-br from-dark-900 to-black" },
                        React.createElement('div', { className: "absolute inset-0 opacity-20", style:{backgroundImage:'radial-gradient(#C0A000 1px, transparent 1px)', backgroundSize:'20px 20px'} })
                    ),
                    React.createElement('div', { className: "relative z-10 h-full p-6 flex flex-col justify-between" },
                        React.createElement('div', { className: "flex justify-between items-start" },
                            React.createElement('div', { className: "flex items-center gap-2" }, React.createElement(ShieldCheck, { className: "text-gold-500", size: 26 }), React.createElement('h2', { className: "text-gold-500 font-oswald text-xl tracking-widest" }, "CD0777")),
                            React.createElement('div', { className: `px-3 py-1 rounded-full text-[9px] font-black tracking-wider border border-green-500 text-green-400` }, "VIP MEMBER")
                        ),
                        React.createElement('div', { className: "flex justify-between items-center" },
                            React.createElement('div', {}, React.createElement('p', { className: "text-gray-400 text-[8px] uppercase tracking-widest mb-1 font-bold" }, "BALANCE"), React.createElement('p', { className: "font-mono text-3xl text-white flex gap-1" }, React.createElement('span', { className: "text-gold-500" }, "$"), Number(user.balance).toFixed(2))),
                            React.createElement('div', { className: "text-right" }, React.createElement('p', { className: "text-[7px] text-gold-600 uppercase mb-1 font-bold" }, "ID"), React.createElement('p', { className: "font-mono text-lg text-white border-gold-500 px-2 border-r-2" }, user.memberId))
                        ),
                        React.createElement('div', { className: "flex justify-between items-end" }, React.createElement('div', {}, React.createElement('p', { className: "text-[7px] text-gold-600 uppercase mb-0.5 font-bold" }, t('name')), React.createElement('p', { className: "font-mono text-gray-200 text-sm tracking-widest uppercase" }, user.fullName)))
                    )
                ),
                React.createElement('button', { onClick: ()=>navTo('casino'), className: "w-full h-28 relative rounded-2xl overflow-hidden group active:scale-95 transition-all border border-white/5 hover:border-gold-500/40 shadow-xl" },
                    React.createElement('div', { className: "absolute inset-0 bg-gradient-to-r from-red-900/80 to-purple-900/80" },
                        React.createElement('div', { className: "absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-30" })
                    ),
                    React.createElement('div', { className: "absolute inset-0 flex items-center justify-between p-6" },
                        React.createElement('div', {}, React.createElement('h3', { className: "text-2xl font-black italic text-white mb-1 drop-shadow-md" }, "PLAY & WIN"), React.createElement('p', { className: "text-xs text-red-200 font-bold" }, "CASINO GAMES")),
                        React.createElement(Rocket, { size: 50, className: "text-white/20 animate-pulse" })
                    )
                )
            );
        }

        function CasinoScreen({ navTo, t }) {
            const GameCard = ({ title, sub, color, icon: Icon, onClick }) => React.createElement('button', { onClick, className: `relative h-32 rounded-2xl overflow-hidden border border-white/5 bg-dark-800 hover:border-${color}-500/50 transition-all group w-full text-right active:scale-95 shadow-lg` }, React.createElement('div', { className: `absolute inset-0 bg-gradient-to-br from-${color}-900/50 to-transparent` }), React.createElement('div', { className: `absolute top-3 left-3 text-${color}-500/20 group-hover:text-${color}-500/40 transition-colors` }, React.createElement(Icon, { size: 60 })), React.createElement('div', { className: "absolute bottom-4 right-4 z-10" }, React.createElement('h3', { className: "text-xl font-black text-white italic" }, title), React.createElement('p', { className: `text-[10px] text-${color}-300 font-bold uppercase` }, sub)));
            return React.createElement('div', { className: "space-y-4 animate-pop" },
                React.createElement('h2', { className: "text-gold-500 font-bold text-lg flex gap-2 items-center" }, React.createElement(Dices), t('casino')),
                React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                    React.createElement(GameCard, { title:t('crash'), sub:"Pro Math", color:"red", icon:Rocket, onClick:()=>navTo('game-crash') }),
                    React.createElement(GameCard, { title:t('slots'), sub:"Weighted", color:"purple", icon:Gem, onClick:()=>navTo('game-slots') }),
                    React.createElement(GameCard, { title:t('limbo'), sub:"Greedy Mode", color:"orange", icon:Target, onClick:()=>navTo('game-limbo') }),
                    React.createElement(GameCard, { title:t('keno'), sub:"Classic", color:"emerald", icon:Grid3X3, onClick:()=>navTo('game-keno') }),
                    React.createElement(GameCard, { title:t('coinflip'), sub:"50/50", color:"blue", icon:Coins, onClick:()=>navTo('game-coinflip') }),
                    React.createElement(GameCard, { title:t('mines'), sub:"Grid Logic", color:"red", icon:Bomb, onClick:()=>navTo('game-mines') }),
                    React.createElement(GameCard, { title:t('plinko'), sub:"Physics", color:"pink", icon:CircleDot, onClick:()=>navTo('game-plinko') }),
                    React.createElement(GameCard, { title:t('dice'), sub:"Range", color:"blue", icon:Dices, onClick:()=>navTo('game-dice') }),
                    React.createElement(GameCard, { title:t('wheel'), sub:"Spin", color:"yellow", icon:LifeBuoy, onClick:()=>navTo('game-wheel') }),
                    React.createElement(GameCard, { title:t('hilo'), sub:"Cards", color:"gray", icon:ArrowUp, onClick:()=>navTo('game-hilo') })
                )
            );
        }

        function TasksScreen({ user, showMsg, t }) { return React.createElement('div', { className: "animate-pop" }, React.createElement('h2', { className: "text-gold-500 font-bold text-lg mb-4" }, t('tasks')), React.createElement('div', { className: "text-center py-10 bg-dark-900 rounded-2xl border border-white/5" }, React.createElement(Trophy, { size: 40, className: "mx-auto text-gray-600 mb-4" }), React.createElement('p', { className: "text-gray-400" }, t('no_tasks')))); }

        function WalletScreen({ user, showMsg, t, isRTL, navTo }) {
            return React.createElement('div', { className: "space-y-6 animate-pop" },
                React.createElement('div', { className: "bg-gradient-to-r from-gold-600 to-gold-400 p-6 rounded-2xl shadow-lg text-black relative overflow-hidden" },
                    React.createElement('div', { className: "absolute -right-4 -top-4 text-white/20" }, React.createElement(Wallet, { size: 100 })),
                    React.createElement('p', { className: "text-xs font-black uppercase tracking-widest opacity-60" }, "Total Balance"),
                    React.createElement('h2', { className: "text-4xl font-black font-mono mt-1 mb-4" }, `$${Number(user.balance).toFixed(2)}`),
                    React.createElement('div', { className: "flex gap-2" },
                        React.createElement('button', { onClick: ()=>navTo('deposit'), className: "flex-1 bg-black/20 hover:bg-black/30 py-2 rounded-lg font-bold text-sm transition-colors" }, t('deposit')),
                        React.createElement('button', { onClick: ()=>navTo('withdraw'), className: "flex-1 bg-black/20 hover:bg-black/30 py-2 rounded-lg font-bold text-sm transition-colors" }, t('withdraw'))
                    )
                ),
                React.createElement('button', { onClick: ()=>navTo('exchange'), className: "w-full bg-dark-800 p-4 rounded-xl border border-gold-500/30 flex items-center justify-between group hover:bg-dark-700 transition-all" },
                    React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement('div', { className: "p-2 bg-gold-500/10 rounded-lg text-gold-500" }, React.createElement(ArrowLeftRight, { size: 20 })),
                        React.createElement('div', { className: "text-left rtl:text-right" },
                            React.createElement('p', { className: "font-bold text-white" }, t('exchange')),
                            React.createElement('p', { className: "text-[10px] text-gray-400" }, "USD <-> Coins")
                        )
                    ),
                    React.createElement(ChevronRight, { className: "text-gray-500 group-hover:text-gold-500 transition-colors" })
                ),
                React.createElement('div', { className: "bg-dark-900 rounded-2xl p-1" },
                    React.createElement(SettingsBtn, { icon: History, label: t('history'), onClick: ()=>navTo('history'), arrow:true, isRTL }),
                    React.createElement(SettingsBtn, { icon: FileText, label: t('terms'), onClick: ()=>navTo('terms'), arrow:true, isRTL }),
                    React.createElement(SettingsBtn, { icon: ShieldCheck, label: t('policy'), onClick: ()=>navTo('policy'), arrow:true, isRTL })
                )
            );
        }

        function DepositScreen({ user, showMsg, t, settings, back }) {
             const [method, setMethod] = useState(null);
             const [amount, setAmount] = useState('');
             const [imgFile, setImgFile] = useState(null);
             const [loading, setLoading] = useState(false);
             const [showSuccess, setShowSuccess] = useState(false);

             const METHODS = [
                 { id: 'attijari', name: t('method_bank'), color: 'text-orange-500', bg: 'bg-orange-500/10', icon: Landmark },
                 { id: 'cashplus', name: t('method_cash'), color: 'text-yellow-500', bg: 'bg-yellow-500/10', icon: Zap },
                 { id: 'binance', name: t('method_crypto'), color: 'text-yellow-400', bg: 'bg-yellow-400/10', icon: Disc },
                 { id: 'paypal', name: 'PayPal', color: 'text-blue-500', bg: 'bg-blue-500/10', icon: Wallet }
             ];

             const submit = async () => {
                 if(loading) return; 
                 if(!method || !amount || !imgFile) return showMsg(t('inputs_err'), 'error');
                 setLoading(true);
                 try {
                     const base64Img = await convertToBase64(imgFile);
                     await addDoc(collection(db, "deposits"), {
                         userId: user.id, username: user.username, amount: Number(amount), method: method.name, status: 'pending', image: base64Img, date: new Date().toISOString()
                     });
                     setShowSuccess(true);
                 } catch(e) { showMsg(t('error'), 'error'); }
                 setLoading(false);
             };

             if (showSuccess) return React.createElement(StatusModal, { 
                 title: t('req_sent'), 
                 msg: t('req_wait'), 
                 onClose: () => { setShowSuccess(false); back(); } 
             });

             return React.createElement('div', { className: "animate-pop h-full flex flex-col" },
                React.createElement('button', { onClick: back, className: "mb-4 text-gold-500 flex items-center gap-2" }, React.createElement(ChevronRight), t('wallet')),
                React.createElement('h2', { className: "text-2xl font-bold mb-4" }, t('deposit')),
                React.createElement('div', { className: "flex-1 overflow-y-auto space-y-4 pb-20" },
                    React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                        METHODS.map(m => React.createElement('button', { key: m.id, onClick: () => setMethod(m), className: `p-4 rounded-xl border flex flex-col items-center gap-2 transition-all ${method?.id === m.id ? 'border-gold-500 bg-gold-500/10' : 'border-white/10 bg-dark-900'}` }, React.createElement(m.icon, { className: m.color }), React.createElement('span', { className: "text-xs font-bold" }, m.name)))
                    ),
                    method && React.createElement('div', { className: "space-y-4 animate-slide-up" },
                        React.createElement('div', { className: "bg-dark-800 p-4 rounded-xl border border-white/5 text-center" },
                            React.createElement('p', { className: "text-xs text-gray-400 mb-2" }, t('proof_needed')),
                            React.createElement('p', { className: "font-mono text-lg text-gold-500 break-all select-text" }, settings[`${method.id}_info`] || "Ask Admin")
                        ),
                        React.createElement(Input, { placeholder: t('amount'), type: "number", value: amount, onChange: e=>setAmount(e.target.value), icon: DollarSign }),
                        React.createElement('div', { className: "bg-dark-900 border border-dashed border-white/20 rounded-xl p-6 text-center relative" },
                            React.createElement('input', { type: "file", accept: "image/*", onChange: e=>setImgFile(e.target.files[0]), className: "absolute inset-0 opacity-0 z-10 w-full h-full cursor-pointer" }),
                            React.createElement(Upload, { className: "mx-auto text-gray-500 mb-2" }),
                            React.createElement('p', { className: "text-xs text-gray-400" }, imgFile ? imgFile.name : t('upload_proof'))
                        ),
                        React.createElement(Button, { full: true, onClick: submit, disabled: loading }, loading ? t('processing') : t('execute'))
                    )
                )
            );
        }

        function WithdrawScreen({ user, showMsg, t, back }) {
             const [method, setMethod] = useState(null);
             const [form, setForm] = useState({ amount: '', name: '', account: '', phone: '', network: 'Orange' });
             const [loading, setLoading] = useState(false);
             const [showSuccess, setShowSuccess] = useState(false);
             
             const METHODS = [
                 { id: 'bank', name: t('method_bank'), icon: Landmark, color: 'text-orange-500' },
                 { id: 'cash', name: t('method_cash'), icon: Zap, color: 'text-yellow-500' },
                 { id: 'recharge', name: t('method_recharge'), icon: Smartphone, color: 'text-green-500' },
                 { id: 'crypto', name: t('method_crypto'), icon: Disc, color: 'text-blue-500' }
             ];

             const submit = async () => {
                 if(loading) return; 
                 if(!method || !form.amount) return showMsg(t('inputs_err'), 'error');
                 if(method.id==='recharge' && !form.phone) return showMsg(t('inputs_err'), 'error');
                 const amt = Number(form.amount);
                 if(amt <= 0) return showMsg("Invalid Amount", 'error');
                 if(Number(user.balance) < amt) return showMsg("Insufficient Balance", 'error');

                 setLoading(true);
                 try {
                     await updateDoc(doc(db, "users", user.id), { balance: Number(user.balance) - amt });
                     await addDoc(collection(db, "withdraws"), {
                        userId: user.id, username: user.username, amount: amt, method: method.name, details: form, status: 'pending', date: new Date().toISOString()
                     });
                     setShowSuccess(true);
                 } catch (e) { showMsg(t('error'), 'error'); }
                 setLoading(false);
             };

             if (showSuccess) return React.createElement(StatusModal, { 
                 title: t('req_sent'), 
                 msg: t('req_wait'), 
                 onClose: () => { setShowSuccess(false); back(); } 
             });

             return React.createElement('div', { className: "animate-pop" },
                React.createElement('button', { onClick: back, className: "mb-4 text-gold-500 flex items-center gap-2" }, React.createElement(ChevronRight), t('wallet')),
                React.createElement('h2', { className: "text-2xl font-bold mb-4" }, t('withdraw')),
                React.createElement('div', { className: "grid grid-cols-2 gap-3 mb-6" },
                    METHODS.map(m => React.createElement('button', { key: m.id, onClick: () => setMethod(m), className: `p-4 rounded-xl border flex flex-col items-center gap-2 transition-all ${method?.id === m.id ? 'border-gold-500 bg-gold-500/10' : 'border-white/10 bg-dark-900'}` }, React.createElement(m.icon, { className: m.color }), React.createElement('span', { className: "text-xs font-bold" }, m.name)))
                ),
                method && React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl space-y-4 animate-slide-up" },
                    React.createElement(Input, { placeholder: t('amount'), type:"number", value: form.amount, onChange: e=>setForm({...form, amount:e.target.value}), icon: DollarSign }),
                    (method.id === 'bank') && React.createElement(React.Fragment, null,
                        React.createElement(Input, { placeholder: t('name'), value: form.name, onChange: e=>setForm({...form, name:e.target.value}), icon: User }),
                        React.createElement(Input, { placeholder: t('rib'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: CreditCard }),
                        React.createElement(Input, { placeholder: t('bank_name'), value: form.bank, onChange: e=>setForm({...form, bank:e.target.value}), icon: Landmark })
                    ),
                    (method.id === 'cash') && React.createElement(React.Fragment, null,
                        React.createElement(Input, { placeholder: t('name'), value: form.name, onChange: e=>setForm({...form, name:e.target.value}), icon: User }),
                        React.createElement(Input, { placeholder: t('cnie'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: CreditCard }),
                        React.createElement(Input, { placeholder: t('phone'), value: form.phone, onChange: e=>setForm({...form, phone:e.target.value}), icon: Smartphone })
                    ),
                    (method.id === 'recharge') && React.createElement(React.Fragment, null,
                          React.createElement(Input, { placeholder: t('phone'), value: form.phone, onChange: e=>setForm({...form, phone:e.target.value}), icon: Smartphone }),
                          React.createElement('div', { className: "space-y-2" },
                           React.createElement('label', {className:"text-xs text-gray-400"}, t('network')),
                           React.createElement('select', { value: form.network, onChange: e=>setForm({...form, network:e.target.value}), className: "w-full bg-dark-950 border border-white/10 p-3 rounded-xl text-white outline-none" },
                               React.createElement('option', {value:"Orange"}, "Orange"),
                               React.createElement('option', {value:"Maroc Telecom"}, "Maroc Telecom"),
                               React.createElement('option', {value:"Inwi"}, "Inwi")
                           )
                        )
                    ),
                    (method.id === 'crypto') && React.createElement(React.Fragment, null,
                        React.createElement(Input, { placeholder: t('wallet_addr'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: Disc })
                    ),
                    React.createElement(Button, { full:true, onClick: submit, disabled: loading }, loading ? t('processing') : t('execute'))
                )
            );
        }

        function ExchangeScreen({ user, showMsg, t, back }) {
            const [amount, setAmount] = useState('');
            const [mode, setMode] = useState('to_coins'); 
            const RATE = 100; // 1 USD = 100 COINS

            const execute = async () => {
                const val = Number(amount);
                if(!val || val <= 0) return showMsg("Invalid Amount", "error");

                if (mode === 'to_coins') {
                    if (Number(user.balance) < val) return showMsg("Insufficient Balance ($)", "error");
                    const coinsToAdd = val * RATE;
                    await updateDoc(doc(db,"users",user.id), {
                        balance: Number(user.balance) - val,
                        coins: Number(user.coins) + coinsToAdd
                    });
                    showMsg(`Exchanged $${val} to ${coinsToAdd} Coins`, 'success');
                } else {
                    if (Number(user.coins) < val) return showMsg("Insufficient Coins", "error");
                    const usdToAdd = val / RATE;
                    await updateDoc(doc(db,"users",user.id), {
                        coins: Number(user.coins) - val,
                        balance: Number(user.balance) + usdToAdd
                    });
                    showMsg(`Exchanged ${val} Coins to $${usdToAdd.toFixed(2)}`, 'success');
                }
                setAmount('');
            };

            return React.createElement('div', { className: "animate-pop" },
                React.createElement('button', { onClick: back, className: "mb-4 text-gold-500 flex items-center gap-2" }, React.createElement(ChevronRight), t('wallet')),
                React.createElement('h2', { className: "text-2xl font-bold mb-4 text-gold-500" }, t('exchange')),
                React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl border border-white/10 space-y-6" },
                    React.createElement('div', { className: "flex justify-center" },
                          React.createElement('div', { className: "bg-black/40 px-4 py-2 rounded-full border border-white/5 text-xs text-gray-400 flex items-center gap-2" },
                            React.createElement(DollarSign, { size: 12, className: "text-green-500" }),
                            "1.00",
                            React.createElement(ArrowLeftRight, { size: 12 }),
                            React.createElement(Gem, { size: 12, className: "text-gold-500" }),
                            RATE
                          )
                    ),
                    React.createElement('div', { className: "relative" },
                          React.createElement('div', { className: "flex justify-between text-xs text-gray-400 mb-1 px-1" },
                             React.createElement('span', {}, mode === 'to_coins' ? "From (USD Balance)" : "From (Game Coins)"),
                             React.createElement('span', { className: "text-white font-mono" }, mode === 'to_coins' ? `$${Number(user.balance).toFixed(2)}` : user.coins)
                          ),
                          React.createElement(Input, { type: "number", value: amount, onChange: e=>setAmount(e.target.value), icon: mode==='to_coins'?DollarSign:Gem, placeholder: "Amount to convert" })
                    ),
                    React.createElement('div', { className: "flex justify-center" },
                        React.createElement('button', { onClick: ()=>setMode(mode==='to_coins'?'to_usd':'to_coins'), className: "p-3 bg-gold-500 rounded-full text-black shadow-lg hover:scale-110 transition-transform" },
                             React.createElement(ArrowUp, { size: 20, className: "rotate-0" }) 
                        )
                    ),
                    React.createElement('div', { className: "bg-black/40 p-4 rounded-xl text-center border border-white/5" },
                        React.createElement('p', { className: "text-xs text-gray-500 mb-1" }, "You Receive"),
                        React.createElement('p', { className: "text-2xl font-black font-mono text-white flex items-center justify-center gap-2" },
                            mode === 'to_coins' ? (amount ? (amount * RATE) : 0) : (amount ? (amount / RATE).toFixed(2) : '0.00'),
                            mode === 'to_coins' ? React.createElement(Gem, { size: 20, className: "text-gold-500" }) : React.createElement(DollarSign, { size: 20, className: "text-green-500" })
                        )
                    ),
                    React.createElement(Button, { full: true, onClick: execute }, t('convert'))
                )
            );
        }

        function HistoryScreen({ user, t, back }) {
            const [list, setList] = useState([]);
            useEffect(() => {
                const fetchHistory = async () => {
                    const dQ = query(collection(db, "deposits"), where("userId", "==", user.id));
                    const wQ = query(collection(db, "withdraws"), where("userId", "==", user.id));
                    const [dSnap, wSnap] = await Promise.all([getDocs(dQ), getDocs(wQ)]);
                    const dData = dSnap.docs.map(d => ({...d.data(), type: 'deposit'}));
                    const wData = wSnap.docs.map(d => ({...d.data(), type: 'withdraw'}));
                    const combined = [...dData, ...wData].sort((a,b) => new Date(b.date) - new Date(a.date));
                    setList(combined);
                };
                fetchHistory();
            }, []);

            return React.createElement('div', { className: "animate-pop" },
                React.createElement('div', { className: "flex items-center gap-2 mb-4" }, 
                     back && React.createElement('button', { onClick: back, className: "text-gold-500" }, React.createElement(ChevronRight)),
                    React.createElement('h2', { className: "text-gold-500 font-bold text-lg" }, t('history'))
                ),
                list.length === 0 
                ? React.createElement('div', { className: "bg-dark-900 rounded-2xl p-6 text-center text-gray-500" }, "No records found")
                : React.createElement('div', { className: "space-y-2" }, list.map((item, i) => 
                    React.createElement('div', { key: i, className: "bg-dark-900 p-4 rounded-xl flex justify-between items-center border border-white/5" },
                        React.createElement('div', {}, 
                            React.createElement('p', { className: `font-bold ${item.type==='deposit'?'text-green-400':'text-red-400'}` }, 
                                item.type === 'deposit' ? 'DEPOSIT' : 'WITHDRAW'
                            ),
                            React.createElement('p', { className: "text-xs text-white/80" }, item.method),
                            React.createElement('p', { className: "text-[10px] text-gray-500" }, new Date(item.date).toLocaleDateString())
                        ),
                        React.createElement('div', { className: "text-right" }, 
                            React.createElement('p', { className: "text-white font-mono font-bold" }, item.type==='deposit' ? `+${item.amount}$` : `-${item.amount}$`),
                            React.createElement('span', { className: `text-[9px] px-2 py-0.5 rounded ${item.status==='pending'?'bg-yellow-500/20 text-yellow-500':(item.status==='approved'?'bg-green-500/20 text-green-500':'bg-red-500/20 text-red-500')}` }, item.status)
                        )
                    )
                ))
            );
        }

        function Header({ user, toggleMenu }) {
            return React.createElement('div', { className: "sticky top-0 z-40 bg-dark-950/80 backdrop-blur-md border-b border-white/5 px-5 py-4 flex justify-between items-center" },
                React.createElement('div', { className: "flex items-center gap-3" },
                    React.createElement('button', { onClick: toggleMenu, className: "p-2 bg-dark-900 rounded-xl text-gold-500 border border-white/5 btn-press" }, React.createElement(Menu, { size: 24 })),
                    React.createElement('div', { className: "w-9 h-9 rounded-xl bg-gradient-to-tr from-gold-400 to-gold-600 flex items-center justify-center font-black text-black text-sm shadow-lg" }, "CD")
                ),
                React.createElement('div', { className: "bg-dark-900 border border-white/10 px-4 py-1.5 rounded-full flex items-center gap-2" }, 
                    React.createElement(Gem, { size: 16, className: "text-gold-500 animate-pulse" }), 
                    React.createElement('span', { className: "text-gold-500 font-mono font-bold text-sm" }, user.coins.toLocaleString())
                )
            );
        }

        function Sidebar({ user, close, navTo, t, lang, setLang, settings, logout }) {
            return React.createElement('div', { className: "fixed inset-0 z-50 flex" },
                React.createElement('div', { className: "absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity", onClick: close }),
                React.createElement('div', { className: `relative w-72 bg-dark-900 border-l border-gold-500/20 h-full p-6 shadow-2xl flex flex-col ${lang==='ar'?'animate-slide-in-right':'animate-slide-in-left'}` },
                    React.createElement('div', { className: "flex justify-between items-center mb-8 border-b border-white/10 pb-4" }, React.createElement('h2',{className:"text-gold-500 font-bold text-2xl"}, t('menu')), React.createElement('button',{onClick:close},React.createElement(X, {className:"text-gray-400"}))),
                    React.createElement('nav', { className: "space-y-2 flex-1 overflow-y-auto" },
                        React.createElement(SidebarBtn, { icon: Home, label: t('home'), onClick:()=>navTo('home') }),
                        React.createElement(SidebarBtn, { icon: Dices, label: t('casino'), onClick:()=>navTo('casino') }),
                        React.createElement(SidebarBtn, { icon: Wallet, label: t('wallet'), onClick:()=>navTo('profile') }),
                        React.createElement('div', {className:"h-px bg-white/5 my-3"}),
                        React.createElement(SidebarBtn, { icon: History, label: t('history'), onClick:()=>navTo('history') }),
                        React.createElement(SidebarBtn, { icon: Settings, label: t('settings'), onClick:()=>navTo('settings') }),
                        React.createElement('button', { onClick: ()=>{const l=lang==='ar'?'en':'ar'; setLang(l); localStorage.setItem('cd0777_lang',l);}, className: "w-full flex items-center justify-between p-3.5 rounded-xl text-gray-300 hover:bg-white/5 mt-4 border border-white/5 btn-press" }, React.createElement('div', {className:"flex gap-4"}, React.createElement(Globe), t('lang')), React.createElement('span', {className:"text-gold-500 text-xs bg-black px-2 py-1 rounded"}, lang==='ar'?'English':'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'))
                    ),
                    React.createElement('button', { onClick:logout, className: "mt-auto w-full flex items-center justify-center gap-2 text-red-400 p-4 bg-red-900/10 rounded-2xl font-bold border border-red-900/30 btn-press" }, React.createElement(LogOut), t('logout'))
                )
            );
        }
        
        const SidebarBtn = ({ icon: Icon, label, onClick }) => React.createElement('button', { onClick, className: "w-full flex items-center gap-4 p-3.5 rounded-xl text-gray-300 hover:bg-white/5 btn-press" }, React.createElement(Icon, { size: 20 }), React.createElement('span', {}, label));
        const NavBtn = ({ icon: Icon, label, active, onClick }) => React.createElement('button', { onClick, className: `flex flex-col items-center gap-1 transition-all ${active?'text-gold-500 -translate-y-1 scale-110':'text-gray-500'}` }, React.createElement(Icon, { size: 24, strokeWidth: active?2.5:2 }), React.createElement('span', { className: "text-[9px] font-bold" }, label));
        const SettingsBtn = ({ icon: Icon, label, onClick, arrow, isRTL }) => React.createElement('button', { onClick, className: "w-full flex items-center justify-between p-4 hover:bg-white/5 rounded-xl group transition-all" }, React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "p-2 bg-dark-950 rounded-lg text-gold-500 group-hover:scale-110 transition-transform" }, React.createElement(Icon, { size: 18 })), React.createElement('span', { className: "font-medium text-sm" }, label)), arrow && (isRTL ? React.createElement(ChevronLeft, { size: 16, className: "text-gray-600" }) : React.createElement(ChevronRight, { size: 16, className: "text-gray-600" })));

        function InfoPage({ title, content, back, settings }) {
            const supportLink = settings?.support_link || "https://t.me/your_admin";
            const supportText = settings?.support_text || "Contact us for assistance";
            return React.createElement('div', { className: "h-full bg-dark-950 p-6 overflow-y-auto animate-pop" },
                React.createElement('button', { onClick: back, className: "mb-6 text-gold-500 flex items-center gap-2 font-bold p-2 bg-gold-500/10 rounded-xl w-max" }, React.createElement(ChevronRight), "Back"),
                React.createElement('h2', { className: "text-3xl font-bold mb-6 text-gold-500 font-oswald uppercase" }, title),
                React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl text-gray-300 text-sm leading-relaxed whitespace-pre-wrap font-cairo border border-white/5 shadow-lg mb-6" }, content),
                React.createElement('div', { className: "border-t border-white/10 pt-6 mt-4" },
                    React.createElement('div', { className: "bg-blue-900/20 border border-blue-500/30 p-6 rounded-2xl text-center" },
                        React.createElement(Headphones, { size: 32, className: "text-blue-400 mx-auto mb-3" }),
                        React.createElement('h3', { className: "text-white font-bold mb-2" }, "Support Center"),
                        React.createElement('p', { className: "text-gray-400 text-xs mb-4" }, supportText),
                        React.createElement('a', { href: supportLink, target: "_blank", rel: "noopener", className: "inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl font-bold transition-colors shadow-lg shadow-blue-900/50" }, React.createElement(Send, { size: 16 }), "Contact Support")
                    )
                )
            );
        }

        function PendingActivationScreen({ user, logout, t, isRTL, showMsg, settings }) {
            const promoCode = settings?.promo_code || "CD0777";
            const telegramLink = settings?.telegram_link || "https://t.me/your_admin_link";
            const xbetLink = settings?.xbet_link || "https://refpa7921972.top/L?tag=d_3162621m_1573c_&site=3162621&ad=1573";
            const copyCode = (e) => { e.stopPropagation(); e.preventDefault(); navigator.clipboard.writeText(promoCode); showMsg(`Copied: ${promoCode}`); };
            
            return React.createElement('div', { className: "h-screen bg-black flex flex-col items-center justify-center p-6 relative overflow-hidden", dir: isRTL?'rtl':'ltr' },
                React.createElement('div', { className: "absolute inset-0 luxury-bg opacity-90" }),
                React.createElement('div', { className: "absolute top-0 left-0 w-full h-full star-bg opacity-40" }),
                React.createElement('div', { className: "absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[150vw] h-[150vw] bg-gold-500/5 blur-[120px] rounded-full pointer-events-none" }),
                
                React.createElement('div', { className: "relative w-full max-w-sm aspect-[1.6/1] mb-8 animate-fade-in perspective-1000 group cursor-pointer" },
                    React.createElement('div', { className: "absolute inset-0 elite-card-bg rounded-2xl shadow-2xl overflow-hidden flex flex-col p-6 z-10 transition-transform transform group-hover:scale-105" },
                        React.createElement('div', { className: "absolute inset-0 card-shine pointer-events-none z-20 opacity-30" }),
                        React.createElement('div', { className: "absolute inset-0 hologram pointer-events-none opacity-20" }),
                        
                        React.createElement('div', { className: "flex justify-between items-start z-30" },
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement('div', { className: "w-10 h-10 rounded-full border-2 border-gold-500 flex items-center justify-center bg-black" }, React.createElement(Crown, { size: 20, className: "text-gold-500" })),
                                React.createElement('div', { className: "flex flex-col" }, React.createElement('span', { className: "text-white font-oswald tracking-[0.2em] text-lg font-bold italic" }, "ELITE"), React.createElement('span', { className: "text-gold-500 text-[10px] tracking-[0.4em] uppercase" }, "PRESTIGE CLUB"))
                            ),
                            React.createElement(Wifi, { size: 24, className: "text-white/50 rotate-90" })
                        ),
                        
                        React.createElement('div', { className: "my-auto relative z-30" },
                             React.createElement('div', { className: "flex items-center gap-3 mb-1" }, React.createElement('div', { className: "bg-gold-500/20 px-3 py-1 rounded text-gold-400 text-xs font-bold border border-gold-500/50" }, "WELCOME BONUS"), React.createElement('div', { className: "h-px flex-1 bg-gradient-to-r from-gold-500/50 to-transparent" })),
                             React.createElement('div', { className: "flex items-baseline gap-2" }, React.createElement('span', { className: "text-4xl font-black text-transparent bg-clip-text bg-gradient-to-t from-gold-600 to-white drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]" }, "1000"), React.createElement('span', { className: "text-sm text-gold-300 font-bold" }, "COINS")),
                             React.createElement('p', { className: "text-[10px] text-gray-400 mt-1 flex items-center gap-1 animate-pulse" }, React.createElement(RefreshCw, { size: 10 }), "Auto-convert to CASH upon approval")
                        ),
                        
                        React.createElement('div', { className: "mt-auto flex justify-between items-end z-30" },
                            React.createElement('div', {}, React.createElement('p', { className: "text-[8px] text-gray-500 uppercase font-bold tracking-widest" }, "MEMBER"), React.createElement('p', { className: "text-sm text-white font-mono uppercase tracking-wide drop-shadow-md" }, user.fullName || user.username)),
                            React.createElement('div', { className: "text-right" }, React.createElement('p', { className: "text-[8px] text-gray-500 uppercase font-bold" }, "ID"), React.createElement('p', { className: "text-sm font-mono text-white/80" }, user.memberId || "xxxx"))
                        )
                    )
                ),

                React.createElement('div', { className: "w-full max-w-sm space-y-4 relative z-10" },
                    React.createElement('div', { className: "bg-dark-900/80 backdrop-blur-md border border-white/10 p-5 rounded-2xl space-y-4" },
                        React.createElement('h3', { className: "text-center text-white font-bold mb-2 uppercase tracking-wide text-xs opacity-60" }, "Complete Activation"),
                        
                        React.createElement('a', { href: xbetLink, target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5 group hover:border-green-500/50 hover:bg-green-900/10 transition-all cursor-pointer" },
                            React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "w-8 h-8 rounded-full bg-gradient-to-tr from-green-600 to-green-400 flex items-center justify-center font-bold text-white text-xs shadow-lg" }, "1"), React.createElement('div', {}, React.createElement('p', { className: "text-xs text-white font-bold" }, "Register on 1xBet"), React.createElement('p', { className: "text-[10px] text-gray-400" }, "You MUST use Promo Code:"))),
                            React.createElement('button', { onClick: copyCode, className: "flex items-center gap-2 px-2 py-1 bg-green-500/20 text-green-400 rounded-lg border border-green-500/30 font-mono font-bold text-xs hover:bg-green-500/30" }, promoCode, React.createElement(Copy, { size: 12 }))
                        ),

                        React.createElement('a', { href: telegramLink, target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5 group hover:border-blue-500/50 hover:bg-blue-900/10 transition-all" },
                            React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "w-8 h-8 rounded-full bg-gradient-to-tr from-sky-500 to-sky-300 flex items-center justify-center text-white shadow-lg" }, React.createElement(Send, { size: 14 })), React.createElement('div', {}, React.createElement('p', { className: "text-xs text-gray-300" }, "Send ID to Admin"), React.createElement('p', { className: "text-xs font-bold text-sky-400" }, "Telegram Verification"))),
                            React.createElement(ExternalLink, { size: 16, className: "text-gray-500 group-hover:text-white transition-colors" })
                        )
                    ),

                    React.createElement('div', { className: "flex items-center justify-center gap-2 text-xs text-gold-500/70" }, React.createElement('div', { className: "w-2 h-2 rounded-full bg-gold-500 animate-pulse" }), t('wait_admin')),
                    React.createElement('button', { onClick: logout, className: "w-full mt-4 text-gray-500 text-xs font-bold flex items-center justify-center gap-2 hover:text-white transition-colors" }, React.createElement(LogOut, { size: 14 }), t('logout'))
                )
            );
        }

        function AdminPanel({ user, logout, db, showMsg, t }) {
            const [tab, setTab] = useState('deposits'); 
            const [depositReqs, setDepositReqs] = useState([]);
            const [withdrawReqs, setWithdrawReqs] = useState([]);
            const [usersList, setUsersList] = useState([]);
            const [logs, setLogs] = useState([]); 
            const [conf, setConf] = useState({});
            const [editId, setEditId] = useState(null);
            const [balInput, setBalInput] = useState('');

            useEffect(() => {
                const unsubDep = onSnapshot(query(collection(db, "deposits"), where("status", "==", "pending")), s => setDepositReqs(s.docs.map(d => ({id: d.id, ...d.data()}))));
                const unsubWith = onSnapshot(query(collection(db, "withdraws"), where("status", "==", "pending")), s => setWithdrawReqs(s.docs.map(d => ({id: d.id, ...d.data()}))));
                const unsubU = onSnapshot(collection(db, "users"), s => setUsersList(s.docs.map(d => ({id: d.id, ...d.data()}))));
                getDoc(doc(db, "settings", "global")).then(s => s.exists() && setConf(s.data()));
                return () => { unsubDep(); unsubWith(); unsubU(); };
            }, []);

            useEffect(() => {
                if(tab === 'logs') {
                    const q = query(collection(db, "game_logs"), orderBy("date", "desc")); 
                    getDocs(q).then(s => setLogs(s.docs.map(d => d.data())));
                }
            }, [tab]);

            const updateSt = async (uid, st) => {
                const updates = { status: st };
                if (st === 'active') {
                    const targetUser = usersList.find(u => u.id === uid);
                    if (targetUser && targetUser.coins === 0) { updates.coins = 1000; updates.balance = 10; }
                }
                await updateDoc(doc(db, "users", uid), updates);
                showMsg(`User ${st}`);
            };

            const handleDeposit = async (r, act) => {
                if(act === 'app') {
                    const u = usersList.find(x => x.id === r.userId);
                    if(u) await updateDoc(doc(db, "users", r.userId), { balance: Number(u.balance || 0) + Number(r.amount) });
                    await updateDoc(doc(db, "deposits", r.id), { status: 'approved' });
                    showMsg("Deposit Approved & Balance Updated");
                } else {
                    await updateDoc(doc(db, "deposits", r.id), { status: 'rejected' });
                    showMsg("Deposit Rejected");
                }
            };

            const handleWithdraw = async (r, act) => {
                if (act === 'app') {
                    await updateDoc(doc(db, "withdraws", r.id), { status: 'approved' });
                    showMsg("Withdrawal Approved");
                } else {
                    const u = usersList.find(x => x.id === r.userId);
                    if(u) {
                        await updateDoc(doc(db, "users", r.userId), { balance: Number(u.balance || 0) + Number(r.amount) });
                        await updateDoc(doc(db, "withdraws", r.id), { status: 'rejected' });
                        showMsg("Withdrawal Rejected & Refunded");
                    }
                }
            };

            const pendingUsers = usersList.filter(u => u.status === 'pending');
            const activeUsers = usersList.filter(u => u.status !== 'pending');

            return React.createElement('div', { className: "h-screen flex flex-col bg-dark-950 p-6 font-sans overflow-hidden" },
                React.createElement('div', { className: "flex justify-between items-center mb-8 shrink-0" },
                    React.createElement('h1', { className: "text-2xl font-bold text-gold-500 flex gap-2" }, React.createElement(LayoutDashboard), "ADMIN CONTROL"),
                    React.createElement('button', { onClick: logout, className: "bg-red-900/30 text-red-500 p-2 rounded" }, React.createElement(LogOut))
                ),
                React.createElement('div', { className: "grid grid-cols-3 md:grid-cols-6 gap-2 mb-6 shrink-0" },
                    React.createElement('button', { onClick:()=>setTab('deposits'), className: `p-3 rounded-lg font-bold border ${tab==='deposits'?'bg-green-500 text-black border-green-500':'border-white/10 text-gray-400'}` }, `Dep (${depositReqs.length})`),
                    React.createElement('button', { onClick:()=>setTab('withdraws'), className: `p-3 rounded-lg font-bold border ${tab==='withdraws'?'bg-red-500 text-black border-red-500':'border-white/10 text-gray-400'}` }, `With (${withdrawReqs.length})`),
                    React.createElement('button', { onClick:()=>setTab('pending_users'), className: `p-3 rounded-lg font-bold border ${tab==='pending_users'?'bg-yellow-500 text-black border-yellow-500':'border-white/10 text-gray-400'}` }, `New (${pendingUsers.length})`),
                    React.createElement('button', { onClick:()=>setTab('users'), className: `p-3 rounded-lg font-bold border ${tab==='users'?'bg-blue-500 text-black border-blue-500':'border-white/10 text-gray-400'}` }, `Users`),
                    React.createElement('button', { onClick:()=>setTab('logs'), className: `p-3 rounded-lg font-bold border ${tab==='logs'?'bg-purple-500 text-black border-purple-500':'border-white/10 text-gray-400'}` }, `Logs`),
                    React.createElement('button', { onClick:()=>setTab('settings'), className: `p-3 rounded-lg font-bold border ${tab==='settings'?'bg-gray-500 text-black border-gray-500':'border-white/10 text-gray-400'}` }, `Config`)
                ),
                React.createElement('div', { className: "flex-1 overflow-y-auto pb-20 space-y-4 pr-1" },
                    tab === 'deposits' && (depositReqs.length===0 ? React.createElement('p', { className: "text-gray-500 text-center italic" }, "No pending deposits") :
                        depositReqs.map(r => React.createElement('div', { key: r.id, className: "bg-dark-900 p-4 rounded-xl border border-white/10 flex flex-col md:flex-row gap-4" },
                            r.image && React.createElement('img', { src: r.image, className: "w-32 h-32 object-cover rounded bg-black" }),
                            React.createElement('div', { className: "flex-1" },
                                React.createElement('div', { className: "flex justify-between" }, React.createElement('span', { className: "font-bold text-white" }, r.username), React.createElement('span', { className: "text-green-500 font-mono text-xl" }, `+${r.amount}$`)),
                                React.createElement('p', { className: "text-xs text-gray-400 mb-4" }, `${r.method} â€¢ ${new Date(r.date).toLocaleString()}`),
                                React.createElement('div', { className: "flex gap-2" }, React.createElement(Button, { onClick:()=>handleDeposit(r,'app'), variant:'green', className:"py-2 px-4 text-xs" }, "Approve"), React.createElement(Button, { onClick:()=>handleDeposit(r,'rej'), variant:'red', className:"py-2 px-4 text-xs" }, "Reject"))
                            )
                        ))
                    ),
                    tab === 'withdraws' && (withdrawReqs.length===0 ? React.createElement('p', { className: "text-gray-500 text-center italic" }, "No pending withdrawals") :
                        withdrawReqs.map(r => React.createElement('div', { key: r.id, className: "bg-dark-900 p-4 rounded-xl border border-red-900/30 flex flex-col gap-2" },
                            React.createElement('div', { className: "flex justify-between items-center" },
                                React.createElement('div', {}, React.createElement('span', { className: "font-bold text-white block" }, r.username), React.createElement('span', { className: "text-xs text-gray-400" }, `${r.method} â€¢ ${r.details?.phone || r.details?.account || 'N/A'}`)),
                                React.createElement('span', { className: "text-red-500 font-mono text-xl font-bold" }, `-${r.amount}$`)
                            ),
                            React.createElement('div', { className: "flex gap-2 mt-2" }, React.createElement(Button, { onClick:()=>handleWithdraw(r,'app'), variant:'green', className:"py-2 px-4 text-xs flex-1" }, "Approve"), React.createElement(Button, { onClick:()=>handleWithdraw(r,'rej'), variant:'red', className:"py-2 px-4 text-xs flex-1" }, "Reject (Refund)"))
                        ))
                    ),
                    tab === 'pending_users' && (pendingUsers.length===0 ? React.createElement('p', { className: "text-gray-500 text-center italic" }, "No pending registrations") :
                        pendingUsers.map(u => React.createElement('div', { key: u.id, className: "bg-dark-900 p-4 rounded-xl border border-yellow-500/30 flex justify-between items-center" },
                            React.createElement('div', {}, React.createElement('p', { className: "font-bold text-white flex gap-2 items-center" }, u.username, React.createElement('span', {className:"text-[10px] bg-gray-700 px-1 rounded"}, u.country || "??")), React.createElement('p', { className: "text-xs text-gray-400" }, `${u.fullName || 'No Name'} â€¢ ${u.memberId}`)),
                            React.createElement('div', { className: "flex gap-2" }, React.createElement('button', { onClick:()=>updateSt(u.id, 'active'), className: "bg-green-500 hover:bg-green-600 text-black font-bold py-2 px-4 rounded-lg flex items-center gap-1" }, React.createElement(CheckCircle, {size:16}), "ACCEPT"), React.createElement('button', { onClick:()=>deleteDoc(doc(db,"users",u.id)), className: "bg-red-500/20 text-red-500 p-2 rounded-lg" }, React.createElement(X, {size:20})))
                        ))
                    ),
                    tab === 'users' && activeUsers.map(u => React.createElement('div', { key: u.id, className: "bg-dark-900 p-3 rounded-lg border border-white/5 flex justify-between items-center" },
                        React.createElement('div', {}, React.createElement('p', { className: "font-bold text-sm" }, u.username, u.status==='banned' && React.createElement('span',{className:"text-red-500 text-[10px] ml-2"},"BANNED")), React.createElement('p', { className: "text-xs text-gold-500 font-mono" }, `Coins: ${u.coins} | Bal: $${u.balance || 0}`)),
                        editId === u.id ? React.createElement('div', { className: "flex gap-1 bg-black p-1 rounded" }, React.createElement('input', { type:"number", className: "w-20 bg-transparent text-white text-xs px-1", placeholder: "Coins", onChange:e=>setBalInput(e.target.value) }), React.createElement('button', { onClick:()=>{updateDoc(doc(db,"users",u.id),{coins:Number(balInput)}); setEditId(null)}, className: "text-green-500" }, React.createElement(Check, {size:16})), React.createElement('button', { onClick:()=>setEditId(null), className: "text-red-500" }, React.createElement(X, {size:16}))) 
                        : React.createElement('div', { className: "flex gap-2" }, React.createElement('button', { onClick:()=>{setEditId(u.id); setBalInput(u.coins)}, className: "text-blue-500 bg-blue-500/10 p-2 rounded" }, React.createElement(Edit3, {size:14})), u.status !== 'banned' ? React.createElement('button', { onClick:()=>updateSt(u.id, 'banned'), className: "text-orange-500 bg-orange-500/10 p-2 rounded" }, React.createElement(Ban, {size:14})) : React.createElement('button', { onClick:()=>updateSt(u.id, 'active'), className: "text-green-500 bg-green-500/10 p-2 rounded" }, React.createElement(CheckCircle, {size:14})))
                    )),
                    tab === 'logs' && React.createElement('div', { className: "space-y-2" },
                        React.createElement('div', {className:"grid grid-cols-4 font-bold text-xs text-gray-400 mb-2"}, React.createElement('span',{},"Time"), React.createElement('span',{},"User"), React.createElement('span',{},"Game"), React.createElement('span',{},"Profit")),
                        logs.map((l, i) => React.createElement('div', {key:i, className:"grid grid-cols-4 text-xs p-2 bg-dark-900 rounded border border-white/5"}, React.createElement('span', {className:"text-gray-500 truncate"}, new Date(l.date).toLocaleTimeString()), React.createElement('span', {className:"truncate"}, l.username), React.createElement('span', {className:"text-gold-500"}, l.game), React.createElement('span', {className: l.profit >= 0 ? "text-green-500" : "text-red-500"}, l.profit)))
                    ),
                    tab === 'settings' && React.createElement('div', { className: "space-y-4 max-w-md" },
                        React.createElement('p', { className: "text-gold-500 font-bold mb-2 border-b border-white/10 pb-2" }, "Activation Setup"),
                        React.createElement(Input, { placeholder: "Promo Code (e.g. CD0777)", value: conf.promo_code, onChange: e=>setConf({...conf, promo_code:e.target.value}) }),
                        React.createElement(Input, { placeholder: "1XBET Reg Link", value: conf.xbet_link, onChange: e=>setConf({...conf, xbet_link:e.target.value}) }),
                        React.createElement(Input, { placeholder: "Telegram Admin Link", value: conf.telegram_link, onChange: e=>setConf({...conf, telegram_link:e.target.value}) }),
                        React.createElement('p', { className: "text-gold-500 font-bold mb-2 border-b border-white/10 pb-2 mt-6" }, "Payment Instructions"),
                        React.createElement(Input, { placeholder: "Attijari Info (Bank)", value: conf.attijari_info, onChange: e=>setConf({...conf, attijari_info:e.target.value}) }),
                        React.createElement(Input, { placeholder: "CashPlus Info (Cash)", value: conf.cashplus_info, onChange: e=>setConf({...conf, cashplus_info:e.target.value}) }),
                        React.createElement(Input, { placeholder: "Binance/Crypto Info (USDT)", value: conf.binance_info, onChange: e=>setConf({...conf, binance_info:e.target.value}) }),
                        React.createElement('p', { className: "text-gold-500 font-bold mb-2 border-b border-white/10 pb-2 mt-6" }, "Support Center Config"),
                        React.createElement(Input, { placeholder: "Support Link (Telegram/WhatsApp)", value: conf.support_link, onChange: e=>setConf({...conf, support_link:e.target.value}) }),
                        React.createElement(Input, { placeholder: "Support Text Message", value: conf.support_text, onChange: e=>setConf({...conf, support_text:e.target.value}) }),
                        React.createElement('p', { className: "text-gold-500 font-bold mb-2 border-b border-white/10 pb-2 mt-6" }, "App Protocols (Info Pages)"),
                        React.createElement('label', { className: "text-xs text-gray-500" }, "Terms of Service"),
                        React.createElement('textarea', { className: "w-full h-32 bg-dark-900 border border-white/10 p-2 rounded-xl text-white text-xs", placeholder: "Terms Content...", value: conf.terms || DEFAULT_TERMS, onChange: e=>setConf({...conf, terms:e.target.value}) }),
                        React.createElement('label', { className: "text-xs text-gray-500" }, "Privacy Policy"),
                        React.createElement('textarea', { className: "w-full h-32 bg-dark-900 border border-white/10 p-2 rounded-xl text-white text-xs", placeholder: "Privacy Policy Content...", value: conf.policy || DEFAULT_POLICY, onChange: e=>setConf({...conf, policy:e.target.value}) }),
                        React.createElement(Button, { onClick:()=> { setDoc(doc(db,"settings","global"), conf, {merge:true}); showMsg("Saved"); }, full:true }, "Save Config")
                    )
                )
            );
        }

        function SplashScreen() {
            return React.createElement('div', { className: "fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center" },
                React.createElement('div', { className: "relative w-40 h-40 flex items-center justify-center animate-pop" },
                    React.createElement('div', { className: "absolute inset-0 border-4 border-gold-500 rotate-45 rounded-xl shadow-[0_0_50px_#FFD700]" }),
                    React.createElement('div', { className: "absolute inset-2 border-2 border-white/20 rotate-45 rounded-lg" }),
                    React.createElement('h1', { className: "text-7xl font-black text-transparent bg-clip-text bg-gradient-to-tr from-gold-300 to-gold-600 font-oswald tracking-tighter" }, "CD")
                ),
                React.createElement('div', { className: "mt-8 text-gold-500/50 text-sm tracking-[0.5em] font-light animate-pulse" }, "ELITE TIER 1")
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>

