
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CD0777 Elite Club - Tier 1 Experience</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: { 100: '#FFF9C4', 300: '#FDD835', 400: '#FFD700', 500: '#FFC107', 600: '#FFB300', 700: '#FFA000', 800: '#C0A000', 900: '#3d2e07' },
                        dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' },
                        elite: { 500: '#e0e7ff', 900: '#312e81' }
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                        oswald: ['Oswald', 'sans-serif']
                    },
                    animation: {
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'shake-hard': 'shakeHard 0.4s ease-in-out',
                        'flip': 'flip 0.6s ease-in-out forwards',
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'float-up': 'floatUp 1.5s ease-out forwards',
                        'pulse-glow': 'pulseGlow 1.5s infinite',
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'rocket-fly': 'rocketFly 0.5s ease-in-out infinite alternate',
                        'shine': 'shine 2s infinite',
                        'spin-slow': 'spin 1s linear infinite',
                        'win-pulse': 'winPulse 0.8s infinite alternate',
                        'loss-shake': 'lossShake 0.5s',
                        'gold-rain': 'goldRain 3s linear infinite',
                        'slide-in-right': 'slideInRight 0.3s ease-out',
                    },
                    keyframes: {
                        pop: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        shakeHard: { '0%, 100%': { transform: 'translateX(0)' }, '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-10px)' }, '20%, 40%, 60%, 80%': { transform: 'translateX(10px)' } },
                        flip: { '0%': { transform: 'rotateY(0)' }, '100%': { transform: 'rotateY(180deg)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        floatUp: { '0%': { transform: 'translateY(0) scale(1)', opacity: '1' }, '100%': { transform: 'translateY(-50px) scale(1.2)', opacity: '0' } },
                        pulseGlow: { '0%, 100%': { boxShadow: '0 0 10px #FFD700' }, '50%': { boxShadow: '0 0 25px #FFD700' } },
                        slideUp: { '0%': { transform: 'translateY(50px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        rocketFly: { '0%': { transform: 'translateY(0)' }, '100%': { transform: 'translateY(-5px)' } },
                        shine: { '0%': { backgroundPosition: '200% center' }, '100%': { backgroundPosition: '-200% center' } },
                        winPulse: { '0%': { transform: 'scale(1)', filter: 'brightness(1)' }, '100%': { transform: 'scale(1.05)', filter: 'brightness(1.3)' } },
                        lossShake: { '0%, 100%': { transform: 'translate(0, 0)' }, '25%': { transform: 'translate(-5px, 5px)' }, '50%': { transform: 'translate(5px, -5px)' }, '75%': { transform: 'translate(-5px, -5px)' } },
                        goldRain: { '0%': { backgroundPosition: '0 0' }, '100%': { backgroundPosition: '0 1000px' } },
                        slideInRight: { '0%': { transform: 'translateX(100%)' }, '100%': { transform: 'translateX(0)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Oswald:wght@500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #fff; overflow: hidden; touch-action: manipulation; font-family: 'Cairo', sans-serif; }
        
        /* --- TIER 1 CINEMATIC FX --- */
        .noise-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5; opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }
        .glass-panel { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.08); }
        .glass-premium {
            background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1); border-left: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .luxury-bg { background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
        input, select, button, textarea { outline: none; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }
        
        /* ÿ•ÿÆŸÅÿßÿ° ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑŸÉŸÜ ŸÖÿπ ÿ®ŸÇÿßÿ° ÿßŸÑÿ≥ÿ≠ÿ® */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #FFD700; cursor: pointer; margin-top: -10px; box-shadow: 0 0 10px #FFD700; border: 2px solid white; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }
        
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; } 
        .btn-press:active { transform: scale(0.95); transition: transform 0.05s; }
        .slot-spin { animation: slotSpin 0.08s linear infinite; }
        @keyframes slotSpin { 0% { transform: translateY(-20px); filter: blur(5px); } 100% { transform: translateY(20px); filter: blur(5px); } }

        .coin-container { transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.4, 2, 0.55, 0.44); }
        .coin-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .coin-front { background: radial-gradient(#FFD700, #B8860B); transform: rotateY(0deg); }
        .coin-back { background: radial-gradient(#C0C0C0, #808080); transform: rotateY(180deg); }
        
        .star-bg { background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px; opacity: 0.2; }
        .card-shine { background: linear-gradient(105deg, transparent 20%, rgba(255,255,255,0.4) 25%, transparent 30%); animation: shine 3s infinite linear; background-size: 200% 100%; }
        .elite-card-bg { background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%); border: 1px solid rgba(255, 215, 0, 0.3); }
        .hologram { background: linear-gradient(135deg, transparent 0%, rgba(255, 215, 0, 0.1) 50%, transparent 100%); }
        .checkbox-wrapper input:checked + div { background-color: #FFD700; border-color: #FFD700; }
        .checkbox-wrapper input:checked + div svg { display: block; }
        .loader { border: 3px solid rgba(255,255,255,0.1); border-left-color: #FFD700; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        .glass-modal { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 215, 0, 0.1); }
        .text-glow { text-shadow: 0 0 20px #FFD700, 0 0 40px #FFD700; }
        .text-glow-red { text-shadow: 0 0 20px #ef4444, 0 0 40px #991b1b; }
        .cracked-screen { position: fixed; inset: 0; pointer-events: none; z-index: 60; background: radial-gradient(circle at 50% 50%, transparent 50%, rgba(255,0,0,0.1) 100%), linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.1) 50%, transparent 52%); box-shadow: inset 0 0 150px rgba(185, 28, 28, 0.5); background-size: 100% 100%, 200% 200%; }
        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÑŸÖÿπÿßŸÜ ÿßŸÑÿ∞Ÿä ŸäŸÖÿ± ŸÅŸàŸÇ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± */
        @keyframes shimmer {
            0% { left: -100%; opacity: 0; }
            50% { opacity: 0.5; }
            100% { left: 200%; opacity: 0; }
        }
        .btn-shimmer { position: relative; overflow: hidden; }
        .btn-shimmer::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transform: skewX(-20deg);
            animation: shimmer 3s infinite ease-in-out;
            pointer-events: none;
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÜÿ®ÿ∂ ŸÑŸÑÿ≠ÿØŸàÿØ (ŸÑŸÑÿ£ÿ¥Ÿäÿßÿ° ÿßŸÑŸÖŸáŸÖÿ©) */
        @keyframes border-pulse {
            0% { border-color: rgba(255, 215, 0, 0.3); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.2); }
            50% { border-color: rgba(255, 215, 0, 0.8); box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.1); }
            100% { border-color: rgba(255, 215, 0, 0.3); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.2); }
        }
        .border-glow { animation: border-pulse 2s infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.294.0",
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>

    <script type="module">
        import React, { useState, useEffect, useRef, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, Gamepad2, LogOut, Send, CheckCircle, XCircle, ChevronRight, ChevronLeft, Lock, Gem, Home, CreditCard, Wallet, ShieldCheck, Trophy, Instagram, Facebook, ExternalLink, Plus, Trash2, Smartphone, Zap, Check, Dices, RefreshCw, Menu, X, AlertTriangle, Settings, History, Globe, FileText, LifeBuoy, ArrowLeftRight, Bomb, ArrowUp, HelpCircle, Flame, Percent, DollarSign, Image as ImageIcon, KeyRound, Upload, Disc, Rocket, Coins, Grid3X3, Target, Crown, Banknote, Landmark, Wifi, ThumbsUp, ThumbsDown, Users, Ban, Edit3, LockKeyhole, LayoutDashboard, UserCheck, PlayCircle, Copy, MessageCircle, Flag, Info, Loader2, Headphones, CircleDot, MoveUp, Mail, Star, Bell, Speaker } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        // FIX: Added limit and startAfter to imports
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, where, getDocs, orderBy, setDoc, getDoc, deleteDoc, limit, startAfter } from 'firebase/firestore';

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyDJ5B7MncMfyjwb0ZnZ8p3d0bsoQAFqZQY",
            authDomain: "cd0777-casino.firebaseapp.com",
            projectId: "cd0777-casino",
            storageBucket: "cd0777-casino.firebasestorage.app",
            messagingSenderId: "320546250152",
            appId: "1:320546250152:web:730f6e581267b9b315919d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        

        const AudioSys = {
            ctx: null,
            init: () => {
                if (!AudioSys.ctx) AudioSys.ctx = new (window.AudioContext || window.webkitAudioContext)();
                if(AudioSys.ctx.state === 'suspended') AudioSys.ctx.resume();
            },
            playTone: (freq, type, duration, vol=0.1) => {
                if(!AudioSys.ctx) return;
                const osc = AudioSys.ctx.createOscillator();
                const gain = AudioSys.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, AudioSys.ctx.currentTime);
                gain.gain.setValueAtTime(vol, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, AudioSys.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                osc.start();
                osc.stop(AudioSys.ctx.currentTime + duration);
            },
            click: () => { 
                AudioSys.init(); 
                AudioSys.playTone(800, 'sine', 0.1, 0.05); 
                AudioSys.playTone(1200, 'triangle', 0.05, 0.02); 
            },
            success: () => { 
                AudioSys.init(); 
                [523.25, 659.25, 783.99].forEach((f,i) => setTimeout(() => AudioSys.playTone(f, 'sine', 0.6, 0.1), i*80)); 
            },
            error: () => { 
                AudioSys.init(); 
                AudioSys.playTone(150, 'sawtooth', 0.4, 0.1); 
                AudioSys.playTone(100, 'square', 0.4, 0.05); 
            },
            spin: () => { AudioSys.init(); AudioSys.playTone(300, 'square', 0.05, 0.02); },
            win: () => {
                AudioSys.init();
                const notes = [523.25, 659.25, 783.99, 1046.50, 1318.51, 1567.98];
                notes.forEach((n, i) => setTimeout(() => AudioSys.playTone(n, 'triangle', 0.4, 0.1), i*60));
            },
            crash: () => { AudioSys.init(); AudioSys.playTone(100, 'sawtooth', 0.8, 0.2); },
            coins: () => { 
                AudioSys.init(); 
                for(let i=0; i<6; i++) setTimeout(()=> AudioSys.playTone(2000 + Math.random()*1500, 'sine', 0.1, 0.05), i*40); 
            }
        };

        // --- TIER 1: HAPTICS & UX ---
        const hapticFeedback = (type) => {
            if (navigator.vibrate) {
                if(type === 'soft') navigator.vibrate(10);
                if(type === 'success') navigator.vibrate([50, 50, 50]);
                if(type === 'error') navigator.vibrate([50, 100, 50]);
                if(type === 'impact') navigator.vibrate(40);
            }
        };

        // --- TIER 1: CANVAS VFX (PARTICLE SYSTEM) ---
        const WinParticles = ({ active }) => {
            const canvasRef = useRef(null);
            useEffect(() => {
                if(!active) return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                let particles = [];
                let animationFrameId;

                // ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ÿ≥ŸäŸÖÿßÿ™ ÿ∞Ÿáÿ®Ÿäÿ© ŸÅŸÇÿ∑
                for(let i=0; i<60; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        vx: (Math.random() - 0.5) * 2, // ÿ≠ÿ±ŸÉÿ© ÿ®ÿ∑Ÿäÿ¶ÿ© ÿ£ŸÅŸÇŸäÿ©
                        vy: Math.random() * 2 + 1,     // ÿ≥ŸÇŸàÿ∑ ŸÜÿßÿπŸÖ ŸÑŸÑÿ£ÿ≥ŸÅŸÑ
                        size: Math.random() * 3,
                        alpha: Math.random(),
                        flashSpeed: 0.02 + Math.random() * 0.05
                    });
                }

                const render = () => {
                    ctx.clearRect(0,0, canvas.width, canvas.height);
                    particles.forEach((p) => {
                        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≠ÿ±ŸÉÿ©
                        p.y += p.vy;
                        p.x += p.vx;
                        p.alpha += p.flashSpeed;
                        if(p.alpha > 1 || p.alpha < 0) p.flashSpeed = -p.flashSpeed; // ÿ™ÿ£ÿ´Ÿäÿ± ŸàŸÖŸäÿ∂

                        // ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿØŸàŸäÿ± ÿ•ÿ∞ÿß ŸÜÿ≤ŸÑ ÿ£ÿ≥ŸÅŸÑ ÿßŸÑÿ¥ÿßÿ¥ÿ©
                        if(p.y > canvas.height) {
                            p.y = -10;
                            p.x = Math.random() * canvas.width;
                        }

                        // ÿßŸÑÿ±ÿ≥ŸÖ
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                        ctx.fillStyle = `rgba(255, 215, 0, ${Math.abs(p.alpha)})`; // ŸÑŸàŸÜ ÿ∞Ÿáÿ®Ÿä ŸÜŸÇŸä
                        ctx.shadowBlur = 10;
                        ctx.shadowColor = "#FFD700";
                        ctx.fill();
                    });
                    animationFrameId = requestAnimationFrame(render);
                };
                render();
                return () => cancelAnimationFrame(animationFrameId);
            }, [active]);
            
            if(!active) return null;
            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[70]" });
        };

        // --- TIER 1: COMMUNITY CHAT WIDGET (LOCALIZED MIX) ---
        // --- TIER 1: COMMUNITY CHAT WIDGET (FULLY RANDOMIZED) ---
        const ChatWidget = ({ user, t, isRTL }) => {
            const [isOpen, setIsOpen] = useState(false);
            
            // ÿØÿßŸÑÿ© ŸÑÿ™ŸàŸÑŸäÿØ ŸÖÿπÿ±ŸÅÿßÿ™ ŸÖÿ´ŸÑ CD4921
            const getRandomID = () => `CD${Math.floor(1000 + Math.random() * 9000)}`;

            // ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ (ŸÖŸäŸÉÿ≥ ŸÑŸáÿ¨ÿßÿ™)
            const FAKE_MSGS = [
                "Nayda f Crash! üî•", 
                "El denya wal3a fl Plinko", 
                "Retrait instantan√©, merci admin", 
                "Daba chwiya n-withdraw mn CashPlus", 
                "Ya masehal...", 
                "Chkon 3ndo code promo jdid?", 
                "J'ai perdu 50$ üò≠", 
                "Rb7t 200$ f dgga w7da!", 
                "Bonne chance √† tous", 
                "Hats-hab emta ya sa7by?", 
                "Hadchi mrigl 100%", 
                "Admin is the best ‚ù§Ô∏è",
                "Waa3ra had l3ba dyal lmines",
                "Qui veut √©changer des pi√®ces?",
                "Ana ksebt kteer elnaharda üí™",
                "Khsert kolchi... hani raj3 db",
                "Skhina lyoum üî•",
                "Kayn chi rba7 ola walo?",
                "L'appli est top saraha",
                "Mabrouk 3likom kamlin",
                "Withdrawal approved ‚úÖ",
                "Crash 20x!! üöÄ"
            ];

            // üü¢ ÿßŸÑÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ¨ŸàŸáÿ±Ÿä ŸáŸÜÿß:
            // ÿ®ÿØŸÑÿßŸã ŸÖŸÜ Ÿàÿ∂ÿπ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ´ÿßÿ®ÿ™ÿ©ÿå ŸÜŸÇŸàŸÖ ÿ®ÿ™ŸàŸÑŸäÿØ 3 ÿ±ÿ≥ÿßÿ¶ŸÑ ÿπÿ¥Ÿàÿßÿ¶Ÿäÿ© ŸÅŸàÿ±ÿßŸã ÿπŸÜÿØ ÿ®ÿØÿ° ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
            const [msgs, setMsgs] = useState(() => {
                const initialMsgs = [];
                for (let i = 1; i <= 3; i++) {
                    initialMsgs.push({
                        u: getRandomID(),
                        m: FAKE_MSGS[Math.floor(Math.random() * FAKE_MSGS.length)],
                        t: `${i}m ago` // ÿ™ŸàŸÇŸäÿ™ÿßÿ™ ŸàŸáŸÖŸäÿ© (1m ago, 2m ago...)
                    });
                }
                return initialMsgs;
            });
            
            useEffect(() => {
                const interval = setInterval(() => {
                    // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ© ŸÉŸÑ ÿ®ÿ∂ÿπÿ© ÿ´ŸàÿßŸÜŸä
                    if(Math.random() > 0.3) {
                        const newMsg = { 
                            u: getRandomID(), 
                            m: FAKE_MSGS[Math.floor(Math.random() * FAKE_MSGS.length)], 
                            t: 'Just now' 
                        };
                        setMsgs(prev => [newMsg, ...prev.slice(0, 8)]); // ÿ•ÿ®ŸÇÿßÿ° ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ŸÜÿ∏ŸäŸÅÿ©
                    }
                }, 3500);
                return () => clearInterval(interval);
            }, []);

            return React.createElement(React.Fragment, null,
                // ÿ≤ÿ± ÿßŸÑÿØÿ±ÿØÿ¥ÿ© ÿßŸÑÿπÿßÿ¶ŸÖ
                React.createElement('button', { onClick: () => { setIsOpen(!isOpen); AudioSys.click(); }, className: "fixed bottom-24 right-4 z-40 bg-gold-500 text-black p-3 rounded-full shadow-[0_0_20px_#FFD700] btn-press hover:scale-110 transition-transform" }, React.createElement(MessageCircle, { size: 24 })),
                
                // ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                isOpen && React.createElement('div', { className: `fixed inset-y-0 right-0 w-72 bg-dark-950/95 border-l border-gold-500/20 backdrop-blur-xl z-50 p-4 flex flex-col transition-transform ${isRTL?'left-0 border-r border-l-0':''} animate-slide-in-right shadow-2xl` },
                    // ÿßŸÑÿ±ÿ£ÿ≥
                    React.createElement('div', { className: "flex justify-between items-center mb-4 border-b border-white/10 pb-2" }, 
                        React.createElement('h3', { className: "text-gold-500 font-bold font-oswald tracking-wide" }, "ELITE CHAT"), 
                        React.createElement('button', { onClick: ()=>setIsOpen(false), className: "hover:text-red-500 transition-colors" }, React.createElement(X, { className: "text-gray-400" }))
                    ),
                    
                    // ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
                    React.createElement('div', { className: "flex-1 overflow-y-auto space-y-3 no-scrollbar" },
                        msgs.map((m, i) => React.createElement('div', { key: i, className: "bg-white/5 p-3 rounded-lg border border-white/5 animate-fade-in hover:bg-white/10 transition-colors" },
                            React.createElement('div', { className: "flex justify-between items-baseline mb-1" }, 
                                React.createElement('span', { className: "text-gold-500 text-xs font-mono font-bold tracking-wider" }, m.u), 
                                React.createElement('span', { className: "text-gray-500 text-[9px]" }, m.t)
                            ),
                            React.createElement('p', { className: "text-xs text-gray-200 font-cairo" }, m.m)
                        ))
                    ),
                    
                    // ÿ≠ŸÇŸÑ ÿßŸÑŸÉÿ™ÿßÿ®ÿ© (ŸÖÿπÿ∑ŸÑ)
                    React.createElement('div', { className: "mt-2 pt-2 border-t border-white/10" }, 
                        React.createElement('div', { className: "relative" },
                            React.createElement('input', { disabled: true, placeholder: "Chat disabled for non-VIP", className: "w-full bg-black/40 text-xs p-3 rounded-xl border border-white/5 text-center cursor-not-allowed text-gray-500" }),
                            React.createElement(Lock, { size: 12, className: "absolute right-3 top-1/2 -translate-y-1/2 text-gray-600" })
                        )
                    )
                )
            );
        };

        // --- TIER 1: LIVE ACTIVITY TICKER ---
        const LiveTicker = ({ t }) => {
            const [ticker, setTicker] = useState("Welcome to CD0777 Elite Club");
            useEffect(() => {
                const ACTIONS = ["User **82 just withdrew $200 via Bank", "**99 Hit x50 on Crash!", "**12 Deposited $50 via CashPlus", "**05 Won 5000 Coins in Plinko"];
                const int = setInterval(() => { setTicker(ACTIONS[Math.floor(Math.random() * ACTIONS.length)]); }, 5000);
                return () => clearInterval(int);
            }, []);
            return React.createElement('div', { className: "bg-black/40 border-b border-white/5 py-1 px-4 flex justify-center overflow-hidden" }, React.createElement('p', { className: "text-[10px] text-gray-400 whitespace-nowrap animate-pulse flex items-center gap-2" }, React.createElement(CircleDot, { size: 8, className: "text-green-500 animate-ping" }), ticker));
        };

        // ŸÖÿ™ÿ∫Ÿäÿ± ÿπÿßŸÑŸÖŸä ŸÑÿ™ÿÆÿ≤ŸäŸÜ ŸÜÿ≥ÿ®ÿ© ŸÅŸàÿ≤ "ÿßŸÑŸÖŸÜÿ≤ŸÑ" (ÿßŸÑÿ•ÿØÿßÿ±ÿ©)
        // ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© 0.7 ÿ™ÿπŸÜŸä ÿ£ŸÜ ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿ™ÿ±ÿ®ÿ≠ 70% ŸÖŸÜ ÿßŸÑŸàŸÇÿ™
        let GLOBAL_HOUSE_EDGE = 0.7; 

        // ÿßŸÑÿØÿßŸÑÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ≥ÿ™ÿÆÿØŸÖŸáÿß ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸÑÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÅÿßÿ¶ÿ≤
        const shouldHouseWin = () => Math.random() < GLOBAL_HOUSE_EDGE;
        const logGame = async (userId, username, game, bet, win, profit) => {
            if(!userId || userId === 'admin') return;
            try { await addDoc(collection(db, "game_logs"), { userId, username, game, bet, win, profit, date: new Date().toISOString() }); } catch(e) { console.error("Log Error", e); }
        };

        // --- CONSTANTS ---
        const COUNTRIES = [{ code: 'MA', name: 'Morocco', prefix: '+212', flag: 'üá≤üá¶' }, { code: 'DZ', name: 'Algeria', prefix: '+213', flag: 'üá©üáø' }, { code: 'TN', name: 'Tunisia', prefix: '+216', flag: 'üáπüá≥' }, { code: 'EG', name: 'Egypt', prefix: '+20', flag: 'üá™üá¨' }, { code: 'SA', name: 'Saudi Arabia', prefix: '+966', flag: 'üá∏üá¶' }, { code: 'AE', name: 'UAE', prefix: '+971', flag: 'üá¶üá™' }, { code: 'US', name: 'USA', prefix: '+1', flag: 'üá∫üá∏' }];

        const TEXTS = {
            ar: {
                welcome: "ŸÖÿ±ÿ≠ÿ®ÿßŸã", login: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ", register: "ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®",
                name: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ", phone: "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ", email: "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä", user: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ", pass: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                home: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©", casino: "ŸÉÿßÿ≤ŸäŸÜŸà", tasks: "ÿßŸÑŸÖŸáÿßŸÖ", wallet: "ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©",
                settings: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™", logout: "ÿÆÿ±Ÿàÿ¨", success: "ÿπŸÖŸÑŸäÿ© ŸÜÿßÿ¨ÿ≠ÿ©", error: "ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£",
                you_get: "ŸÑŸÇÿØ ÿ±ÿ®ÿ≠ÿ™", you_lose: "ÿ≠ÿ∏ ÿ£ŸàŸÅÿ±",
                inputs_err: "ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÜÿßŸÇÿµÿ©", must_agree: "Ÿäÿ¨ÿ® ÿßŸÑŸÖŸàÿßŸÅŸÇÿ© ÿπŸÑŸâ ÿßŸÑÿ¥ÿ±Ÿàÿ∑",
                reset_req: "ÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±", pass_sent: "ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ•ŸÑŸâ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
                big_win: "ŸÅŸàÿ≤ ÿ£ÿ≥ÿ∑Ÿàÿ±Ÿä!", you_lost: "ÿÆÿ≥ÿßÿ±ÿ© ŸÖÿ§ŸÑŸÖÿ©", update_success: "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™",
                terms: "ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿßÿ≠ŸÉÿßŸÖ", policy: "ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©", history: "ÿßŸÑÿ≥ÿ¨ŸÑ",
                deposit: "ÿ¥ÿ≠ŸÜ ÿßŸÑÿ≠ÿ≥ÿßÿ®", withdraw: "ÿ≥ÿ≠ÿ® ÿßŸÑÿßÿ±ÿ®ÿßÿ≠", exchange: "ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿπŸÖŸÑÿßÿ™",
                amount: "ÿßŸÑŸÖÿ®ŸÑÿ∫", proof_needed: "ÿßŸÑŸÖÿ±ÿ¨Ÿà ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÖÿ®ŸÑÿ∫ Ÿàÿ±ŸÅÿπ ÿßŸÑÿµŸàÿ±ÿ©", upload_proof: "ÿ±ŸÅÿπ ÿ•ÿ´ÿ®ÿßÿ™ ÿßŸÑÿØŸÅÿπ",
                method_bank: "ÿ™ÿ≠ŸàŸäŸÑ ÿ®ŸÜŸÉŸä", method_cash: "ŸÉÿßÿ¥ ÿ®ŸÑÿ≥ / ŸàÿßŸÅÿß", method_crypto: "ÿπŸÖŸÑÿßÿ™ ÿ±ŸÇŸÖŸäÿ©", method_recharge: "ÿ™ÿπÿ®ÿ¶ÿ© ÿ±ÿµŸäÿØ",
                rib: "ÿ±ŸÇŸÖ ÿßŸÑÿ™ÿπÿ±ŸäŸÅ ÿßŸÑÿ®ŸÜŸÉŸä (RIB)", bank_name: "ÿßÿ≥ŸÖ ÿßŸÑÿ®ŸÜŸÉ", cnie: "ÿ±ŸÇŸÖ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸàÿ∑ŸÜŸäÿ©", wallet_addr: "ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© (USDT)",
                req_sent: "ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠", req_wait: "ÿ≥Ÿäÿ™ŸÖ ŸÖÿ±ÿßÿ¨ÿπÿ© ÿ∑ŸÑÿ®ŸÉ ŸàÿßŸÑŸÖŸàÿßŸÅŸÇÿ© ÿπŸÑŸäŸá ŸÇÿ±Ÿäÿ®ÿßŸã.", network: "ÿßŸÑÿ¥ÿ®ŸÉÿ©",
                personal_info: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©", old_pass: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑŸÇÿØŸäŸÖÿ©", new_pass: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©",
                wait_admin: "ÿ≠ÿ≥ÿßÿ®ŸÉ ŸÇŸäÿØ ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ©ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±...", menu: "ÿßŸÑŸÇÿßÿ¶ŸÖÿ©", lang: "ÿßŸÑŸÑÿ∫ÿ©",
                crash: "ŸÉÿ±ÿßÿ¥ (ÿ∑Ÿäÿßÿ±)", slots: "ÿ≥ŸÑŸàÿ™ÿ≥", keno: "ŸÉŸäŸÜŸà", limbo: "ŸÑŸäŸÖÿ®Ÿà", coinflip: "ÿπŸÖŸÑÿ©",
                mines: "ÿßŸÑÿ£ŸÑÿ∫ÿßŸÖ", plinko: "ÿ®ŸÑŸäŸÜŸÉŸà", dice: "ŸÜÿ±ÿØ", wheel: "ÿπÿ¨ŸÑÿ© ÿßŸÑÿ≠ÿ∏", hilo: "ŸáÿßŸä ŸÑŸà",
                crashed: "ÿ™ÿ≠ÿ∑ŸÖ", bet_placed: "ÿ™ŸÖ ÿßŸÑÿ±ŸáÿßŸÜ", play: "ŸÑÿπÿ®", cashout: "ÿ≥ÿ≠ÿ®", rolling: "ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÑÿπÿ®...",
                convert: "ÿ™ÿ≠ŸàŸäŸÑ", processing: "ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...", execute: "ÿ™ŸÜŸÅŸäÿ∞", no_tasks: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸáÿßŸÖ ÿ≠ÿßŸÑŸäÿßŸã",
                terms_link: "ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ", agree_terms: "ÿ£ŸàÿßŸÅŸÇ ÿπŸÑŸâ ",
                user_id_label: "ÿßŸÑŸÖÿπÿ±ŸÅ / ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
                email_sent_title: "ÿ™ŸÖ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ŸÜÿ¨ÿßÿ≠",
                email_sent_desc: "ÿ±ÿßÿ¨ÿπ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÑÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±."
            },
            en: {
                welcome: "Welcome", login: "Login", register: "Register",
                name: "Full Name", phone: "Phone", email: "Email", user: "Username", pass: "Password",
                home: "Home", casino: "Casino", tasks: "Tasks", wallet: "Wallet",
                settings: "Settings", logout: "Logout", success: "Success", error: "Error",
                you_get: "YOU WIN", you_lose: "YOU LOSE",
                inputs_err: "Missing Inputs", must_agree: "You must agree to the Terms",
                reset_req: "Password Reset", pass_sent: "Password sent to your email",
                big_win: "LEGENDARY WIN!", you_lost: "CRITICAL LOSS", update_success: "Info Updated",
                terms: "Terms of Service", policy: "Privacy Policy", history: "History",
                deposit: "Deposit", withdraw: "Withdraw", exchange: "Exchange",
                amount: "Amount", proof_needed: "Transfer amount & upload proof", upload_proof: "Upload Proof",
                method_bank: "Bank Transfer", method_cash: "Cash Plus", method_crypto: "Crypto", method_recharge: "Mobile Recharge",
                rib: "RIB / Account Num", bank_name: "Bank Name", cnie: "National ID", wallet_addr: "Wallet Address",
                req_sent: "Request Sent", req_wait: "Your request is under review.", network: "Network",
                personal_info: "Personal Info", old_pass: "Old Password", new_pass: "New Password",
                wait_admin: "Account under review, please wait...", menu: "Menu", lang: "Language",
                crash: "Crash", slots: "Slots", keno: "Keno", limbo: "Limbo", coinflip: "CoinFlip",
                mines: "Mines", plinko: "Plinko", dice: "Dice", wheel: "Wheel", hilo: "HiLo",
                crashed: "CRASHED", bet_placed: "Bet Placed", play: "PLAY", cashout: "CASHOUT", rolling: "Rolling...",
                convert: "Convert", processing: "Processing...", execute: "Execute", no_tasks: "No Tasks",
                terms_link: "Terms & Conditions", agree_terms: "I agree to ",
                user_id_label: "Username / ID",
                email_sent_title: "Email Sent",
                email_sent_desc: "Check your email inbox to recover password."
            }
        };

        
        const DEFAULT_TERMS = `
1. ÿßŸÑÿπÿ∂ŸàŸäÿ© ÿßŸÑÿ≠ÿµÿ±Ÿäÿ©:
ÿ™ŸèÿπÿØ ŸÖŸÜÿµÿ© CD0777 Elite Club ŸÖÿ¨ÿ™ŸÖÿπÿßŸã ŸÖÿ∫ŸÑŸÇÿßŸã ŸÑŸÑÿ£ÿπÿ∂ÿßÿ° ÿßŸÑŸÖÿπÿ™ŸÖÿØŸäŸÜ (Vetted Members). ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ŸÅŸä ÿßŸÑŸÖŸÜÿµÿ© Ÿàÿßÿ≥ÿ™ÿÆÿØÿßŸÖ "ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ´ÿ±ÿßÿ°" Ÿäÿπÿ™ÿ®ÿ± ÿßŸÖÿ™Ÿäÿßÿ≤ÿßŸã ŸàŸÑŸäÿ≥ ÿ≠ŸÇÿßŸãÿå ŸàŸäÿÆÿ∂ÿπ ŸÑŸÖŸàÿßŸÅŸÇÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿπŸÑŸäÿß.

2. ÿ®ÿ±Ÿàÿ™ŸàŸÉŸàŸÑ ÿßŸÑŸÜÿ≤ÿßŸáÿ©:
ŸÑÿ∂ŸÖÿßŸÜ ÿπŸÖŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿ®ÿØŸÇÿ©ÿå ŸäŸèÿ¥ÿ™ÿ±ÿ∑ ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ (ŸÑÿØŸâ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ° ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨ŸäŸäŸÜ) ŸÜÿ¥ÿ∑ÿßŸã ŸàŸÖÿ≥ÿ¨ŸÑÿßŸã ÿ™ÿ≠ÿ™ ÿßŸÑÿ±ŸÖÿ≤ ÿßŸÑÿ™ÿπÿ±ŸäŸÅŸä ŸÑŸÑŸÜÿßÿØŸä. ÿ£Ÿä ŸÖÿ≠ÿßŸàŸÑÿ© ŸÑÿ±ÿ®ÿ∑ ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ŸÇÿØŸäŸÖÿ© ÿ£Ÿà ÿ∫Ÿäÿ± ŸÖŸÅÿπŸÑÿ© ÿ≥ÿ™ÿ§ÿØŸä ÿ•ŸÑŸâ ÿ≠ÿ∏ÿ± ÿßŸÑÿπÿ∂ŸàŸäÿ© ŸÅŸàÿ±ÿßŸã.

3. ÿßŸÑÿ£ÿµŸàŸÑ ÿßŸÑÿ±ŸÇŸÖŸäÿ© (Coins):
ÿßŸÑÿπŸÖŸÑÿßÿ™ ÿØÿßÿÆŸÑ ÿßŸÑŸÖŸÜÿµÿ© ŸáŸä Ÿàÿ≠ÿØÿßÿ™ ÿ±ŸÇŸÖŸäÿ© ÿ™Ÿèÿ≥ÿ™ÿÆÿØŸÖ ŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸàÿßŸÑŸÖÿ≠ÿßŸÉÿßÿ©. ÿ™ÿ≠ŸàŸäŸÑ Ÿáÿ∞Ÿá ÿßŸÑŸàÿ≠ÿØÿßÿ™ ÿ•ŸÑŸâ "ÿ£ÿ±ÿ®ÿßÿ≠ ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ≥ÿ≠ÿ®" ŸäÿÆÿ∂ÿπ ŸÑÿ™ÿØŸÇŸäŸÇ ŸÖÿßŸÑŸä ÿµÿßÿ±ŸÖ ŸÑÿ∂ŸÖÿßŸÜ ÿπÿØŸÖ Ÿàÿ¨ŸàÿØ ÿ™ŸÑÿßÿπÿ® ŸÅŸä ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨.

4. ÿ•ÿÆŸÑÿßÿ° ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑŸäÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©:
ŸÜÿ≠ŸÜ ŸÜŸÇÿØŸÖ ÿ£ÿØŸàÿßÿ™ ÿ™ÿ≠ŸÑŸäŸÑŸäÿ© ŸÖÿ™ŸÇÿØŸÖÿ© ŸàŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ŸÖÿ≠ŸÅÿ∏ÿ©. ŸàŸÖÿπ ÿ∞ŸÑŸÉÿå ŸÅÿ•ŸÜ ŸÇÿ±ÿßÿ±ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸàÿßŸÑŸÖÿÆÿßÿ∑ÿ±ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ© ÿ™ŸÇÿπ ÿπŸÑŸâ ÿπÿßÿ™ŸÇ ÿßŸÑÿπÿ∂Ÿà ÿ®ÿßŸÑŸÉÿßŸÖŸÑ. ÿßŸÑŸÜÿßÿØŸä ŸÑÿß Ÿäÿ™ÿ≠ŸÖŸÑ ŸÖÿ≥ÿ§ŸàŸÑŸäÿ© ÿ™ŸÇŸÑÿ®ÿßÿ™ ÿßŸÑÿ£ÿ≥ŸàÿßŸÇ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©.

5. ÿ™ÿ¨ŸÖŸäÿØ ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™:
Ÿäÿ≠ŸÇ ŸÑŸÑŸÜÿßÿØŸä ÿ™ÿ¨ŸÖŸäÿØ ÿ£Ÿä ÿ≠ÿ≥ÿßÿ® ŸäŸèÿ¥ÿ™ÿ®Ÿá ŸÅŸä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖŸá ŸÑÿ®ÿ±ÿßŸÖÿ¨ "ÿ®Ÿàÿ™" ÿÆÿßÿ±ÿ¨Ÿäÿ© ÿ£Ÿà ŸÖÿ≠ÿßŸàŸÑÿ© ÿßÿÆÿ™ÿ±ÿßŸÇ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ÿ¥ŸÅŸäÿ± ÿßŸÑÿÆÿßÿµ ÿ®ÿßŸÑŸÖŸàŸÇÿπ.

6. ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ÿßÿ™:
ŸÜÿ≠ÿ™ŸÅÿ∏ ÿ®ÿßŸÑÿ≠ŸÇ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿ®ÿ±Ÿàÿ™ŸàŸÉŸàŸÑÿßÿ™ ÿßŸÑÿπŸÖŸÑ ŸàÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸÅŸä ÿ£Ÿä ŸàŸÇÿ™ ŸÑÿ∂ŸÖÿßŸÜ ŸÉŸÅÿßÿ°ÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ.
`;
        const DEFAULT_POLICY = `
1. ÿßŸÑÿ™ÿ¥ŸÅŸäÿ± ŸàÿßŸÑÿ≠ŸÖÿßŸäÿ©:
ŸÜÿ≠ŸÜ ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿ™ŸÇŸÜŸäÿßÿ™ ÿ™ÿ¥ŸÅŸäÿ± ÿπÿ≥ŸÉÿ±Ÿäÿ© (AES-256) ŸÑÿ≠ŸÖÿßŸäÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿπÿ∂ÿßÿ°. ÿ¨ŸÖŸäÿπ ŸÖÿπŸÑŸàŸÖÿßÿ™ŸÉ ÿßŸÑÿ≠ÿ≥ÿßÿ≥ÿ© ŸàŸÖÿπÿ±ŸÅÿßÿ™ŸÉ ÿßŸÑÿ±ŸÇŸÖŸäÿ© ŸÖÿ¥ŸÅÿ±ÿ© ÿ®ÿßŸÑŸÉÿßŸÖŸÑ ŸàŸÑÿß ŸäŸÖŸÉŸÜ ŸÑÿ£Ÿä ÿ∑ÿ±ŸÅ ÿ´ÿßŸÑÿ´ ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸäŸáÿß.

2. ÿ¨ŸÖÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≠ÿØŸàÿØ:
ŸÑÿß ŸÜŸÇŸàŸÖ ÿ®ÿ¨ŸÖÿπ ÿ£Ÿä ÿ®ŸäÿßŸÜÿßÿ™ ÿ¥ÿÆÿµŸäÿ© ÿ∫Ÿäÿ± ÿ∂ÿ±Ÿàÿ±Ÿäÿ©. ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© (ÿßŸÑŸÖÿπÿ±ŸÅÿå ÿßŸÑÿ¨Ÿáÿßÿ≤ÿå ÿßŸÑÿØŸàŸÑÿ©) ÿ™Ÿèÿ≥ÿ™ÿÆÿØŸÖ ÿ≠ÿµÿ±ŸäÿßŸã ŸÑÿ∫ÿ±ÿ∂ "ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿßŸÑÿ£ŸÖŸÜŸä" ŸàŸÑÿ∂ŸÖÿßŸÜ ÿπÿØŸÖ ÿ™ŸÉÿ±ÿßÿ± ÿßŸÑÿπÿ∂ŸàŸäÿßÿ™.

3. ÿßŸÑÿ≥ÿ±Ÿäÿ© ÿßŸÑÿ™ÿßŸÖÿ©:
ŸäŸÑÿ™ÿ≤ŸÖ ÿßŸÑŸÜÿßÿØŸä ÿ®ÿ≥Ÿäÿßÿ≥ÿ© "ÿπÿØŸÖ ÿßŸÑÿ•ŸÅÿµÿßÿ≠" (Non-Disclosure). ŸÑÿß Ÿäÿ™ŸÖ ÿ®Ÿäÿπ ÿ£Ÿà ÿ™ÿ£ÿ¨Ÿäÿ± ÿ£Ÿà ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿ£ÿπÿ∂ÿßÿ° ÿßŸÑŸÜÿÆÿ®ÿ© ŸÖÿπ ÿ£Ÿä ÿ¨Ÿáÿßÿ™ ÿ™ÿ≥ŸàŸäŸÇŸäÿ© ÿ£Ÿà ÿ≠ŸÉŸàŸÖŸäÿ©ÿå ÿ•ŸÑÿß ŸÅŸä ÿ≠ÿßŸÑÿßÿ™ ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ÿßŸÑŸÇÿßŸÜŸàŸÜŸä ÿßŸÑŸÇÿµŸàŸâ.

4. ŸÖŸÑŸÅÿßÿ™ ÿßŸÑÿßÿ±ÿ™ÿ®ÿßÿ∑ (Cookies):
ŸÜÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÑŸÅÿßÿ™ ÿ™ÿπÿ±ŸäŸÅ ÿßÿ±ÿ™ÿ®ÿßÿ∑ ÿ¢ŸÖŸÜÿ© ŸÑÿ∂ŸÖÿßŸÜ ÿßÿ≥ÿ™ŸÖÿ±ÿßÿ± ÿ¨ŸÑÿ≥ÿ™ŸÉ Ÿàÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ "ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÑŸäŸÑŸä" Ÿàÿ™ŸÅÿ∂ŸäŸÑÿßÿ™ ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸÉ.

5. ÿßŸÑŸÖŸàÿßŸÅŸÇÿ©:
ÿ®ŸÖÿ¨ÿ±ÿØ ÿ™ŸÅÿπŸäŸÑ ÿ≠ÿ≥ÿßÿ®ŸÉÿå ŸÅÿ•ŸÜŸÉ ÿ™ŸàÿßŸÅŸÇ ÿ∂ŸÖŸÜŸäÿßŸã ÿπŸÑŸâ ÿ®ÿ±Ÿàÿ™ŸàŸÉŸàŸÑÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ ŸàÿßŸÑÿÆÿµŸàÿµŸäÿ© ÿßŸÑŸÖÿ∞ŸÉŸàÿ±ÿ© ÿ£ÿπŸÑÿßŸá.
`;
        // --- COMPONENTS ---
        // --- NEW REALISM HELPERS ---
        // 4. ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÇÿµÿßÿµÿßÿ™ ÿßŸÑÿ∞Ÿáÿ®Ÿäÿ© (ÿπŸÜÿØ ÿßŸÑŸÅŸàÿ≤)
        const WinConfetti = ({ active }) => {
            const canvasRef = useRef(null);
            
            useEffect(() => {
                if(!active) return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                let particles = [];
                const colors = ['#FFD700', '#FDB931', '#FFFFFF', '#FFA500']; // ÿØÿ±ÿ¨ÿßÿ™ ÿßŸÑÿ∞Ÿáÿ®
                
                for(let i=0; i<100; i++) {
                    particles.push({
                        x: window.innerWidth / 2, // Ÿäÿ®ÿØÿ£ ŸÖŸÜ ÿßŸÑŸÖŸÜÿ™ÿµŸÅ
                        y: window.innerHeight / 2,
                        vx: (Math.random() - 0.5) * 20, // ÿßŸÜŸÅÿ¨ÿßÿ± ÿ≥ÿ±Ÿäÿπ
                        vy: (Math.random() - 0.5) * 20,
                        size: Math.random() * 8 + 2,
                        color: colors[Math.floor(Math.random() * colors.length)],
                        life: 1,
                        gravity: 0.5
                    });
                }

                let animationFrame;
                const render = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    particles.forEach((p, index) => {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += p.gravity; // ÿßŸÑÿ¨ÿßÿ∞ÿ®Ÿäÿ©
                        p.life -= 0.015;
                        p.vx *= 0.95; // ÿßÿ≠ÿ™ŸÉÿßŸÉ ÿßŸÑŸáŸàÿßÿ°
                        p.vy *= 0.95;

                        if (p.life <= 0) particles.splice(index, 1);

                        ctx.globalAlpha = p.life;
                        ctx.fillStyle = p.color;
                        ctx.fillRect(p.x, p.y, p.size, p.size); // ŸÖÿ±ÿ®ÿπÿßÿ™ confetti
                    });
                    
                    if (particles.length > 0) {
                        animationFrame = requestAnimationFrame(render);
                    } else {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                    }
                };
                render();
                return () => cancelAnimationFrame(animationFrame);
            }, [active]);

            if(!active) return null;
            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[80]" });
        };
        // 3. Gold Dust Cursor Effect (ÿ∫ÿ®ÿßÿ± ÿßŸÑÿ∞Ÿáÿ® ÿπŸÜÿØ ÿßŸÑŸÑŸÖÿ≥)
        const CursorTrail = () => {
            const canvasRef = useRef(null);
            const particles = useRef([]);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                const addParticle = (x, y) => {
                    for(let i=0; i<3; i++) { 
                        particles.current.push({
                            x, y,
                            vx: (Math.random() - 0.5) * 2,
                            vy: (Math.random() - 0.5) * 2,
                            life: 1, 
                            size: Math.random() * 3
                        });
                    }
                };

                const handleMove = (e) => {
                    const x = e.touches ? e.touches[0].clientX : e.clientX;
                    const y = e.touches ? e.touches[0].clientY : e.clientY;
                    addParticle(x, y);
                };

                window.addEventListener('mousemove', handleMove);
                window.addEventListener('touchmove', handleMove);

                const animate = () => {
                    if(!canvas) return;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    particles.current.forEach((p, i) => {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.life -= 0.02; 
                        
                        if(p.life <= 0) {
                            particles.current.splice(i, 1);
                        } else {
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI*2);
                            ctx.fillStyle = `rgba(255, 215, 0, ${p.life})`;
                            ctx.fill();
                        }
                    });
                    requestAnimationFrame(animate);
                };
                animate();

                return () => {
                    window.removeEventListener('mousemove', handleMove);
                    window.removeEventListener('touchmove', handleMove);
                };
            }, []);

            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[9999]" });
        };
        // 1. Animated Counter (ÿ≥ŸÑÿ≥ ŸÑŸÑÿπÿØÿßÿØÿßÿ™)
        const AnimatedCounter = ({ value }) => {
            const [displayValue, setDisplayValue] = useState(0);
            useEffect(() => {
                let start = displayValue;
                const end = parseInt(value) || 0;
                if (start === end) return;
                const duration = 1000;
                const startTime = performance.now();
                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easeOut = 1 - Math.pow(1 - progress, 3);
                    const current = Math.floor(start + (end - start) * easeOut);
                    setDisplayValue(current);
                    if (progress < 1) requestAnimationFrame(animate); else setDisplayValue(end);
                };
                requestAnimationFrame(animate);
            }, [value]);
            return React.createElement('span', { className: "font-mono tracking-wider" }, displayValue.toLocaleString());
        };

        // 2. Crash Graph (ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä ŸÑŸÑÿµÿßÿ±ŸàÿÆ)
        const CrashGraph = ({ multiplier, gameState }) => {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrameId;
                const draw = () => {
                    if (!canvas) return;
                    canvas.width = canvas.parentElement.offsetWidth;
                    canvas.height = canvas.parentElement.offsetHeight;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    if (gameState === 'FLYING' || gameState === 'CRASHED') {
                        const h = canvas.height; const w = canvas.width;
                        const progress = Math.min((multiplier - 1) / 10, 1);
                        ctx.beginPath();
                        ctx.moveTo(0, h);
                        const endX = w * 0.8; const endY = h - (h * 0.8 * progress);
                        ctx.quadraticCurveTo(w * 0.5, h, endX, endY);
                        ctx.lineWidth = 4;
                        ctx.strokeStyle = gameState === 'CRASHED' ? '#ef4444' : '#fbbf24';
                        ctx.shadowBlur = 15; ctx.shadowColor = ctx.strokeStyle;
                        ctx.stroke();
                        ctx.lineTo(endX, h); ctx.lineTo(0, h);
                        const grad = ctx.createLinearGradient(0, endY, 0, h);
                        grad.addColorStop(0, gameState === 'CRASHED' ? 'rgba(239, 68, 68, 0.2)' : 'rgba(251, 191, 36, 0.2)');
                        grad.addColorStop(1, 'rgba(0,0,0,0)');
                        ctx.fillStyle = grad; ctx.fill();
                    }
                    // 3. Gold Dust Cursor Effect (ÿ∫ÿ®ÿßÿ± ÿßŸÑÿ∞Ÿáÿ® ÿπŸÜÿØ ÿßŸÑŸÑŸÖÿ≥)
        const CursorTrail = () => {
            const canvasRef = useRef(null);
            const particles = useRef([]);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                const addParticle = (x, y) => {
                    for(let i=0; i<3; i++) { // 3 ÿ¨ÿ≥ŸäŸÖÿßÿ™ ŸÑŸÉŸÑ ÿ≠ÿ±ŸÉÿ©
                        particles.current.push({
                            x, y,
                            vx: (Math.random() - 0.5) * 2,
                            vy: (Math.random() - 0.5) * 2,
                            life: 1, // ÿßŸÑÿ≠Ÿäÿßÿ© ÿ™ÿ®ÿØÿ£ ŸÖŸÜ 1 Ÿàÿ™ŸÜŸÇÿµ
                            size: Math.random() * 3
                        });
                    }
                };

                const handleMove = (e) => {
                    const x = e.touches ? e.touches[0].clientX : e.clientX;
                    const y = e.touches ? e.touches[0].clientY : e.clientY;
                    addParticle(x, y);
                };

                window.addEventListener('mousemove', handleMove);
                window.addEventListener('touchmove', handleMove);

                const animate = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    particles.current.forEach((p, i) => {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.life -= 0.02; // ÿ≥ÿ±ÿπÿ© ÿßŸÑÿßÿÆÿ™ŸÅÿßÿ°
                        
                        if(p.life <= 0) {
                            particles.current.splice(i, 1);
                        } else {
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI*2);
                            ctx.fillStyle = `rgba(255, 215, 0, ${p.life})`; // ŸÑŸàŸÜ ÿ∞Ÿáÿ®Ÿä ŸäÿÆÿ™ŸÅŸä
                            ctx.fill();
                        }
                    });
                    requestAnimationFrame(animate);
                };
                animate();

                return () => {
                    window.removeEventListener('mousemove', handleMove);
                    window.removeEventListener('touchmove', handleMove);
                };
            }, []);

            return React.createElement('canvas', { ref: canvasRef, className: "fixed inset-0 pointer-events-none z-[9999]" });
        };
                };
                animationFrameId = requestAnimationFrame(draw);
                return () => cancelAnimationFrame(animationFrameId);
            }, [multiplier, gameState]);
            return React.createElement('canvas', { ref: canvasRef, className: "absolute inset-0 w-full h-full z-0" });
        };
        // --- NEW REALISM COMPONENTS ---
        
        // 1. ÿπÿØÿßÿØ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä (Rolling Numbers)
        const CountUp = ({ value, prefix = '' }) => {
            const [displayVal, setDisplayVal] = useState(0);
            const prevValueRef = useRef(0);
            const [isAnimating, setIsAnimating] = useState(false);
            
            useEffect(() => {
                const end = parseFloat(value) || 0;
                if (displayVal === end) return;
                
                setIsAnimating(true);
                const start = displayVal;
                const duration = 1200; // ÿ≥ÿ±ÿπÿ© ÿßŸÜÿ≥Ÿäÿßÿ®Ÿäÿ© ÿπÿßŸÑŸÖŸäÿ©
                const startTime = performance.now();

                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const ease = 1 - Math.pow(1 - progress, 4); // ÿ≠ÿ±ŸÉÿ© ÿßŸÜÿ≥Ÿäÿßÿ®Ÿäÿ© ÿ¨ÿØÿßŸã
                    
                    const current = start + (end - start) * ease;
                    setDisplayVal(current);

                    if (progress < 1) requestAnimationFrame(animate);
                    else {
                        setDisplayVal(end);
                        setIsAnimating(false);
                        prevValueRef.current = end;
                    }
                };
                requestAnimationFrame(animate);
            }, [value]);

            const isWinning = value > prevValueRef.current && isAnimating;

            return React.createElement('span', { 
                className: `font-mono tracking-tighter transition-all duration-300 ${isWinning ? 'scale-110 text-white' : 'text-gold-400'}`,
                style: { 
                    display: 'inline-block',
                    textShadow: isWinning ? '0 0 10px rgba(255,215,0,0.5)' : 'none',
                    transform: isWinning ? 'translateY(-1px)' : 'none'
                }
            }, 
                // ÿßŸÑÿ™ÿπÿØŸäŸÑ ŸáŸÜÿß: ÿ•ÿ∂ÿßŸÅÿ© .toFixed(2) ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿØŸÇÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©
                `${prefix}${displayVal.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
            );
        };

        // 2. ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖÿ±ÿßŸáŸÜÿßÿ™ ÿßŸÑÿ≠Ÿäÿ© (Live Bets Simulation)
        const LiveBetsTable = () => {
            const [bets, setBets] = useState([]);
            useEffect(() => {
                const names = ['Amine_X', 'Sarah.M', 'Karim99', 'Simo_Pro', 'Hassan_DZ', 'Youssef', 'Nour', 'User_88'];
                const games = ['Crash', 'Slots', 'Mines', 'Plinko'];
                const interval = setInterval(() => {
                    const win = Math.random() > 0.6; // ŸÜÿ≥ÿ®ÿ© ŸÅŸàÿ≤ ŸàÿßŸÇÿπŸäÿ©
                    const amt = Math.floor(Math.random() * 800) + 50;
                    const newBet = {
                        id: Date.now(),
                        user: names[Math.floor(Math.random() * names.length)],
                        game: games[Math.floor(Math.random() * games.length)],
                        amount: amt,
                        win: win,
                        profit: win ? Math.floor(amt * (Math.random() * 2 + 0.5)) : 0
                    };
                    setBets(prev => [newBet, ...prev.slice(0, 3)]); // ÿ•ÿ∏Ÿáÿßÿ± ÿ¢ÿÆÿ± 4 ŸÅŸÇÿ∑ ŸÑÿ™ŸàŸÅŸäÿ± ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ©
                }, 1500); 
                return () => clearInterval(interval);
            }, []);

            return React.createElement('div', { className: "w-full mt-4 bg-black/40 border border-white/5 rounded-xl p-3 animate-fade-in backdrop-blur-sm" },
                React.createElement('div', { className: "flex items-center gap-2 mb-2 border-b border-white/5 pb-1" },
                    React.createElement('div', { className: "w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse" }),
                    React.createElement('span', { className: "text-[9px] font-bold text-gray-400 uppercase tracking-widest" }, "Live Feed")
                ),
                React.createElement('div', { className: "space-y-1.5" },
                    bets.map(b => React.createElement('div', { key: b.id, className: "flex justify-between items-center text-[10px] animate-slide-in-right" },
                        React.createElement('div', { className: "flex items-center gap-1.5" },
                            React.createElement(User, { size: 10, className: "text-gray-600" }),
                            React.createElement('span', { className: "text-gray-300 font-bold" }, b.user)
                        ),
                        React.createElement('span', { className: "text-gray-500 hidden sm:block" }, b.game),
                        React.createElement('div', { className: "text-right" },
                            b.win 
                            ? React.createElement('span', { className: "text-green-400 font-mono font-bold" }, `+${b.profit}`)
                            : React.createElement('span', { className: "text-gray-600 font-mono" }, `-${b.amount}`)
                        )
                    ))
                )
            );
        };
        const Button = ({ children, onClick, disabled, variant='gold', full, className='', icon: Icon, loading }) => {
            const base = "relative font-bold py-3.5 px-6 rounded-xl transition-all flex items-center justify-center gap-2 btn-press disabled:opacity-50 disabled:grayscale select-none disabled:pointer-events-none overflow-hidden";
            const styles = {
                gold: 'bg-gradient-to-b from-[#FFD700] to-[#B8860B] text-black shadow-[0_4px_15px_rgba(255,215,0,0.3)] border border-[#FFD700] btn-shimmer', // ÿ™ŸÖ ÿßŸÑÿ™ŸÅÿπŸäŸÑ ŸáŸÜÿß
                green: 'bg-gradient-to-b from-emerald-500 to-emerald-700 text-white border border-emerald-500 shadow-[0_4px_15px_rgba(16,185,129,0.3)]',
                red: 'bg-gradient-to-b from-red-500 to-red-700 text-white border border-red-500 shadow-[0_4px_15px_rgba(239,68,68,0.3)]',
                dark: 'bg-dark-800 text-gold-500 border border-gold-500/30 hover:bg-dark-700'
            };
            const clickHandler = (e) => {
                if(!disabled && !loading) {
                    AudioSys.click();
                    hapticFeedback('soft');
                    onClick && onClick(e);
                }
            }
            return React.createElement('button', { type: "button", onClick: clickHandler, disabled: disabled || loading, className: `${base} ${styles[variant]} ${full?'w-full':''} ${className}` }, 
                loading ? React.createElement('div', { className: "loader" }) : React.createElement(React.Fragment, null, Icon && React.createElement(Icon, { size: 20 }), children)
            );
        };

        const Input = (props) => React.createElement('div', { className: "relative group w-full" },
            props.icon && React.createElement(props.icon, { size: 18, className: "absolute top-1/2 -translate-y-1/2 right-4 text-gray-500 group-focus-within:text-gold-500 transition-colors" }),
            React.createElement('input', { ...props, className: `w-full bg-dark-900 border border-white/10 p-4 ${props.icon?'pr-12':''} rounded-xl text-white outline-none focus:border-gold-500 focus:shadow-[0_0_10px_rgba(255,215,0,0.2)] transition-all placeholder:text-gray-600 shadow-inner ${props.className}`, onFocus: () => AudioSys.init() })
        );

        const OddsBadge = ({ value, label }) => {
             return React.createElement('div', { className: "absolute top-2 left-2 z-20 flex items-center gap-1.5 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-gold-500/30 shadow-lg" },
                React.createElement(Target, { size: 12, className: "text-gold-500" }),
                React.createElement('div', { className: "flex flex-col leading-none" },
                    React.createElement('span', { className: "text-[8px] text-gray-400 font-bold uppercase" }, label || "ODD"),
                    React.createElement('span', { className: "text-[10px] font-mono font-bold text-white" }, value)
                )
             );
        };

        const StatusModal = ({ title, msg, type='success', onClose }) => {
            useEffect(() => { type==='success'?AudioSys.success():AudioSys.error(); }, []);
            return React.createElement('div', { className: "fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6 animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 border border-gold-500/30 w-full max-w-sm rounded-2xl p-6 relative animate-pop text-center" },
                    React.createElement('div', { className: "w-20 h-20 mx-auto mb-4 rounded-full bg-green-500/20 flex items-center justify-center" },
                        React.createElement(CheckCircle, { size: 40, className: "text-green-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, title),
                    React.createElement('p', { className: "text-gray-400 mb-6 text-sm" }, msg),
                    React.createElement(Button, { full: true, onClick: onClose }, "OK")
                )
            );
        };

        // --- ÿ™ÿπÿØŸäŸÑ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÑÿ™ŸÉŸàŸÜ ÿπÿßŸÑŸÖŸäÿ© Ÿàÿ∫Ÿäÿ± ŸÖÿ≤ÿπÿ¨ÿ© ---
        const GameResultModal = ({ win, amount, onClose, t }) => {
            useEffect(() => {
                if(win) { AudioSys.win(); hapticFeedback('success'); }
                else { hapticFeedback('soft'); }
                const timer = setTimeout(onClose, 3500); // ÿ≤ÿØŸÜÿß ÿßŸÑŸàŸÇÿ™ ŸÇŸÑŸäŸÑÿßŸã ŸÑŸÑÿßÿ≥ÿ™ŸÖÿ™ÿßÿπ ÿ®ÿßŸÑÿßÿ≠ÿ™ŸÅÿßŸÑ
                return () => clearTimeout(timer);
            }, [win, onClose]);

            return React.createElement('div', { className: "fixed inset-0 z-[70] flex items-center justify-center animate-fade-in px-6" },
                React.createElement('div', { className: "absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity" }),
                
                // üëá ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸÉŸàŸÜŸÅŸäÿ™Ÿä ŸáŸÜÿß
                win && React.createElement(WinConfetti, { active: true }),

                React.createElement('div', { 
                    className: `relative z-10 w-full max-w-xs p-8 rounded-[2.5rem] border transition-all duration-500 bg-[#0a0a0a] shadow-2xl transform scale-100 ${win ? 'border-gold-500/40 shadow-[0_0_50px_rgba(234,179,8,0.2)]' : 'border-white/5'}`
                },
                    win && React.createElement('div', { className: "absolute -top-12 left-1/2 -translate-x-1/2 animate-bounce drop-shadow-[0_0_15px_rgba(255,215,0,0.8)]" }, 
                        React.createElement(Crown, { size: 50, className: "text-gold-500 fill-gold-500" })
                    ),
                    React.createElement('div', { className: "text-center space-y-2" },
                        React.createElement('h2', { className: `text-xs font-black uppercase tracking-[0.4em] ${win ? 'text-gold-400' : 'text-gray-600'}` }, win ? "BIG WIN" : "ROUND OVER"),
                        React.createElement('div', { className: "flex justify-center items-baseline gap-1" },
                            win && React.createElement('span', { className: "text-2xl text-gold-500 font-serif" }, "+"),
                            React.createElement('p', { className: `text-6xl font-mono font-black tracking-tighter ${win ? 'text-white text-glow' : 'text-gray-700'}` }, amount)
                        ),
                        win && React.createElement('p', { className: "text-[10px] text-gold-500/50 uppercase tracking-widest animate-pulse" }, "Balance Updated")
                    )
                )
            );
        };

        
            

        const convertToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        // --- APP ROOT ---
        export default function App() {
            const [splash, setSplash] = useState(true);
            const [user, setUser] = useState(null);
            const [view, setView] = useState('auth'); 
            const [lang, setLang] = useState('ar');
            const [notify, setNotify] = useState(null);
            const [menuOpen, setMenuOpen] = useState(false);
            const [settings, setSettings] = useState({});

            const t = (k) => TEXTS[lang][k] || k;
            
            useEffect(() => { 
                const initAudio = () => AudioSys.init();
                window.addEventListener('click', initAudio, { once: true });
                setTimeout(() => setSplash(false), 2500); 
                return () => window.removeEventListener('click', initAudio);
            }, []);
            
            // Ÿáÿ∞ÿß ÿßŸÑŸÉŸàÿØ Ÿäÿ±ÿ®ÿ∑ ÿπŸÇŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ ÿ®ÿπŸÇŸÑ ÿßŸÑŸÑÿßÿπÿ® ŸÅŸàÿ±ÿßŸã
            useEffect(() => { 
                if(db) onSnapshot(doc(db, "settings", "global"), (s) => {
                    if (s.exists()) {
                        const data = s.data();
                        setSettings(data);
                        
                        // üëá ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅŸàÿ±Ÿä ŸÑŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÅŸàÿ≤ (ÿ®ÿØŸàŸÜ ÿ±ŸäŸÅÿ±Ÿäÿ¥)
                        if (data.house_win_rate !== undefined) {
                            GLOBAL_HOUSE_EDGE = data.house_win_rate / 100;
                            // ŸäŸÖŸÉŸÜŸÉ ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ™ÿπŸÑŸäŸÇ ÿ£ÿØŸÜÿßŸá ŸÑŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ŸàÿµŸàŸÑ ÿßŸÑÿ£ŸÖÿ±
                            // console.log("System Difficulty Updated:", GLOBAL_HOUSE_EDGE);
                        }
                    }
                }); 
            }, []);

            useEffect(() => {
                const uid = localStorage.getItem('cd0777_uid');
                if (uid && db) {
                    if (uid === 'admin') { setUser({role: 'admin', username: 'Admin'}); return; }
                    const unsub = onSnapshot(doc(db, "users", uid), (s) => {
                        if (s.exists()) {
                            setUser({ id: s.id, ...s.data() });
                            if(s.data().status === 'banned') { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); }
                        } else { setUser(null); localStorage.removeItem('cd0777_uid'); setView('auth'); }
                    });
                    return () => unsub();
                }
            }, []);

            useEffect(() => { if (user && view === 'auth') setView(user.role === 'admin' ? 'admin' : 'home'); }, [user]);

            const showMsg = (msg, type='success') => { 
                setNotify({msg, type}); 
                if(type === 'success') AudioSys.coins();
                else hapticFeedback('error');
                setTimeout(()=>setNotify(null), 3000); 
            };
            const navTo = (v) => { setView(v); setMenuOpen(false); AudioSys.click(); };
            const logout = () => { localStorage.removeItem('cd0777_uid'); setUser(null); setView('auth'); };
            const isRTL = lang === 'ar';
            const ArrowIcon = isRTL ? ChevronRight : ChevronLeft;

            if (splash) return React.createElement(SplashScreen);
            if (!user && (view === 'auth' || view === 'forgot')) {
                if(view === 'auth') return React.createElement(AuthScreen, { setUser, setView, showMsg, t, lang, setLang });
                if(view === 'forgot') return React.createElement(ForgotPassScreen, { setView, showMsg, t, ArrowIcon });
            }
            if (user && user.status === 'pending') return React.createElement(PendingActivationScreen, { user, logout, t, isRTL, showMsg, settings });
            if (user?.role === 'admin' && view === 'admin') return React.createElement(AdminPanel, { user, logout, db, showMsg, t });

            const GameProps = { user, back: ()=>navTo('casino'), showMsg, ArrowIcon, t, isRTL, db, logGame };

            if (view === 'game-crash') return React.createElement(CrashGame, GameProps);
            if (view === 'game-slots') return React.createElement(SlotsGame, GameProps);
            if (view === 'game-keno') return React.createElement(KenoGame, GameProps);
            if (view === 'game-limbo') return React.createElement(LimboGame, GameProps);
            if (view === 'game-coinflip') return React.createElement(CoinFlipGame, GameProps);
            if (view === 'game-mines') return React.createElement(MinesGame, GameProps);
            if (view === 'game-plinko') return React.createElement(PlinkoGame, GameProps);
            if (view === 'game-dice') return React.createElement(DiceGame, GameProps);
            if (view === 'game-wheel') return React.createElement(WheelGame, GameProps);
            if (view === 'game-hilo') return React.createElement(HiLoGame, GameProps);
            // ...
if (view === 'terms') return React.createElement(InfoPage, { title: t('terms'), content: settings.terms || DEFAULT_TERMS, back: ()=>setView(user?'profile':'auth'), settings });
if (view === 'policy') return React.createElement(InfoPage, { title: t('policy'), content: settings.policy || DEFAULT_POLICY, back: ()=>setView(user?'profile':'auth'), settings });
// ...

            return React.createElement('div', { className: `h-screen flex flex-col bg-dark-950 text-white relative selection:bg-gold-500 selection:text-black`, dir: isRTL ? 'rtl' : 'ltr' },
            React.createElement('div', { className: "noise-overlay" }),
            React.createElement(CursorTrail), // üëà ÿ£ÿ∂ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ≥ÿ∑ÿ±
                notify && React.createElement('div', { className: `fixed top-12 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-xl shadow-2xl border flex items-center gap-3 animate-pop glass-panel w-max max-w-[90%] ${notify.type==='error'?'bg-red-950/90 border-red-500':'bg-green-950/90 border-green-500'}` }, 
                    notify.type==='success'?React.createElement(CheckCircle,{size:24, className:"text-green-400"}):React.createElement(XCircle,{size:24, className:"text-red-400"}), 
                    React.createElement('span', { className: "font-bold text-sm" }, notify.msg)
                ),
                React.createElement(LiveTicker, { t }),
                React.createElement(Header, { user, toggleMenu: ()=>setMenuOpen(true) }),
                menuOpen && React.createElement(Sidebar, { user, close: ()=>setMenuOpen(false), navTo, t, lang, setLang, settings, logout }),
                React.createElement(ChatWidget, { user, t, isRTL }),
                React.createElement('main', { className: "flex-1 overflow-y-auto p-5 pb-28 z-10 scrollbar-hide" },
                    view === 'home' && React.createElement(HomeScreen, { user, navTo, t }),
                    view === 'casino' && React.createElement(CasinoScreen, { navTo, t }),
                    view === 'tasks' && React.createElement(TasksScreen, { user, showMsg, t }),
                    view === 'profile' && React.createElement(WalletScreen, { user, showMsg, t, isRTL, navTo }),
                    view === 'deposit' && React.createElement(DepositScreen, { user, showMsg, t, settings, back: ()=>navTo('profile') }),
                    view === 'withdraw' && React.createElement(WithdrawScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'exchange' && React.createElement(ExchangeScreen, { user, showMsg, t, back: ()=>navTo('profile') }),
                    view === 'history' && React.createElement(HistoryScreen, { user, t, back: ()=>navTo('profile') }),
                    view === 'settings' && React.createElement(SettingsScreen, { user, showMsg, t, back: ()=>navTo('profile'), db }),
                    view === 'terms' && React.createElement(InfoPage, { title: t('terms'), content: settings.terms || DEFAULT_TERMS, back: ()=>navTo('profile'), settings }),
                    view === 'policy' && React.createElement(InfoPage, { title: t('policy'), content: settings.policy || DEFAULT_POLICY, back: ()=>navTo('profile'), settings })
                ),
                view !== 'settings' && React.createElement('nav', { className: "fixed bottom-4 left-4 right-4 h-16 glass-panel rounded-2xl z-40 flex justify-around items-center shadow-2xl border border-white/10 backdrop-blur-md" },
                    React.createElement(NavBtn, { icon: Home, label: t('home'), active: view==='home', onClick:()=>navTo('home') }),
                    React.createElement(NavBtn, { icon: Dices, label: t('casino'), active: view==='casino', onClick:()=>navTo('casino') }),
                    React.createElement(NavBtn, { icon: Trophy, label: t('tasks'), active: view==='tasks', onClick:()=>navTo('tasks') }),
                    React.createElement(NavBtn, { icon: Wallet, label: t('wallet'), active: view==='profile', onClick:()=>navTo('profile') })
                )
            );
        }

        // --- AUTH ---
        function AuthScreen({ setUser, setView, showMsg, t, lang, setLang }) {
            const [isReg, setIsReg] = useState(false); 
            const [f, setF] = useState({ u:'', p:'', n:'', ph:'', country: 'MA' });
            const [agreeTerms, setAgreeTerms] = useState(false);
            const [loading, setLoading] = useState(false);
            
            useEffect(() => {
                const c = COUNTRIES.find(c => c.code === f.country);
                if(c && isReg) setF(prev => ({ ...prev, ph: '' }));
            }, [f.country, isReg]);

            const submit = async () => {
                if(loading) return;
                AudioSys.click();
                if(!f.u || !f.p) return showMsg(t('inputs_err'), 'error');
                if(isReg && !agreeTerms) return showMsg(t('must_agree'), 'error');

                setLoading(true);
                await new Promise(r => setTimeout(r, 1000));

                if(f.u==='admin' && f.p==='admin123') { 
                    localStorage.setItem('cd0777_uid', 'admin'); setUser({role:'admin'}); setView('admin'); setLoading(false); return; 
                }
                
                try {
                    if(isReg) {
                        const q = query(collection(db, "users"), where("username", "==", f.u)); if(!(await getDocs(q)).empty) throw new Error('Username taken');
                        const sz = (await getDocs(collection(db, "users"))).size;
                        const selectedC = COUNTRIES.find(c => c.code === f.country) || COUNTRIES[0];
                        const fullPhone = selectedC.prefix + f.ph;
                        
                        const nu = { username: f.u, password: f.p, fullName: f.n, phone: fullPhone, country: f.country, memberId: `CD${1001+sz}`, role: 'user', status: 'pending', coins: 0, balance: 0, completedTasks: [] };
                        const ref = await addDoc(collection(db, "users"), nu); localStorage.setItem('cd0777_uid', ref.id); setUser({id:ref.id, ...nu});
                    } else {
                        const q = query(collection(db, "users"), where("username", "==", f.u), where("password", "==", f.p)); const s = await getDocs(q);
                        if(s.empty) throw new Error('Invalid credentials'); const d=s.docs[0]; localStorage.setItem('cd0777_uid', d.id); setUser({id:d.id, ...d.data()});
                    }
                } catch(e) { showMsg(e.message, 'error'); }
                setLoading(false);
            };

            const selectedCountry = COUNTRIES.find(c => c.code === f.country) || COUNTRIES[0];

            return React.createElement('div', { className: "min-h-screen flex items-center justify-center p-4 bg-[#020617] relative overflow-hidden", dir: lang==='ar'?'rtl':'ltr' },
                // ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©
                React.createElement('div', { className: "absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20" }),
                React.createElement('div', { className: "absolute top-0 left-0 w-full h-full bg-gradient-to-b from-gold-500/5 to-transparent pointer-events-none" }),
                React.createElement('div', { className: "absolute -top-24 -right-24 w-64 h-64 bg-gold-500/20 rounded-full blur-[100px] animate-pulse" }),
                React.createElement('div', { className: "absolute -bottom-24 -left-24 w-64 h-64 bg-blue-500/10 rounded-full blur-[100px]" }),

                // ÿ≤ÿ± ÿßŸÑŸÑÿ∫ÿ©
                React.createElement('button', { onClick: ()=>setLang(lang==='ar'?'en':'ar'), className: "absolute top-6 right-6 z-20 text-[10px] font-black bg-white/5 border border-white/10 px-4 py-2 rounded-full text-gold-500 hover:bg-white/10 transition-colors tracking-widest" }, lang==='ar'?'ENGLISH':'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©'),

                // ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                React.createElement('div', { className: "w-full max-w-md relative z-10" },
                    // ÿßŸÑÿ¥ÿπÿßÿ±
                    React.createElement('div', { className: "flex flex-col items-center mb-8" },
                        React.createElement('div', { className: "w-24 h-24 rounded-2xl bg-gradient-to-tr from-gold-400 to-gold-700 flex items-center justify-center text-5xl font-black text-black shadow-[0_0_40px_rgba(234,179,8,0.3)] border-4 border-gold-300 animate-float-up" }, "CD"),
                        React.createElement('h1', { className: "mt-4 text-2xl font-black text-white font-oswald tracking-[0.2em] uppercase" }, "ELITE CLUB"),
                        React.createElement('p', { className: "text-[10px] text-gold-500/80 font-bold tracking-widest" }, "MEMBERS ONLY AREA")
                    ),

                    // ÿßŸÑÿ≠ÿßŸàŸäÿ© ÿßŸÑÿ≤ÿ¨ÿßÿ¨Ÿäÿ©
                    React.createElement('div', { className: "bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-1 shadow-2xl overflow-hidden" },
                        
                        // ÿßŸÑÿ™ÿ®ÿØŸäŸÑ ÿ®ŸäŸÜ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ Ÿàÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® (Tabs)
                        React.createElement('div', { className: "grid grid-cols-2 gap-1 p-1 bg-black/40 rounded-2xl mb-6" },
                            React.createElement('button', { 
                                onClick: ()=>setIsReg(false), 
                                className: `py-3 rounded-xl text-xs font-bold transition-all duration-300 ${!isReg ? 'bg-gold-500 text-black shadow-lg' : 'text-gray-400 hover:text-white'}` 
                            }, t('login')),
                            React.createElement('button', { 
                                onClick: ()=>setIsReg(true), 
                                className: `py-3 rounded-xl text-xs font-bold transition-all duration-300 ${isReg ? 'bg-gold-500 text-black shadow-lg' : 'text-gray-400 hover:text-white'}` 
                            }, t('register'))
                        ),

                        // ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨
                        React.createElement('div', { className: "p-5 space-y-4" },
                            isReg && React.createElement(Input, { icon: User, placeholder: t('name'), value: f.n, onChange: e=>setF({...f,n:e.target.value}) }),
                            
                            // --- üî• ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸáÿßÿ™ŸÅ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© (Design Trick) üî• ---
                            isReg && React.createElement('div', { className: "relative w-full" },
                                React.createElement('div', { className: "flex items-center w-full bg-dark-900 border border-white/10 rounded-xl h-14 focus-within:border-gold-500 focus-within:shadow-[0_0_15px_rgba(234,179,8,0.2)] transition-all overflow-hidden" },
                                    
                                    // 1. ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£Ÿäÿ≥ÿ±: ÿßŸÑÿπŸÑŸÖ ŸàÿßŸÑŸÉŸàÿØ (ÿ´ÿßÿ®ÿ™ ÿ®ÿµÿ±ŸäÿßŸã)
                                    React.createElement('div', { className: "relative w-28 h-full border-r border-white/10 bg-white/5 hover:bg-white/10 transition-colors group/flag" },
                                        // ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖÿÆŸÅŸäÿ© (Ÿàÿ∏ŸäŸÅŸäÿ© ŸÅŸÇÿ∑)
                                        React.createElement('select', { 
                                            value: f.country, 
                                            onChange: e=>setF({...f, country: e.target.value}), 
                                            className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20" 
                                        },
                                            COUNTRIES.map(c => React.createElement('option', { key: c.code, value: c.code }, `${c.flag} ${c.name}`))
                                        ),
                                        // ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑŸÖÿ±ÿ¶Ÿä ÿßŸÑÿ¨ŸÖŸäŸÑ (ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ)
                                        React.createElement('div', { className: "absolute inset-0 flex items-center justify-center gap-2 pointer-events-none" },
                                            React.createElement('span', { className: "text-2xl drop-shadow-md" }, selectedCountry.flag),
                                            React.createElement('span', { className: "text-xs font-mono font-bold text-gray-300 pt-0.5 dir-ltr" }, selectedCountry.prefix),
                                            React.createElement(ChevronRight, { size: 10, className: "text-gray-500 rotate-90" }) 
                                        )
                                    ),

                                    // 2. ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£ŸäŸÖŸÜ: ÿ≠ŸÇŸÑ ÿßŸÑŸÉÿ™ÿßÿ®ÿ©
                                    React.createElement('input', { 
                                        className: "flex-1 bg-transparent h-full px-4 text-white placeholder:text-gray-600 font-mono text-sm outline-none tracking-wider", 
                                        placeholder: "612 345 678", 
                                        type: "tel",
                                        value: f.ph,
                                        onChange: e => setF({...f, ph: e.target.value}) 
                                    })
                                )
                            ),
                            // --- ÿßŸÜÿ™ŸáŸâ ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸáÿßÿ™ŸÅ ---

                            React.createElement(Input, { icon: User, placeholder: t('user'), value: f.u, onChange: e=>setF({...f,u:e.target.value}) }),
                            React.createElement(Input, { icon: Lock, type: "password", placeholder: t('pass'), value: f.p, onChange: e=>setF({...f,p:e.target.value}) }),
                            
                            // ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ
                            isReg && React.createElement('div', { className: "flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5" },
                                React.createElement('label', { className: "flex items-center cursor-pointer relative" },
                                     React.createElement('input', { type: "checkbox", checked: agreeTerms, onChange: e=>setAgreeTerms(e.target.checked), className: "peer sr-only" }),
                                     React.createElement('div', { className: "w-5 h-5 rounded border-2 border-gray-600 peer-checked:bg-gold-500 peer-checked:border-gold-500 transition-all flex items-center justify-center" },
                                         React.createElement(Check, { size: 12, className: "text-black opacity-0 peer-checked:opacity-100" })
                                     )
                                ),
                                React.createElement('div', { className: "text-[10px] text-gray-400" }, 
                                    t('agree_terms'),
                                    React.createElement('button', { onClick: (e) => { e.preventDefault(); e.stopPropagation(); setView('terms'); }, className: "text-gold-500 hover:underline font-bold ml-1 cursor-pointer relative z-10" }, t('terms_link'))
                                )
                            ),

                            // ÿ≤ÿ± ÿßŸÑÿ™ŸÜŸÅŸäÿ∞
                            React.createElement(Button, { full: true, onClick: submit, loading: loading, className: "py-4 text-sm tracking-widest shadow-[0_0_30px_rgba(234,179,8,0.2)]" }, 
                                isReg ? (loading ? "CREATING..." : "CREATE ACCOUNT") : (loading ? "ACCESSING..." : "SECURE LOGIN")
                            ),

                            !isReg && React.createElement('div', { className: "text-center pt-2" },
                                React.createElement('button', { onClick: ()=>setView('forgot'), className: "text-xs text-gray-500 hover:text-white transition-colors flex items-center justify-center gap-1 mx-auto" }, 
                                    React.createElement(LockKeyhole, { size: 12 }), "Forgot Credentials?"
                                )
                            )
                        )
                    ),
                    
                    // ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ
                    React.createElement('div', { className: "mt-8 text-center opacity-40" },
                        React.createElement('p', { className: "text-[9px] font-mono text-gray-500" }, "ENCRYPTED CONNECTION ‚Ä¢ 256-BIT SSL"),
                        React.createElement('p', { className: "text-[8px] text-gray-600 mt-1" }, "CD0777 SYSTEM v2.0")
                    )
                )
            );
        }

        function ForgotPassScreen({ setView, showMsg, t, ArrowIcon }) {
            const [id, setId] = useState(''); 
            const [email, setEmail] = useState('');
            const [sent, setSent] = useState(false);

            const req = async () => {
                if(!id || !email) return showMsg(t('inputs_err'), 'error');
                await new Promise(r => setTimeout(r, 1500));
                setSent(true);
            };

            if(sent) return React.createElement('div', { className: "h-full flex flex-col items-center justify-center p-6 bg-dark-950 animate-pop text-center" },
                React.createElement('div', { className: "w-20 h-20 rounded-full bg-gold-500/20 flex items-center justify-center mb-6 border border-gold-500/30" }, 
                    React.createElement(CheckCircle, { size: 40, className: "text-gold-500" })
                ),
                React.createElement('h2', { className: "text-3xl text-white font-bold mb-2 font-oswald" }, t('email_sent_title')),
                React.createElement('p', { className: "text-gray-400 mb-8" }, t('email_sent_desc')),
                React.createElement(Button, { onClick: ()=>setView('auth'), full:true }, "Back to Login")
            );

            return React.createElement('div', { className: "h-full flex flex-col items-center justify-center p-6 bg-dark-950" },
                React.createElement('button', { onClick: ()=>setView('auth'), className: "absolute top-6 left-6 text-white" }, React.createElement(ArrowIcon)),
                React.createElement('h2', { className: "text-2xl text-gold-500 font-bold mb-6 font-oswald uppercase" }, t('reset_req')),
                React.createElement('div', { className: "w-full max-w-sm space-y-4" },
                    React.createElement(Input, { placeholder: t('user_id_label'), value: id, onChange: e=>setId(e.target.value), icon: User }),
                    React.createElement(Input, { placeholder: t('email'), value: email, onChange: e=>setEmail(e.target.value), icon: Mail }),
                    React.createElement(Button, { full: true, onClick: req }, t('confirm'))
                )
            );
        }

        function SettingsScreen({ user, showMsg, t, back, db }) {
            const [edit, setEdit] = useState(false);
            const [form, setForm] = useState({ fullName: user.fullName, phone: user.phone, email: user.email || '' });

            const save = async () => {
                try {
                    await updateDoc(doc(db, "users", user.id), form);
                    showMsg(t('update_success'));
                    setEdit(false);
                } catch(e) { showMsg(t('error'), 'error'); }
            };

            return React.createElement('div', { className: "animate-pop h-full bg-dark-950 p-6" },
                React.createElement('div', { className: "flex items-center gap-4 mb-8" }, 
                     back && React.createElement('button', { onClick: back, className: "text-gold-500 p-2 bg-gold-500/10 rounded-xl hover:bg-gold-500/20 transition-colors" }, React.createElement(ChevronRight)),
                    React.createElement('h2', { className: "text-gold-500 font-bold text-3xl font-oswald" }, t('settings'))
                ),

                React.createElement('div', { className: "space-y-6" },
                    React.createElement('div', { className: "bg-gradient-to-br from-dark-900 to-black rounded-3xl p-6 border border-white/5 shadow-2xl relative overflow-hidden" },
                        React.createElement('div', { className: "absolute top-0 right-0 w-32 h-32 bg-gold-500/5 rounded-full blur-3xl pointer-events-none" }),
                        
                        React.createElement('div', { className: "flex justify-between items-center border-b border-white/10 pb-4 mb-4" },
                            React.createElement('h3', { className: "text-white font-bold text-lg flex items-center gap-2" }, 
                                React.createElement('div', { className: "p-2 bg-blue-500/10 rounded-lg" }, React.createElement(User, {size:20, className:"text-blue-500"})),
                                t('personal_info')
                            ),
                            React.createElement('button', { onClick: ()=>setEdit(!edit), className: "text-xs font-bold px-3 py-1 bg-gold-500/10 text-gold-500 rounded-lg hover:bg-gold-500/20 transition-colors" }, edit ? "Cancel" : "Edit")
                        ),
                        
                        edit ? React.createElement('div', { className: "space-y-4" },
                            React.createElement(Input, { placeholder: t('name'), value: form.fullName, onChange: e=>setForm({...form, fullName:e.target.value}) }),
                            React.createElement(Input, { placeholder: t('phone'), value: form.phone, onChange: e=>setForm({...form, phone:e.target.value}) }),
                            React.createElement(Input, { placeholder: t('email'), value: form.email, onChange: e=>setForm({...form, email:e.target.value}) }),
                            React.createElement(Button, { onClick: save, full: true }, "Save Changes")
                        ) : React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6" },
                            React.createElement('div', { className: "space-y-1" }, React.createElement('p', {className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider"}, t('name')), React.createElement('p', {className:"text-white font-medium"}, user.fullName)),
                            React.createElement('div', { className: "space-y-1" }, React.createElement('p', {className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider"}, t('user')), React.createElement('p', {className:"text-white font-medium"}, user.username)),
                            React.createElement('div', { className: "space-y-1" }, React.createElement('p', {className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider"}, t('phone')), React.createElement('p', {className:"text-gold-500 font-mono"}, user.phone)),
                            React.createElement('div', { className: "space-y-1" }, React.createElement('p', {className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider"}, "ID"), React.createElement('p', {className:"text-white font-mono bg-white/5 px-2 py-1 rounded w-max"}, user.memberId))
                        )
                    ),

                    React.createElement('div', { className: "bg-dark-900 rounded-3xl p-6 border border-white/5 shadow-xl" },
                        React.createElement('h3', { className: "text-white font-bold text-lg border-b border-white/10 pb-4 mb-4 flex items-center gap-2" }, 
                            React.createElement('div', { className: "p-2 bg-red-500/10 rounded-lg" }, React.createElement(Lock, {size:20, className:"text-red-500"})),
                            "Security"
                        ),
                        React.createElement('div', { className: "space-y-4" },
                            React.createElement(Input, { placeholder: t('old_pass'), type:"password" }),
                            React.createElement(Input, { placeholder: t('new_pass'), type:"password" }),
                            React.createElement(Button, { full:true, onClick:()=>showMsg(t('success')) }, "Update Password")
                        )
                    )
                )
            );
        }

        // --- GAMES (TIER 1 UPGRADED) ---

        function CrashGame({ user, back, showMsg, ArrowIcon, t, isRTL, db, logGame }) {
            const [gameState, setGameState] = useState('BETTING');
            const [countdown, setCountdown] = useState(5);
            const [multiplier, setMultiplier] = useState(1.00);
            const [betAmount, setBetAmount] = useState(100);
            const [activeBet, setActiveBet] = useState(null);
            const [resultModal, setResultModal] = useState(null);
            const reqRef = useRef(null);
            const crashPointRef = useRef(0);
            const startTimeRef = useRef(0);

            useEffect(() => {
                let timer;
                if (gameState === 'BETTING') {
                    setMultiplier(1.00); setResultModal(null);
                    if (countdown > 0) {
                        timer = setTimeout(() => { setCountdown(c => c - 1); AudioSys.click(); }, 1000);
                    } else startFlight();
                }
                return () => clearTimeout(timer);
            }, [gameState, countdown]);

            const startFlight = () => {
                AudioSys.playTone(300, 'sine', 0.5); 
                if (shouldHouseWin()) { crashPointRef.current = 1.00 + Math.random() * 0.4; } 
                else { const r = 0.96 / (Math.random() + 0.04); crashPointRef.current = Math.max(1.00, Math.floor(r * 100) / 100); }
                startTimeRef.current = Date.now();
                setGameState('FLYING');
                loop();
            };

            const loop = () => {
                const elapsed = (Date.now() - startTimeRef.current) / 1000;
                const nextMult = 1 + (elapsed * 0.2) + (elapsed * elapsed * 0.08); 
                if(nextMult % 0.5 < 0.1) AudioSys.playTone(200 + (nextMult * 50), 'sawtooth', 0.1, 0.05);
                if (nextMult >= crashPointRef.current) { crash(crashPointRef.current); } 
                else { setMultiplier(nextMult); reqRef.current = requestAnimationFrame(loop); }
            };

            const crash = (val) => {
                cancelAnimationFrame(reqRef.current);
                setMultiplier(val);
                setGameState('CRASHED');
                AudioSys.crash(); hapticFeedback('impact');
                if(activeBet) {
                    logGame(user.id, user.username, 'Crash', activeBet, 0, -activeBet);
                    setResultModal({ win: false, amount: 0 });
                    setActiveBet(null);
                }
                setTimeout(() => { setCountdown(5); setGameState('BETTING'); }, 3000);
            };

            const placeBet = async () => {
                if(Number(user.coins) < betAmount || betAmount <= 0) return showMsg("Invalid Amount", "error");
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-betAmount});
                setActiveBet(betAmount);
            };

            const cashout = async () => {
                if (!activeBet || gameState !== 'FLYING') return;
                const winAmt = Math.floor(activeBet * multiplier);
                const userRef = doc(db, "users", user.id);
                const userSnap = await getDoc(userRef);
                const currentCoins = Number(userSnap.data().coins || 0);
                await updateDoc(userRef, { coins: currentCoins + winAmt });
                logGame(user.id, user.username, 'Crash', activeBet, winAmt, winAmt - activeBet);
                setResultModal({ win: true, amount: winAmt });
                setActiveBet(null);
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up overflow-hidden`, dir:'ltr' },
                React.createElement('div', { className: "noise-overlay" }),
                
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium z-20", dir: isRTL?'rtl':'ltr' }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press hover:text-white transition-colors" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-black text-red-500 tracking-[0.3em] font-oswald italic text-xl drop-shadow-lg" }, "CRASH"), 
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                React.createElement('div', { className: "flex-1 relative flex flex-col items-center justify-center overflow-hidden" },
                    React.createElement('div', { className: "absolute inset-0 opacity-10", style: { backgroundImage: 'linear-gradient(#333 1px, transparent 1px), linear-gradient(90deg, #333 1px, transparent 1px)', backgroundSize: '40px 40px', transform: 'perspective(500px) rotateX(20deg)' } }),
                    
                    React.createElement(CrashGraph, { multiplier, gameState }),

                    React.createElement('div', { className: "relative z-10 flex flex-col items-center" },
                        gameState === 'FLYING' && React.createElement('div', { className: "mb-8 animate-rocket-fly filter drop-shadow-[0_0_20px_rgba(239,68,68,0.6)] transition-transform duration-75", style: { transform: `scale(${1 + multiplier/20}) rotate(-45deg)` } },
                             React.createElement(Rocket, { size: 120, className: "text-white fill-gray-200" }),
                             React.createElement('div', { className: "absolute top-full left-1/2 -translate-x-1/2 w-4 h-12 bg-orange-500 blur-md animate-pulse" })
                        ),
                        
                        gameState === 'CRASHED' && React.createElement('div', { className: "animate-pop flex flex-col items-center mb-8" },
                             React.createElement(Bomb, { size: 80, className: "text-red-500 mb-2 animate-bounce" }),
                             React.createElement('h2', { className: "text-4xl font-black text-red-500 uppercase font-oswald tracking-widest text-glow-red" }, t('crashed'))
                        ),

                        React.createElement('div', { className: `font-mono font-black text-8xl transition-all duration-75 ${gameState==='CRASHED'?'text-red-500 text-glow-red scale-110':'text-white drop-shadow-2xl'}` }, 
                            gameState === 'BETTING' ? 
                            React.createElement('div', { className: "flex flex-col items-center" },
                                React.createElement('span', { className: "text-lg text-gold-500 font-oswald tracking-widest mb-2" }, "NEXT ROUND"),
                                React.createElement('span', {}, `00:0${countdown}`)
                            ) : 
                            `${multiplier.toFixed(2)}x`
                        )
                    )
                ),

                React.createElement('div', { className: "p-4 glass-premium z-20 flex gap-4 pb-safe", dir: isRTL?'rtl':'ltr' }, 
                    React.createElement('div', { className: "relative w-1/3" }, 
                        React.createElement('input', { type: "number", value: betAmount, onChange: e=>setBetAmount(Math.abs(Number(e.target.value))), disabled: gameState!=='BETTING' || activeBet, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-4 text-lg outline-none focus:border-gold-500 transition-colors shadow-inner" }), 
                        React.createElement(DollarSign, { size: 16, className: "absolute top-1/2 -translate-y-1/2 left-4 text-gray-500" })
                    ),
                    
                    gameState === 'BETTING' ? 
                        (activeBet ? 
                            React.createElement(Button, { full: true, variant: 'dark', disabled: true, className: "opacity-50" }, t('bet_placed')) : 
                            React.createElement(Button, { full: true, onClick: placeBet, className: "shadow-[0_0_20px_rgba(255,215,0,0.4)]" }, t('play'))
                        ) : 
                        (gameState === 'FLYING' && activeBet ? 
                            React.createElement(Button, { full: true, variant: 'green', onClick: cashout, className: "animate-pulse shadow-[0_0_20px_rgba(34,197,94,0.4)]" }, 
                                React.createElement('div', { className: "flex flex-col items-center leading-none" },
                                    React.createElement('span', { className: "text-xs opacity-80" }, t('cashout')),
                                    React.createElement('span', { className: "text-xl font-black" }, `$${Math.floor(activeBet*multiplier)}`)
                                )
                            ) : 
                            React.createElement(Button, { full: true, disabled: true, variant: 'dark', className: "grayscale" }, gameState==='CRASHED' ? t('crashed') : t('waiting'))
                        )
                )
            );
        }

        function SlotsGame({ user, back, showMsg, ArrowIcon, t, db, logGame, isRTL }) {
            const [bet, setBet] = useState(100);
            const [reels, setReels] = useState(['7Ô∏è‚É£', 'üíé', 'üçí']);
            const [spinning, setSpinning] = useState([false, false, false]); 
            const [resultModal, setResultModal] = useState(null);
            
            const ITEMS = [ 
                { s: 'üçí', weight: 40, val: 2 }, 
                { s: 'üçã', weight: 30, val: 3 }, 
                { s: 'üçá', weight: 20, val: 5 }, 
                { s: 'üíé', weight: 8, val: 10 }, 
                { s: '7Ô∏è‚É£', weight: 2, val: 50 } 
            ];

            const getRandomSymbol = () => {
                let r = Math.random() * 100;
                for(let item of ITEMS) { if(r < item.weight) return item.s; r -= item.weight; }
                return 'üçí';
            };

            const spin = async () => {
                if(Number(user.coins) < bet || bet <= 0) return showMsg("Insufficient Coins", "error");
                if(spinning.some(s => s)) return;

                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setResultModal(null);
                setSpinning([true, true, true]);
                AudioSys.spin();

                let finalRes = [];
                if(shouldHouseWin()) {
                    const s1 = getRandomSymbol(); const s2 = getRandomSymbol();
                    finalRes = [s1, s2, (s1===s2 ? (s1==='üçí'?'üçã':'üçí') : getRandomSymbol())]; 
                } else {
                    const r = Math.random();
                    if(r > 0.8) { const s = getRandomSymbol(); finalRes = [s, s, s]; }
                    else if (r > 0.5) { const s = getRandomSymbol(); finalRes = [s, s, getRandomSymbol()]; }
                    else { finalRes = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()]; }
                }

                setTimeout(() => { setReels(prev => [finalRes[0], prev[1], prev[2]]); setSpinning([false, true, true]); AudioSys.click(); }, 1000);
                setTimeout(() => { setReels(prev => [finalRes[0], finalRes[1], prev[2]]); setSpinning([false, false, true]); AudioSys.click(); }, 1500);
                setTimeout(async () => {
                    setReels(finalRes); setSpinning([false, false, false]); AudioSys.click();
                    let win = 0;
                    if(finalRes[0] === finalRes[1] && finalRes[1] === finalRes[2]) {
                        const item = ITEMS.find(i => i.s === finalRes[0]); win = bet * item.val * 2;
                    } else if (finalRes[0] === finalRes[1] || finalRes[1] === finalRes[2]) {
                        win = Math.floor(bet * 1.5);
                    }
                    logGame(user.id, user.username, 'Slots', bet, win, win - bet);
                    if(win > 0) { await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win}); setResultModal({ win: true, amount: win }); } 
                    else { setResultModal({ win: false, amount: 0 }); }
                }, 2000);
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up`, dir: isRTL?'rtl':'ltr' },
                React.createElement('div', { className: "noise-overlay" }),
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-black text-purple-500 tracking-[0.3em] font-oswald italic text-xl drop-shadow-lg" }, "ROYAL SLOTS"), 
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] relative" },
                    React.createElement('div', { className: "relative bg-gradient-to-b from-purple-900 to-black p-6 rounded-[2rem] border-4 border-gold-500 shadow-[0_0_50px_rgba(168,85,247,0.4)] max-w-sm w-full" },
                        React.createElement('div', { className: "absolute -top-6 left-1/2 -translate-x-1/2 bg-gold-500 text-black font-black px-4 py-1 rounded-full text-xs tracking-widest shadow-lg border-2 border-white" }, "JACKPOT x500"),
                        React.createElement('div', { className: "flex gap-2 bg-black/80 p-4 rounded-2xl border-2 border-purple-500/30 shadow-inner overflow-hidden relative" },
                            resultModal?.win && React.createElement('div', { className: "absolute top-1/2 left-0 w-full h-1 bg-red-500 z-20 shadow-[0_0_10px_red] animate-pulse" }),
                            [0, 1, 2].map(i => React.createElement('div', { key: i, className: "flex-1 aspect-[0.7/1] bg-gradient-to-b from-white to-gray-200 rounded-xl flex items-center justify-center shadow-[inset_0_5px_10px_rgba(0,0,0,0.2)] relative overflow-hidden border-x border-gray-300" }, 
                                React.createElement('div', { className: "absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/30 pointer-events-none z-10" }),
                                React.createElement('div', { className: `text-5xl select-none transform transition-all duration-100 ${spinning[i] ? 'animate-spin-slow blur-sm scale-110 opacity-80' : 'animate-pop scale-100'}` }, spinning[i] ? '‚ùì' : reels[i])
                            ))
                        )
                    )
                ),
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" }, 
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: spinning.some(s=>s), className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-purple-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-purple-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: spin, disabled: spinning.some(s=>s), variant: 'gold', className: spinning.some(s=>s) ? "opacity-50" : "shadow-[0_0_20px_rgba(234,179,8,0.4)]" }, spinning.some(s=>s) ? t('rolling') : "SPIN!")
                )
            );
        }

        function KenoGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [selected, setSelected] = useState([]);
            const [drawn, setDrawn] = useState([]);
            const [bet, setBet] = useState(100);
            const [playing, setPlaying] = useState(false);
            const [resultModal, setResultModal] = useState(null);

            const toggle = (n) => {
                if(playing) return;
                AudioSys.click();
                if(selected.includes(n)) setSelected(selected.filter(i=>i!==n));
                else if(selected.length < 10) setSelected([...selected, n]);
            }

            const play = async () => {
                if(selected.length === 0) return showMsg("Pick at least 1 number", "error");
                if(Number(user.coins) < bet) return showMsg("Insufficient Coins", "error");
                
                setPlaying(true); setDrawn([]); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                // Logic
                const draws = [];
                while(draws.length < 10) {
                    const r = Math.ceil(Math.random() * 40);
                    if (shouldHouseWin() && selected.includes(r) && Math.random() > 0.3) continue; // House Edge
                    if(!draws.includes(r)) draws.push(r);
                }
                
                // Animation
                let i = 0;
                const int = setInterval(() => {
                    setDrawn(prev => [...prev, draws[i]]);
                    if (selected.includes(draws[i])) { AudioSys.success(); hapticFeedback('success'); }
                    else { AudioSys.click(); }
                    
                    i++;
                    if(i >= 10) {
                        clearInterval(int);
                        const matches = selected.filter(s => draws.includes(s)).length;
                        
                        // Payout Table
                        let mult = 0;
                        if(matches >= 1) mult = 0.5;
                        if(matches >= 3) mult = 2.5; 
                        if(matches >= 5) mult = 12;
                        if(matches >= 8) mult = 100;
                        
                        const win = Math.floor(bet * mult);
                        logGame(user.id, user.username, 'Keno', bet, win, win - bet);
                        
                        setTimeout(() => {
                            setPlaying(false);
                            if(win > 0) {
                                updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                                setResultModal({ win: true, amount: win });
                            } else {
                                setResultModal({ win: false, amount: 0 });
                            }
                        }, 500);
                    }
                }, 200); 
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-black text-emerald-500 tracking-[0.2em] font-oswald text-xl" }, "NEON KENO"), 
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // Grid
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-4 overflow-y-auto" },
                    React.createElement('div', { className: "grid grid-cols-5 gap-3 w-full max-w-sm mb-6" },
                        Array.from({length: 40}).map((_, i) => {
                            const n = i+1;
                            const isSel = selected.includes(n);
                            const isDrawn = drawn.includes(n);
                            const isHit = isSel && isDrawn;
                            
                            return React.createElement('button', { 
                                key: n, onClick: ()=>toggle(n), 
                                className: `
                                    h-12 rounded-xl font-black text-sm transition-all duration-300 relative overflow-hidden group
                                    ${isHit ? 'bg-emerald-500 text-black shadow-[0_0_15px_#10b981] scale-110 z-10 border-2 border-white' : 
                                      (isDrawn ? 'bg-red-500/20 text-red-500 border border-red-500/50' : 
                                      (isSel ? 'bg-white text-black shadow-lg scale-105' : 'bg-dark-800 text-gray-600 border border-white/5 hover:bg-dark-700'))}
                                ` 
                            }, 
                                React.createElement('span', { className: "relative z-10" }, n),
                                isSel && !isHit && React.createElement('div', { className: "absolute inset-0 bg-white opacity-20 animate-pulse" })
                            );
                        })
                    ),
                    
                    // Stats
                    React.createElement('div', { className: "flex justify-center gap-8 w-full max-w-sm" },
                        React.createElement('div', { className: "text-center" }, 
                            React.createElement('p', {className:"text-[10px] text-gray-500 font-bold"}, "PICKED"),
                            React.createElement('p', {className:"text-white font-bold"}, selected.length)
                        ),
                        React.createElement('div', { className: "text-center" }, 
                            React.createElement('p', {className:"text-[10px] text-gray-500 font-bold"}, "MATCHED"),
                            React.createElement('p', {className:"text-emerald-500 font-bold"}, selected.filter(s => drawn.includes(s)).length)
                        )
                    )
                ),

                // Controls
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" }, 
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: playing, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-emerald-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-emerald-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: play, disabled: playing, variant: 'gold', className: playing ? "opacity-50" : "shadow-[0_0_20px_rgba(16,185,129,0.4)]" }, 
                        playing ? t('rolling') : "BET"
                    )
                )
            );
        }

        function LimboGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
             const [target, setTarget] = useState(2.0);
            const [bet, setBet] = useState(100);
            const [result, setResult] = useState(null); 
            const [playing, setPlaying] = useState(false);
            const [resultModal, setResultModal] = useState(null);
            const [displayVal, setDisplayVal] = useState(1.00);
            
            const play = async () => {
                if(Number(user.coins) < bet) return showMsg("Insufficient Coins", "error");
                
                setPlaying(true); setResult(null); setResultModal(null); setDisplayVal(1.00);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.playTone(200, 'sine', 0.5);

                let finalVal;
                if (shouldHouseWin()) {
                    finalVal = 1.00 + (Math.random() * (target - 1.05)); 
                } else {
                    const winChance = 95 / target; 
                    const isWin = (Math.random() * 100) < winChance;
                    finalVal = isWin ? target + (Math.random() * (100 - target)) : 1.00 + (Math.random() * (target - 1.01));
                }
                finalVal = Math.max(1.01, finalVal);

                // Animation
                let current = 1.00;
                const duration = 1000; 
                const startTime = performance.now();

                const animate = (time) => {
                    const elapsed = time - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Exponential easing for excitement
                    current = 1.00 + (finalVal - 1.00) * (progress * progress); // Accelerate
                    setDisplayVal(current);

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        finish(finalVal);
                    }
                };
                requestAnimationFrame(animate);
            };

            const finish = (finalVal) => {
                const isWin = finalVal >= target;
                setResult({ val: finalVal.toFixed(2), win: isWin });
                setPlaying(false);
                
                if(isWin) {
                    const winAmt = Math.floor(bet * target);
                    logGame(user.id, user.username, 'Limbo', bet, winAmt, winAmt - bet);
                    updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt});
                    setResultModal({ win: true, amount: winAmt });
                } else {
                    AudioSys.crash(); hapticFeedback('error');
                    logGame(user.id, user.username, 'Limbo', bet, 0, -bet);
                    setResultModal({ win: false, amount: 0 });
                }
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-black text-orange-500 tracking-[0.2em] font-oswald text-xl" }, "LIMBO"), 
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // Main Display
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 space-y-12" },
                    // Result Number
                    React.createElement('div', { className: "relative text-center" },
                        React.createElement('div', { className: `text-8xl font-black font-mono tracking-tighter transition-colors duration-200 ${result ? (result.win ? 'text-green-500 drop-shadow-[0_0_30px_rgba(34,197,94,0.6)]' : 'text-red-500 drop-shadow-[0_0_30px_rgba(239,68,68,0.6)]') : 'text-white'}` }, 
                            displayVal.toFixed(2) + "x"
                        ),
                        React.createElement('p', { className: "text-xs font-bold text-gray-500 mt-2 uppercase tracking-[0.5em]" }, "MULTIPLIER")
                    ),

                    // Controls Box
                    React.createElement('div', { className: "w-full max-w-sm bg-dark-900 p-6 rounded-3xl border border-white/5 shadow-xl" },
                        React.createElement('div', { className: "flex justify-between items-end mb-4" },
                            React.createElement('span', { className: "text-xs font-bold text-gray-400" }, "TARGET MULTIPLIER"),
                            React.createElement('span', { className: "text-2xl font-black text-gold-500 font-mono" }, target.toFixed(2)+"x")
                        ),
                        React.createElement('input', { 
                            type: "range", min: "1.1", max: "100", step: "0.1", value: target, 
                            onChange: e=>setTarget(Number(e.target.value)), 
                            className: "w-full h-2 bg-dark-950 rounded-lg appearance-none cursor-pointer accent-gold-500" 
                        }),
                        React.createElement('div', { className: "flex justify-between mt-2 text-[10px] text-gray-600 font-bold" },
                            React.createElement('span', {}, "1.1x"),
                            React.createElement('span', {}, "100x")
                        )
                    )
                ),

                // Footer
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" }, 
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-orange-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-orange-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: play, disabled: playing, variant: 'gold', className: playing ? "opacity-50" : "shadow-[0_0_20px_rgba(249,115,22,0.4)]" }, 
                        playing ? "..." : "LAUNCH"
                    )
                )
            );
        }

        function CoinFlipGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [choice, setChoice] = useState('Heads'); 
            const [flipping, setFlipping] = useState(false);
            const [rotation, setRotation] = useState(0);
            const [resultModal, setResultModal] = useState(null);

            const flip = async () => {
                if(Number(user.coins) < bet) return showMsg("Insufficient Coins", "error");
                if(flipping) return;

                setFlipping(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.spin();

                // Logic
                let isHeads;
                if (shouldHouseWin()) {
                    isHeads = choice === 'Tails'; 
                } else {
                    isHeads = Math.random() > 0.5;
                }
                const result = isHeads ? 'Heads' : 'Tails';
                
                // 3D Rotation Calculation
                // 1800 deg = 5 full spins. Add 0 for heads (front), 180 for tails (back)
                const newRotation = rotation + 1800 + (isHeads ? 0 : 180); 
                setRotation(newRotation);

                setTimeout(async () => {
                    setFlipping(false);
                    const isWin = result === choice;
                    const win = isWin ? bet * 2 : 0;
                    
                    logGame(user.id, user.username, 'CoinFlip', bet, win, win-bet);

                    if(isWin) {
                        await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                        setResultModal({ win: true, amount: win });
                    } else {
                        setResultModal({ win: false, amount: 0 });
                    }
                }, 1000); // 1s matches CSS transition
            };

            return React.createElement('div', { className: `fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up` },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/10" }, 
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)), 
                    React.createElement('span', { className: "font-black text-yellow-500 tracking-[0.2em] font-oswald text-xl" }, "COIN FLIP"), 
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // 3D Coin Area
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center gap-12 perspective-1000 relative" },
                    // Coin Container
                    React.createElement('div', { className: "relative w-56 h-56 coin-container", style: { transform: `rotateY(${rotation}deg)` } },
                        // FRONT (Heads)
                        React.createElement('div', { className: "coin-face coin-front border-8 border-yellow-300 flex flex-col" }, 
                            React.createElement('div', {className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] opacity-20"}),
                            React.createElement(Crown, { size: 80, className: "text-yellow-900 mb-2 drop-shadow-md z-10" }), 
                            React.createElement('span', { className: "font-black text-yellow-900 text-2xl tracking-widest z-10" }, "HEADS")
                        ),
                        // BACK (Tails)
                        React.createElement('div', { className: "coin-face coin-back border-8 border-gray-400 flex flex-col" }, 
                            React.createElement('div', {className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] opacity-20"}),
                            React.createElement(Coins, { size: 80, className: "text-gray-800 mb-2 drop-shadow-md z-10" }), 
                            React.createElement('span', { className: "font-black text-gray-800 text-2xl tracking-widest z-10" }, "TAILS")
                        )
                    ),

                    // Selection Buttons
                    React.createElement('div', { className: "flex bg-dark-900 p-2 rounded-2xl border border-white/10 gap-2 shadow-lg" },
                        React.createElement('button', { onClick: ()=>setChoice('Heads'), className: `px-10 py-4 rounded-xl font-bold transition-all flex flex-col items-center gap-1 ${choice==='Heads'?'bg-gold-500 text-black shadow-[0_0_20px_#eab308] scale-105':'text-gray-500 hover:bg-white/5'}` }, 
                            React.createElement(Crown, {size:20}), "HEADS"
                        ),
                        React.createElement('button', { onClick: ()=>setChoice('Tails'), className: `px-10 py-4 rounded-xl font-bold transition-all flex flex-col items-center gap-1 ${choice==='Tails'?'bg-gray-300 text-black shadow-[0_0_20px_#d1d5db] scale-105':'text-gray-500 hover:bg-white/5'}` }, 
                            React.createElement(Coins, {size:20}), "TAILS"
                        )
                    )
                ),

                // Controls
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" }, 
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: flipping, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-yellow-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-yellow-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: flip, disabled: flipping, variant: 'gold' }, flipping ? "..." : "FLIP!")
                )
            );
        }

        function MinesGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [playing, setPlaying] = useState(false);
            const [grid, setGrid] = useState(Array(25).fill(null)); 
            const [revealed, setRevealed] = useState(Array(25).fill(false));
            const [bombsCount, setBombsCount] = useState(3);
            const [profit, setProfit] = useState(0);
            const [gameOver, setGameOver] = useState(false);
            const [resultModal, setResultModal] = useState(null);

            const startGame = async () => {
                if(Number(user.coins) < bet) return showMsg("Insufficient Coins", "error");
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                let newGrid = Array(25).fill('gem');
                let placed = 0;
                while(placed < bombsCount) {
                    let idx = Math.floor(Math.random() * 25);
                    if(newGrid[idx] === 'gem') { newGrid[idx] = 'bomb'; placed++; }
                }
                setGrid(newGrid); setRevealed(Array(25).fill(false)); setPlaying(true); setGameOver(false); setProfit(0); setResultModal(null);
                AudioSys.click();
            };

            const clickTile = async (i) => {
                if(!playing || revealed[i] || gameOver) return;
                
                // ŸÖŸÜÿ∑ŸÇ "ÿ™ÿØÿÆŸÑ ÿßŸÑŸÖŸÜÿ≤ŸÑ" (ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ±ÿ®ÿ≠ ÿπÿßŸÑŸäÿßŸã ÿ¨ÿØÿßŸãÿå ÿ≠ŸàŸÑ ÿßŸÑÿ¨ŸàŸáÿ±ÿ© ŸÑŸÇŸÜÿ®ŸÑÿ©)
                let currentVal = grid[i];
                if (currentVal === 'gem' && profit > bet * 2 && shouldHouseWin()) {
                    currentVal = 'bomb';
                    const newGrid = [...grid]; newGrid[i] = 'bomb'; setGrid(newGrid);
                }

                const newRevealed = [...revealed]; newRevealed[i] = true; setRevealed(newRevealed);
                
                if(currentVal === 'bomb') {
                    setGameOver(true); setPlaying(false);
                    AudioSys.crash(); hapticFeedback('impact');
                    setRevealed(grid.map(() => true)); // ŸÉÿ¥ŸÅ ÿßŸÑŸÉŸÑ
                    logGame(user.id, user.username, 'Mines', bet, 0, -bet);
                    setResultModal({ win: false, amount: 0 });
                } else {
                    AudioSys.success();
                    const gemsFound = newRevealed.filter((r, idx) => r && grid[idx] === 'gem').length;
                    // ŸÖÿπÿßÿØŸÑÿ© ŸÖÿ∂ÿßÿπŸÅ ŸàÿßŸÇÿπŸäÿ©
                    const nextMult = 1 + (gemsFound * (bombsCount / (25 - bombsCount))) * 0.8; 
                    setProfit(Math.floor(bet * nextMult) - bet);
                }
            };

            const cashout = async () => {
                if(!playing || gameOver) return;
                const win = bet + profit;
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                logGame(user.id, user.username, 'Mines', bet, win, profit);
                setPlaying(false); setGameOver(true); 
                setResultModal({ win: true, amount: win });
                AudioSys.win();
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" },
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-black text-emerald-500 tracking-[0.2em] font-oswald text-xl" }, "MINES"),
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // Grid Area
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6" },
                    React.createElement('div', { className: "grid grid-cols-5 gap-3 w-full max-w-sm mb-6" },
                        grid.map((val, i) => React.createElement('button', {
                            key: i, 
                            onClick: ()=>clickTile(i),
                            disabled: !playing && !gameOver,
                            className: `
                                aspect-square rounded-xl flex items-center justify-center text-2xl transition-all duration-300 shadow-lg relative overflow-hidden group
                                ${revealed[i] 
                                    ? (val==='bomb' ? 'bg-red-500/20 border-2 border-red-500' : 'bg-emerald-500/20 border-2 border-emerald-500') 
                                    : 'bg-dark-800 border border-white/10 hover:bg-dark-700 hover:scale-105 active:scale-95'
                                }
                            `
                        }, 
                            revealed[i] ? (val==='bomb' 
                                ? React.createElement(Bomb, { className: "text-red-500 animate-bounce" }) 
                                : React.createElement(Gem, { className: "text-emerald-400 animate-pop filter drop-shadow-[0_0_10px_#34d399]" })
                            ) : ''
                        ))
                    ),
                    
                    // Bomb Selector
                    !playing && !gameOver && React.createElement('div', {className:"bg-dark-900 p-4 rounded-2xl border border-white/5 w-full max-w-sm"}, 
                        React.createElement('div', {className:"flex justify-between items-center mb-2"},
                            React.createElement('span', {className:"text-gray-400 text-xs font-bold"}, "NUMBER OF MINES"),
                            React.createElement('span', {className:"text-red-500 font-bold"}, bombsCount)
                        ),
                        React.createElement('div', { className: "flex justify-between gap-2" },
                            [1,3,5,10].map(b => React.createElement('button', {
                                key:b, onClick:()=>setBombsCount(b), 
                                className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-all ${bombsCount===b?'bg-red-500 text-black border-red-500':'bg-black border-white/10 text-gray-400 hover:border-white/30'}`
                            }, b))
                        )
                    )
                ),

                // Controls
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" },
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: playing, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-emerald-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-emerald-500 text-xs font-bold" }, "BET")
                    ),
                    playing 
                    ? React.createElement(Button, { full: true, onClick: cashout, variant:'green', className: "shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse" }, `CASHOUT (+${profit})`) 
                    : React.createElement(Button, { full: true, onClick: startGame, variant:'gold' }, "START GAME")
                )
            );
        }

        function PlinkoGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [dropping, setDropping] = useState(false);
            const [ballPos, setBallPos] = useState(50); 
            const [resultModal, setResultModal] = useState(null);
            
            // ÿßŸÑŸÖÿ∂ÿßÿπŸÅÿßÿ™ (Multipliers)
            const BUCKETS = [5.6, 2.1, 1.1, 1, 0.5, 1, 1.1, 2.1, 5.6];

            const drop = async () => {
                if(Number(user.coins) < bet || bet <= 0) return showMsg("Insufficient Coins", "error");
                if(dropping) return;

                setDropping(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                
                // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©
                let bucketIdx;
                if (shouldHouseWin()) {
                    bucketIdx = 3 + Math.floor(Math.random() * 3); // ÿ™Ÿàÿ¨ŸäŸá ŸÑŸÑŸàÿ≥ÿ∑ (ÿÆÿ≥ÿßÿ±ÿ©)
                } else {
                    // ÿ™Ÿàÿ≤Ÿäÿπ ÿßÿ≠ÿ™ŸÖÿßŸÑÿßÿ™ (ÿßŸÑÿ£ÿ∑ÿ±ÿßŸÅ ÿ£ÿµÿπÿ®)
                    let r = 0; for(let i=0; i<3; i++) r += Math.random();
                    bucketIdx = Math.floor(r / 3 * BUCKETS.length);
                }
                bucketIdx = Math.max(0, Math.min(bucketIdx, BUCKETS.length - 1));
                const multiplier = BUCKETS[bucketIdx];

                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿßŸÑÿ≥ŸÇŸàÿ∑ (Animation Simulation)
                let step = 0;
                const totalSteps = 16; // ÿπÿØÿØ ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿ≠ÿ™Ÿâ ÿßŸÑÿ£ÿ≥ŸÅŸÑ
                
                const int = setInterval(() => {
                    step++;
                    // ÿ™ÿ≠ÿ±ŸäŸÉ ÿßŸÑŸÉÿ±ÿ© ŸäŸÖŸäŸÜÿßŸã ŸàŸäÿ≥ÿßÿ±ÿßŸã ÿ®ÿ¥ŸÉŸÑ ÿπÿ¥Ÿàÿßÿ¶Ÿä ŸÑÿ™ÿ®ÿØŸà ŸÉÿ£ŸÜŸáÿß ÿ™ÿ±ÿ™ÿ∑ŸÖ
                    const noise = (Math.random() - 0.5) * 10; 
                    setBallPos(prev => prev + noise);
                    
                    if(step % 2 === 0) AudioSys.click(); // ÿµŸàÿ™ ÿßŸÑÿßÿ±ÿ™ÿ∑ÿßŸÖ ÿ®ÿßŸÑÿ£Ÿàÿ™ÿßÿØ

                    if(step >= totalSteps) {
                        clearInterval(int);
                        // ÿ™ÿ´ÿ®Ÿäÿ™ ÿßŸÑŸÉÿ±ÿ© ŸÅŸàŸÇ ÿßŸÑÿÆÿßŸÜÿ© ÿßŸÑŸÅÿßÿ¶ÿ≤ÿ©
                        const finalPos = 10 + (bucketIdx * 10); 
                        setBallPos(finalPos); 

                        setTimeout(async () => {
                            const win = Math.floor(bet * multiplier);
                            logGame(user.id, user.username, 'Plinko', bet, win, win-bet);
                            
                            if(win > 0) {
                                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+win});
                                if(win > bet) { setResultModal({ win: true, amount: win }); AudioSys.win(); }
                                else { showMsg(`x${multiplier}`, 'success'); AudioSys.coins(); }
                            } else {
                                setResultModal({ win: false, amount: 0 });
                            }
                            setDropping(false);
                            setBallPos(50); // ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÉÿ±ÿ© ŸÑŸÑŸÖŸÜÿ™ÿµŸÅ
                        }, 500);
                    }
                }, 150);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" },
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-black text-pink-500 tracking-[0.2em] font-oswald text-xl" }, "PLINKO"),
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÑÿπÿ® (ÿßŸÑŸáÿ±ŸÖ)
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-4 overflow-hidden relative" },
                    // ÿÆŸÑŸÅŸäÿ© ÿ®ÿßŸáÿ™ÿ©
                    React.createElement('div', { className: "absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-pink-900/20 via-transparent to-transparent" }),
                    
                    // ÿßŸÑŸáÿ±ŸÖ
                    React.createElement('div', { className: "relative w-full max-w-sm aspect-[1/0.8] flex flex-col justify-between py-6" },
                        // ÿßŸÑÿ£Ÿàÿ™ÿßÿØ (Pegs)
                        Array.from({ length: 8 }).map((_, row) => 
                            React.createElement('div', { key: row, className: "flex justify-center gap-8" },
                                Array.from({ length: row + 3 }).map((_, col) => 
                                    React.createElement('div', { key: col, className: "w-2 h-2 rounded-full bg-white/30 shadow-[0_0_8px_rgba(255,255,255,0.3)]" })
                                )
                            )
                        ),

                        // ÿßŸÑŸÉÿ±ÿ© (ÿ™ÿ™ÿ≠ÿ±ŸÉ ŸÅŸÇÿ∑ ÿπŸÜÿØ ÿßŸÑŸÑÿπÿ®)
                        dropping && React.createElement('div', { 
                            className: "absolute w-4 h-4 bg-pink-500 rounded-full shadow-[0_0_20px_#ec4899] z-20 transition-all duration-150 ease-in-out",
                            style: { 
                                top: dropping ? '85%' : '0%', // ÿ™Ÿáÿ®ÿ∑ ŸÑŸÑÿ£ÿ≥ŸÅŸÑ
                                left: `${ballPos}%`, // ÿ™ÿ™ÿ≠ÿ±ŸÉ ÿ£ŸÅŸÇŸäÿßŸã
                                transition: 'top 2.5s ease-in, left 0.15s linear' // ŸÅŸäÿ≤Ÿäÿßÿ° ÿßŸÑÿ≥ŸÇŸàÿ∑
                            }
                        }),

                        // ÿßŸÑÿÆÿßŸÜÿßÿ™ (Buckets)
                        React.createElement('div', { className: "flex justify-center gap-1 mt-6 px-1" },
                            BUCKETS.map((m, i) => 
                                React.createElement('div', { 
                                    key: i, 
                                    className: `flex-1 h-10 rounded-md flex items-center justify-center text-[10px] font-black text-black shadow-lg transform transition-transform hover:scale-110
                                    ${m >= 2 ? 'bg-gradient-to-b from-red-500 to-red-700 shadow-red-500/30' : (m < 1 ? 'bg-gradient-to-b from-blue-400 to-blue-600 shadow-blue-500/30' : 'bg-gradient-to-b from-yellow-400 to-yellow-600 shadow-yellow-500/30')}` 
                                }, `${m}x`)
                            )
                        )
                    )
                ),

                // ÿßŸÑÿ™ÿ≠ŸÉŸÖ
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" },
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: dropping, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-pink-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-pink-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: drop, disabled: dropping, variant: 'gold', className: dropping ? "opacity-50" : "shadow-[0_0_20px_rgba(236,72,153,0.4)]" }, 
                        dropping ? t('rolling') : "DROP BALL"
                    )
                )
            );
        }

        function DiceGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [target, setTarget] = useState(50);
            const [rollUnder, setRollUnder] = useState(true);
            const [rolling, setRolling] = useState(false);
            const [lastRoll, setLastRoll] = useState(50);
            const [resultModal, setResultModal] = useState(null);

            const multiplier = (98 / (rollUnder ? target : (100-target))).toFixed(2);
            const winChance = (rollUnder ? target : (100-target)).toFixed(0);

            const roll = async () => {
                if(Number(user.coins) < bet) return showMsg("Insufficient Balance", "error");
                setRolling(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.spin();
                
                // Animation loop
                let i = 0;
                const anim = setInterval(() => {
                    setLastRoll(Math.floor(Math.random() * 100));
                    i++;
                    if(i>10) {
                        clearInterval(anim);
                        finishRoll();
                    }
                }, 50);
            };

            const finishRoll = async () => {
                let r;
                if (shouldHouseWin()) {
                    if (rollUnder) r = target + Math.floor(Math.random() * (100-target));
                    else r = Math.floor(Math.random() * target);
                } else {
                    r = Math.floor(Math.random() * 100);
                }
                
                setLastRoll(r);
                const win = (rollUnder ? r < target : r > target);
                const winAmt = win ? Math.floor(bet * multiplier) : 0;
                
                logGame(user.id, user.username, 'Dice', bet, winAmt, winAmt-bet);
                
                if(win) { 
                    await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt}); 
                    setResultModal({ win: true, amount: winAmt });
                } else {
                    setResultModal({ win: false, amount: 0 });
                }
                setRolling(false);
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" },
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-black text-blue-500 tracking-[0.2em] font-oswald text-xl" }, "NEON DICE"),
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // Main Game
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 space-y-8" },
                    
                    // Result Display
                    React.createElement('div', { className: "relative w-40 h-40 flex items-center justify-center" },
                        React.createElement('div', { className: "absolute inset-0 bg-blue-500/20 rounded-full blur-2xl animate-pulse" }),
                        React.createElement('div', { className: "relative z-10 text-7xl font-black font-mono text-white drop-shadow-[0_0_15px_rgba(59,130,246,0.8)]" }, lastRoll),
                        React.createElement('div', { className: "absolute -bottom-4 bg-dark-900 border border-blue-500/30 px-3 py-1 rounded-full text-xs text-blue-400 font-bold" }, "RESULT")
                    ),

                    // Slider Area
                    React.createElement('div', { className: "w-full bg-dark-900 p-6 rounded-3xl border border-white/5 shadow-xl" },
                        // Stats Row
                        React.createElement('div', { className: "flex justify-between mb-6 bg-black/40 p-3 rounded-xl" },
                            React.createElement('div', { className: "text-center" }, 
                                React.createElement('p', {className:"text-[10px] text-gray-500 font-bold"}, "MULTIPLIER"),
                                React.createElement('p', {className:"text-gold-500 font-bold font-mono"}, `${multiplier}x`)
                            ),
                            React.createElement('div', { className: "text-center" }, 
                                React.createElement('p', {className:"text-[10px] text-gray-500 font-bold"}, "WIN CHANCE"),
                                React.createElement('p', {className:"text-green-500 font-bold font-mono"}, `${winChance}%`)
                            ),
                        ),

                        // The Slider
                        React.createElement('div', { className: "relative h-12 bg-black/50 rounded-xl overflow-hidden border border-white/10 mb-4" },
                            // Green Zone (Win Area)
                            React.createElement('div', { 
                                className: `absolute top-0 h-full transition-all duration-300 ${rollUnder ? 'bg-green-500 left-0' : 'bg-green-500 right-0'} opacity-20` ,
                                style: { width: `${rollUnder ? target : (100-target)}%` }
                            }),
                            // Red Zone (Lose Area)
                            React.createElement('div', { 
                                className: `absolute top-0 h-full transition-all duration-300 ${rollUnder ? 'bg-red-500 right-0' : 'bg-red-500 left-0'} opacity-20` ,
                                style: { width: `${rollUnder ? (100-target) : target}%` }
                            }),
                            
                            // Input Range
                            React.createElement('input', { 
                                type: "range", min: "2", max: "98", value: target, 
                                onChange: e=>setTarget(Number(e.target.value)), 
                                className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20" 
                            }),
                            
                            // The Handle (Visual)
                            React.createElement('div', { 
                                className: "absolute top-0 bottom-0 w-1 bg-white shadow-[0_0_15px_white] z-10 pointer-events-none transition-all duration-75",
                                style: { left: `${target}%` }
                            },
                                React.createElement('div', { className: "absolute -top-6 -translate-x-1/2 text-xs font-bold text-white bg-dark-800 px-2 rounded border border-white/20" }, target)
                            )
                        ),

                        // Toggle Mode
                        React.createElement('button', { 
                            onClick: ()=>setRollUnder(!rollUnder), 
                            className: "w-full py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-sm font-bold flex items-center justify-center gap-2 transition-all"
                        },
                            React.createElement(ArrowLeftRight, { size: 16, className: "text-blue-500" }),
                            `Roll ${rollUnder ? "Under" : "Over"} ${target}`
                        )
                    )
                ),

                // Controls
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" },
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: rolling, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-blue-500 transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-blue-500 text-xs font-bold" }, "BET")
                    ),
                    React.createElement(Button, { full: true, onClick: roll, disabled: rolling, variant: 'gold', className: rolling ? "opacity-50" : "shadow-[0_0_20px_rgba(59,130,246,0.4)]" }, 
                        rolling ? t('rolling') : "ROLL DICE"
                    )
                )
            );
        }

        function WheelGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [spinning, setSpinning] = useState(false);
            const [rotation, setRotation] = useState(0);
            const [resultModal, setResultModal] = useState(null);

            const SEGMENTS = [
                { color: '#ef4444', mult: 0.0, label: '0x' }, { color: '#3b82f6', mult: 2.0, label: '2x' },
                { color: '#22c55e', mult: 1.5, label: '1.5x' }, { color: '#eab308', mult: 5.0, label: '5x' },
                { color: '#ef4444', mult: 0.0, label: '0x' }, { color: '#3b82f6', mult: 2.0, label: '2x' },
                { color: '#22c55e', mult: 1.5, label: '1.5x' }, { color: '#a855f7', mult: 3.0, label: '3x' }
            ];
            const segAngle = 360 / SEGMENTS.length;

            const spin = async () => {
                if(Number(user.coins) < bet || bet <= 0) return showMsg("Insufficient Balance", "error");
                if(spinning) return;

                setSpinning(true); setResultModal(null);
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                AudioSys.spin();

                let winIndex;
                if (shouldHouseWin()) {
                    const loseIndices = SEGMENTS.map((s, i) => s.mult <= 1.5 ? i : -1).filter(i => i !== -1);
                    winIndex = loseIndices[Math.floor(Math.random() * loseIndices.length)];
                } else { winIndex = Math.floor(Math.random() * SEGMENTS.length); }
                const result = SEGMENTS[winIndex];

                const spins = 5 + Math.floor(Math.random() * 5);
                const extraDegrees = 360 * spins;
                const targetRotation = extraDegrees + (360 - (winIndex * segAngle)); 
                const randomOffset = Math.floor(Math.random() * 20) - 10;
                const newRotation = rotation + targetRotation + randomOffset;
                setRotation(newRotation);

                setTimeout(async () => {
                    setSpinning(false);
                    const winAmt = Math.floor(bet * result.mult);
                    logGame(user.id, user.username, 'Wheel', bet, winAmt, winAmt - bet);
                    if(winAmt > 0) { await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+winAmt}); setResultModal({ win: true, amount: winAmt }); } 
                    else { setResultModal({ win: false, amount: 0 }); }
                }, 4000);
            };

            const conicGradient = `conic-gradient(${SEGMENTS.map((s, i) => `${s.color} ${i * (100/SEGMENTS.length)}% ${(i+1) * (100/SEGMENTS.length)}%`).join(', ')})`;

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" },
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-black text-yellow-500 tracking-[0.2em] font-oswald text-xl" }, "SPIN WHEEL"),
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 relative overflow-hidden" },
                    React.createElement('div', { className: "absolute top-[15%] z-20 filter drop-shadow-lg" }, React.createElement(ArrowUp, { size: 50, className: "text-white fill-white rotate-180 stroke-[3px] stroke-black" })),
                    React.createElement('div', { className: "relative w-[300px] h-[300px] sm:w-[350px] sm:h-[350px]" },
                        React.createElement('div', { className: "absolute inset-0 rounded-full border-[10px] border-dark-800 shadow-[0_0_50px_rgba(0,0,0,0.8)]" }),
                        React.createElement('div', { className: "w-full h-full rounded-full transition-transform cubic-bezier(0.2, 0.8, 0.2, 1)", style: { background: conicGradient, transform: `rotate(${rotation}deg)`, transitionDuration: '4000ms' } },
                            SEGMENTS.map((s, i) => {
                                const rot = (i * segAngle) + (segAngle / 2);
                                return React.createElement('div', { key: i, className: "absolute top-0 left-1/2 w-1 h-1/2 origin-bottom flex justify-center pt-4", style: { transform: `translateX(-50%) rotate(${rot}deg)` } }, React.createElement('span', { className: "text-white font-black text-lg drop-shadow-md transform -rotate-90" }, s.label));
                            })
                        ),
                        React.createElement('div', { className: "absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-dark-900 rounded-full border-4 border-gold-500 shadow-xl flex items-center justify-center" }, React.createElement('div', { className: "w-10 h-10 bg-gold-500 rounded-full animate-pulse" }))
                    )
                ),
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" },
                    React.createElement('div', { className: "relative w-28" }, React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Math.abs(Number(e.target.value))), disabled: spinning, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-yellow-500 transition-colors" }), React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-yellow-500 text-xs font-bold" }, "BET")),
                    React.createElement(Button, { full: true, onClick: spin, disabled: spinning, variant: 'gold', className: spinning ? "opacity-50" : "shadow-[0_0_20px_rgba(234,179,8,0.4)]" }, spinning ? t('rolling') : "SPIN!")
                )
            );
        }
        function HiLoGame({ user, back, showMsg, ArrowIcon, t, db, logGame }) {
            const [bet, setBet] = useState(100);
            const [currentCard, setCurrentCard] = useState(7); // Start with 7
            const [playing, setPlaying] = useState(false);
            const [roundWin, setRoundWin] = useState(0);
            const [resultModal, setResultModal] = useState(null);

            const CARDS = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
            const VALUES = [1,2,3,4,5,6,7,8,9,10,11,12,13]; // Values for comparison

            const startGame = async () => {
                if(Number(user.coins) < bet) return showMsg("Insufficient Coins", "error");
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)-bet});
                setPlaying(true); setRoundWin(bet); setResultModal(null);
                setCurrentCard(7); // Always reset to 7 or random
            };

            const guess = async (dir) => { 
                AudioSys.click();
                let nextVal = Math.floor(Math.random() * 13) + 1;
                
                if (shouldHouseWin()) {
                    // Force lose logic
                    if (dir === 'hi' && nextVal > currentCard) nextVal = Math.max(1, currentCard - 1);
                    if (dir === 'lo' && nextVal < currentCard) nextVal = Math.min(13, currentCard + 1);
                }

                let win = false;
                if(dir === 'hi' && nextVal > currentCard) win = true;
                else if(dir === 'lo' && nextVal < currentCard) win = true;
                else if(dir === 'same' && nextVal === currentCard) win = true; 

                setCurrentCard(nextVal);

                if(win) {
                    const mult = dir === 'same' ? 10 : 1.35; // Multiplier
                    const newWin = Math.floor(roundWin * mult);
                    setRoundWin(newWin);
                    AudioSys.playTone(600, 'sine', 0.1);
                } else {
                    logGame(user.id, user.username, 'HiLo', bet, 0, -bet);
                    setPlaying(false); setRoundWin(0); 
                    setResultModal({ win: false, amount: 0 });
                }
            };

            const cashout = async () => {
                await updateDoc(doc(db,"users",user.id),{coins:Number(user.coins)+roundWin});
                logGame(user.id, user.username, 'HiLo', bet, roundWin, roundWin-bet);
                setPlaying(false); 
                setResultModal({ win: true, amount: roundWin });
            };

            return React.createElement('div', { className: "fixed inset-0 bg-dark-950 z-50 flex flex-col h-full animate-slide-up" },
                resultModal && React.createElement(GameResultModal, { ...resultModal, onClose:()=>setResultModal(null), t }),
                
                // Header
                React.createElement('div', { className: "flex justify-between items-center p-4 glass-premium border-b border-white/5" },
                    React.createElement('button', { onClick: back, className: "text-slate-400 btn-press" }, React.createElement(ArrowIcon)),
                    React.createElement('span', { className: "font-black text-gray-200 tracking-[0.2em] font-oswald text-xl" }, "HI-LO PRO"),
                    React.createElement('div', { className: "bg-black/60 px-3 py-1 rounded-lg border border-gold-500/30 shadow-inner flex items-center gap-2" },
                        React.createElement(Gem, { size: 14, className: "text-gold-500" }),
                        React.createElement(AnimatedCounter, { value: user.coins })
                    )
                ),

                // Game Area
                React.createElement('div', { className: "flex-1 flex flex-col items-center justify-center p-6 space-y-8" },
                    // Card
                    React.createElement('div', { className: "relative w-48 h-72 bg-white rounded-3xl flex flex-col items-center justify-center shadow-[0_0_50px_rgba(255,255,255,0.1)] animate-pop border-8 border-gray-300" },
                        // Card Design
                        React.createElement('div', { className: "absolute top-4 left-4 text-3xl font-black text-black" }, CARDS[currentCard-1]),
                        React.createElement('div', { className: "absolute bottom-4 right-4 text-3xl font-black text-black rotate-180" }, CARDS[currentCard-1]),
                        React.createElement('div', { className: "text-8xl font-black text-black" }, 
                            ["‚ô•","‚ô¶"].includes(["‚ô•","‚ô¶","‚ô£","‚ô†"][Math.floor(Math.random()*4)]) ? "‚ô¶" : "‚ô†" // Random suit for visual
                        )
                    ),
                    
                    // Win Info
                    playing && React.createElement('div', {className:"text-center animate-fade-in"},
                        React.createElement('p', {className:"text-xs text-gray-500 font-bold"}, "CURRENT WIN"),
                        React.createElement('p', {className:"text-3xl font-black text-green-500"}, roundWin)
                    ),

                    // Controls
                    playing && React.createElement('div', {className:"flex gap-4 w-full max-w-sm"},
                        React.createElement('button', {onClick:()=>guess('lo'), className:"flex-1 p-4 bg-red-500/20 text-red-500 border border-red-500/50 rounded-2xl font-black text-xl hover:bg-red-500/40 transition-all active:scale-95"}, "LO"),
                        React.createElement('button', {onClick:()=>guess('hi'), className:"flex-1 p-4 bg-green-500/20 text-green-500 border border-green-500/50 rounded-2xl font-black text-xl hover:bg-green-500/40 transition-all active:scale-95"}, "HI")
                    )
                ),

                // Footer
                React.createElement('div', { className: "p-4 glass-premium border-t border-white/10 flex gap-4 pb-safe" },
                    React.createElement('div', { className: "relative w-28" }, 
                        React.createElement('input', { type: "number", value: bet, onChange: e=>setBet(Number(e.target.value)), disabled: playing, className: "w-full bg-dark-900 border border-white/20 rounded-xl text-center text-white font-bold p-3 outline-none focus:border-white transition-colors" }), 
                        React.createElement('span', { className: "absolute top-1/2 -translate-y-1/2 left-3 text-gray-500 text-xs font-bold" }, "BET")
                    ),
                    playing 
                    ? React.createElement(Button, { full: true, onClick: cashout, variant:'gold' }, "CASHOUT") 
                    : React.createElement(Button, { full: true, onClick: startGame, variant:'gold' }, "START")
                )
            );
        }

        // --- DASHBOARD AND WALLET ---
        function HomeScreen({ user, navTo, t }) {
            return React.createElement('div', { className: "space-y-6 animate-pop pb-10" },
                // 1. ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ∞Ÿáÿ®Ÿäÿ© ÿßŸÑŸÅÿßÿÆÿ±ÿ© (The Elite Card)
                React.createElement('div', { className: "relative w-full aspect-[1.58/1] rounded-2xl overflow-hidden shadow-2xl transition-transform transform hover:scale-[1.02] duration-500 perspective-1000 group" },
                    // ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ ŸàÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
                    React.createElement('div', { className: "absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-black" }),
                    React.createElement('div', { className: "absolute inset-0 opacity-30 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]" }),
                    // ŸÑŸÖÿπÿ© ŸÖÿ™ÿ≠ÿ±ŸÉÿ© ÿ™ŸÖÿ± ŸÅŸàŸÇ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
                    React.createElement('div', { className: "absolute -inset-full top-0 block h-full w-1/2 -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-10 group-hover:animate-shine" }),

                    // ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
                    React.createElement('div', { className: "relative h-full p-6 flex flex-col justify-between z-10" },
                        // ÿßŸÑÿµŸÅ ÿßŸÑÿπŸÑŸàŸä
                        React.createElement('div', { className: "flex justify-between items-start" },
                            React.createElement('div', { className: "flex items-center gap-2" },
                                React.createElement(ShieldCheck, { className: "text-gold-500 drop-shadow-md", size: 28 }),
                                React.createElement('h2', { className: "text-gold-100 font-oswald text-xl tracking-[0.15em] italic" }, "ELITE CLUB")
                            ),
                            React.createElement('div', { className: "bg-white/10 backdrop-blur-md px-3 py-1 rounded-md border border-white/10" },
                                React.createElement('span', { className: "text-[10px] font-bold text-gold-400 tracking-widest" }, "TIER 1 MEMBER")
                            )
                        ),

                        // ÿßŸÑÿµŸÅ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ (ÿßŸÑÿ¥ÿ±Ÿäÿ≠ÿ© ŸàÿßŸÑŸàÿßŸä ŸÅÿßŸä)
                        React.createElement('div', { className: "flex items-center gap-4 my-2 opacity-90" },
                            React.createElement('div', { className: "w-12 h-9 rounded-md bg-gradient-to-br from-yellow-200 to-yellow-600 border border-yellow-700 shadow-inner flex items-center justify-center overflow-hidden relative" },
                                React.createElement('div', { className: "absolute inset-0 border-[0.5px] border-black/20 rounded-md", style: {background: "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(0,0,0,0.1) 2px, rgba(0,0,0,0.1) 4px)"} })
                            ),
                            React.createElement(Wifi, { size: 24, className: "text-white/50 rotate-90" })
                        ),

                        // ÿßŸÑÿµŸÅ ÿßŸÑÿ≥ŸÅŸÑŸä (ÿßŸÑÿ±ÿµŸäÿØ ŸàÿßŸÑÿßÿ≥ŸÖ)
                        React.createElement('div', { className: "space-y-4" },
                            React.createElement('div', {},
                                React.createElement('p', { className: "text-[9px] text-gray-400 uppercase tracking-widest mb-1" }, "TOTAL BALANCE"),
                                React.createElement('div', { className: "flex items-baseline gap-1" },
                                    React.createElement('span', { className: "text-2xl text-gold-500 font-serif" }, "$"),
                                    React.createElement('span', { className: "text-4xl font-mono text-white font-medium tracking-tight drop-shadow-lg" },
                                        React.createElement(AnimatedCounter, { value: user.balance || 0 })
                                    )
                                )
                            ),
                            React.createElement('div', { className: "flex justify-between items-end" },
                                React.createElement('div', {},
                                    React.createElement('p', { className: "text-[8px] text-gray-500 uppercase tracking-widest mb-0.5" }, "CARD HOLDER"),
                                    React.createElement('p', { className: "font-mono text-sm text-gray-200 uppercase tracking-wide" }, user.fullName)
                                ),
                                React.createElement('div', { className: "text-right" },
                                    React.createElement('p', { className: "text-[8px] text-gray-500 uppercase tracking-widest mb-0.5" }, "ID NUMBER"),
                                    React.createElement('p', { className: "font-mono text-sm text-gold-500 tracking-wider" }, user.memberId)
                                )
                            )
                        )
                    )
                ),

                // 2. ÿ≤ÿ± ÿßŸÑŸÑÿπÿ® ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä (Play Now CTA)
                React.createElement('button', { onClick: ()=>navTo('casino'), className: "relative w-full group overflow-hidden rounded-2xl p-px" },
                    // ÿ≠ÿØŸàÿØ ŸÖÿ∂Ÿäÿ¶ÿ© Ÿàÿ™ÿØŸàÿ±
                    React.createElement('div', { className: "absolute inset-0 bg-gradient-to-r from-gold-500 via-red-500 to-gold-500 animate-spin-slow opacity-70 group-hover:opacity-100 transition-opacity" }),
                    // ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿØÿßÿÆŸÑŸä ŸÑŸÑÿ≤ÿ±
                    React.createElement('div', { className: "relative bg-dark-900 rounded-2xl p-6 h-full flex items-center justify-between overflow-hidden group-active:scale-[0.98] transition-transform" },
                        React.createElement('div', { className: "absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10" }),
                        React.createElement('div', { className: "relative z-10" },
                            React.createElement('h3', { className: "text-3xl font-black text-white italic mb-1" }, "PLAY NOW"),
                            React.createElement('p', { className: "text-xs text-gold-400 font-bold tracking-widest" }, "HIGH STAKES ‚Ä¢ HIGH REWARDS")
                        ),
                        React.createElement('div', { className: "relative z-10 w-14 h-14 rounded-full bg-gradient-to-tr from-gold-500 to-orange-500 flex items-center justify-center shadow-[0_0_20px_rgba(234,179,8,0.4)] group-hover:shadow-[0_0_40px_rgba(234,179,8,0.6)] transition-shadow" },
                            React.createElement(Rocket, { size: 28, className: "text-black fill-black -rotate-45 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform" })
                        )
                    )
                ),

                // 3. ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ© (Stats)
                React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                    React.createElement('div', { className: "bg-dark-900/50 border border-white/5 p-4 rounded-2xl flex flex-col items-center justify-center gap-2" },
                        React.createElement(Crown, { size: 24, className: "text-gold-500" }),
                        React.createElement('span', { className: "text-[10px] text-gray-400 uppercase tracking-widest" }, "CURRENT TIER"),
                        React.createElement('span', { className: "text-lg font-bold text-white" }, "Gold VIP")
                    ),
                    React.createElement('div', { className: "bg-dark-900/50 border border-white/5 p-4 rounded-2xl flex flex-col items-center justify-center gap-2" },
                        React.createElement(Trophy, { size: 24, className: "text-purple-500" }),
                        React.createElement('span', { className: "text-[10px] text-gray-400 uppercase tracking-widest" }, "TOTAL WINS"),
                        React.createElement('span', { className: "text-lg font-bold text-white" }, "124")
                    )
                )
            );
        }

        function CasinoScreen({ navTo, t }) {
            // ŸÖŸÉŸàŸÜ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿ∑Ÿàÿ±
            const GameCard = ({ title, sub, color, icon: Icon, onClick, badge, bgPattern }) => React.createElement('button', { 
                onClick, 
                className: `relative h-40 rounded-3xl overflow-hidden border border-white/5 bg-dark-900 transition-all duration-300 group w-full text-left hover:scale-[1.02] hover:shadow-[0_0_30px_rgba(0,0,0,0.5)] hover:border-${color}-500/50` 
            }, 
                // ÿßŸÑÿÆŸÑŸÅŸäÿ© ÿßŸÑŸÖÿ™ÿØÿ±ÿ¨ÿ©
                React.createElement('div', { className: `absolute inset-0 bg-gradient-to-br from-${color}-900/80 via-black/50 to-transparent z-0` }),
                // ŸÜŸÖÿ∑ ÿßŸÑÿÆŸÑŸÅŸäÿ© (Pattern)
                React.createElement('div', { className: `absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/${bgPattern || 'cubes'}.png')] z-0 group-hover:scale-110 transition-transform duration-700` }),
                
                // ÿßŸÑÿ¥ÿßÿ±ÿ© (Badge) ŸÖÿ´ŸÑ HOT ÿ£Ÿà NEW
                badge && React.createElement('div', { className: "absolute top-3 right-3 z-20" },
                    React.createElement('span', { className: `text-[9px] font-black px-2 py-1 rounded-md bg-${color}-500 text-black shadow-lg shadow-${color}-500/20` }, badge)
                ),

                // ÿßŸÑÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© ÿßŸÑÿ®ÿßŸáÿ™ÿ© ŸÅŸä ÿßŸÑÿÆŸÑŸÅŸäÿ©
                React.createElement('div', { className: `absolute -bottom-4 -right-4 text-${color}-500/10 z-0 transform rotate-12 group-hover:rotate-0 transition-transform duration-500` }, 
                    React.createElement(Icon, { size: 120 })
                ),

                // ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÜÿµŸä
                React.createElement('div', { className: "absolute bottom-4 left-4 z-20" }, 
                    React.createElement('div', { className: `p-2 rounded-xl bg-white/5 backdrop-blur-md border border-white/10 w-min mb-2 text-${color}-400 group-hover:text-white group-hover:bg-${color}-500 group-hover:border-${color}-400 transition-all` },
                        React.createElement(Icon, { size: 24 })
                    ),
                    React.createElement('h3', { className: "text-xl font-black text-white italic tracking-wide drop-shadow-md" }, title), 
                    React.createElement('p', { className: `text-[10px] text-gray-400 font-bold uppercase tracking-widest group-hover:text-${color}-300 transition-colors` }, sub)
                )
            );

            return React.createElement('div', { className: "space-y-6 animate-slide-up pb-24" },
                // ÿßŸÑÿπŸÜŸàÿßŸÜ
                React.createElement('div', { className: "flex items-center justify-between" },
                    React.createElement('h2', { className: "text-white font-black text-2xl flex gap-2 items-center font-oswald" }, 
                        React.createElement(Dices, { className: "text-gold-500" }), 
                        "GAME LOBBY"
                    ),
                    React.createElement('span', { className: "text-[10px] bg-white/5 px-2 py-1 rounded text-gray-400" }, "12 GAMES AVAILABLE")
                ),

                // ÿ¥ÿ®ŸÉÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ®
                React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                    // 1. Crash (ŸÖŸÖŸäÿ≤ÿ© ÿ¨ÿØÿßŸã)
                    React.createElement('div', { className: "col-span-2" },
                        React.createElement(GameCard, { title: t('crash'), sub: "Most Popular ‚Ä¢ Multiplier", color: "red", icon: Rocket, onClick: ()=>navTo('game-crash'), badge: "üî• HOT", bgPattern: "carbon-fibre" })
                    ),
                    
                    // ÿ®ÿßŸÇŸä ÿßŸÑÿ£ŸÑÿπÿßÿ®
                    React.createElement(GameCard, { title: t('slots'), sub: "Jackpot Chance", color: "purple", icon: Gem, onClick: ()=>navTo('game-slots'), badge: "NEW" }),
                    React.createElement(GameCard, { title: t('plinko'), sub: "Ball Physics", color: "pink", icon: CircleDot, onClick: ()=>navTo('game-plinko') }),
                    
                    React.createElement(GameCard, { title: t('mines'), sub: "Find Gems", color: "emerald", icon: Bomb, onClick: ()=>navTo('game-mines') }),
                    React.createElement(GameCard, { title: t('wheel'), sub: "Spin & Win", color: "yellow", icon: Disc, onClick: ()=>navTo('game-wheel') }),
                    
                    React.createElement(GameCard, { title: t('limbo'), sub: "Target Multiplier", color: "orange", icon: Target, onClick: ()=>navTo('game-limbo') }),
                    React.createElement(GameCard, { title: t('dice'), sub: "Over / Under", color: "blue", icon: Dices, onClick: ()=>navTo('game-dice') }),
                    
                    React.createElement(GameCard, { title: t('keno'), sub: "Lottery Style", color: "teal", icon: Grid3X3, onClick: ()=>navTo('game-keno') }),
                    React.createElement(GameCard, { title: t('coinflip'), sub: "50/50 Chance", color: "gray", icon: Coins, onClick: ()=>navTo('game-coinflip') }),
                    
                    React.createElement('div', { className: "col-span-2" },
                        React.createElement(GameCard, { title: t('hilo'), sub: "Card Prediction", color: "indigo", icon: ArrowUp, onClick: ()=>navTo('game-hilo'), bgPattern: "diagmonds-light" })
                    )
                )
            );
        }

        function TasksScreen({ user, showMsg, t }) { return React.createElement('div', { className: "animate-pop" }, React.createElement('h2', { className: "text-gold-500 font-bold text-lg mb-4" }, t('tasks')), React.createElement('div', { className: "text-center py-10 bg-dark-900 rounded-2xl border border-white/5" }, React.createElement(Trophy, { size: 40, className: "mx-auto text-gray-600 mb-4" }), React.createElement('p', { className: "text-gray-400" }, t('no_tasks')))); }

        function WalletScreen({ user, t, isRTL, navTo }) {
            return React.createElement('div', { className: "space-y-6 animate-slide-up pb-24" },
                // 1. ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿ®ŸÜŸÉŸäÿ© (Main Balance Card)
                React.createElement('div', { className: "relative w-full rounded-3xl overflow-hidden shadow-2xl bg-gradient-to-br from-dark-900 via-black to-dark-900 border border-gold-500/20 group" },
                    // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿÆŸÑŸÅŸäÿ©
                    React.createElement('div', { className: "absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]" }),
                    React.createElement('div', { className: "absolute -right-10 -top-10 w-40 h-40 bg-gold-500/10 rounded-full blur-3xl pointer-events-none group-hover:bg-gold-500/20 transition-all duration-1000" }),
                    
                    React.createElement('div', { className: "relative p-6 z-10" },
                        // ÿßŸÑÿ±ÿµŸäÿØ
                        React.createElement('div', { className: "flex justify-between items-start mb-6" },
                            React.createElement('div', {},
                                React.createElement('p', { className: "text-gray-400 text-[10px] font-black uppercase tracking-[0.2em] mb-1" }, "AVAILABLE ASSETS"),
                                React.createElement('h1', { className: "text-4xl font-black text-white mt-1 flex items-baseline gap-1" }, 
                                    React.createElement('span', { className: "text-gold-500 text-2xl font-serif" }, "$"),
                                    React.createElement(AnimatedCounter, { value: user.balance || 0 })
                                )
                            ),
                            React.createElement('div', { className: "bg-white/5 p-3 rounded-2xl border border-white/10 backdrop-blur-md shadow-lg" },
                                React.createElement(Wallet, { className: "text-gold-500 drop-shadow-md", size: 28 })
                            )
                        ),
                        
                        // ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ≥ÿ±Ÿäÿπ (Exchange Widget)
                        React.createElement('button', { onClick: ()=>navTo('exchange'), className: "w-full bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl p-3 flex items-center justify-between group/btn transition-all active:scale-95" },
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement('div', { className: "bg-green-500/20 p-2 rounded-lg" }, React.createElement(RefreshCw, { size: 18, className: "text-green-500" })),
                                React.createElement('div', { className: "text-left rtl:text-right" },
                                    React.createElement('p', { className: "text-xs font-bold text-white group-hover/btn:text-gold-500 transition-colors" }, t('exchange')),
                                    React.createElement('p', { className: "text-[10px] text-gray-400" }, "USD ‚áÑ COINS")
                                )
                            ),
                            React.createElement(ChevronRight, { size: 16, className: "text-gray-500 group-hover/btn:text-white transition-colors" })
                        )
                    )
                ),

                // 2. ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© (Action Grid)
                React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                    // ÿ≤ÿ± ÿßŸÑÿ•ŸäÿØÿßÿπ
                    React.createElement('button', { onClick: ()=>navTo('deposit'), className: "relative overflow-hidden bg-green-600 hover:bg-green-500 text-white p-4 rounded-2xl shadow-lg shadow-green-900/20 flex flex-col items-center gap-2 transition-all active:scale-95 group" },
                        React.createElement('div', { className: "absolute inset-0 bg-gradient-to-t from-black/20 to-transparent" }),
                        React.createElement(ArrowUp, { size: 28, className: "bg-white/20 p-1.5 rounded-full box-content z-10 group-hover:-translate-y-1 transition-transform" }),
                        React.createElement('span', { className: "font-black text-sm tracking-wide z-10" }, t('deposit'))
                    ),
                    // ÿ≤ÿ± ÿßŸÑÿ≥ÿ≠ÿ®
                    React.createElement('button', { onClick: ()=>navTo('withdraw'), className: "relative overflow-hidden bg-dark-800 hover:bg-dark-700 text-white border border-white/10 p-4 rounded-2xl flex flex-col items-center gap-2 transition-all active:scale-95 group" },
                        React.createElement(ArrowUp, { size: 28, className: "bg-white/5 p-1.5 rounded-full box-content rotate-180 z-10 text-red-400 group-hover:translate-y-1 transition-transform" }),
                        React.createElement('span', { className: "font-bold text-sm tracking-wide z-10 text-gray-300 group-hover:text-white" }, t('withdraw'))
                    )
                ),

                // 3. ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≥ŸÅŸÑŸäÿ© (Settings & History)
                React.createElement('div', { className: "space-y-3" },
                    React.createElement('h3', { className: "text-gray-500 text-[10px] font-black uppercase tracking-[0.2em] px-2 opacity-70" }, "ACCOUNT MENU"),
                    
                    React.createElement('div', { className: "bg-dark-900 rounded-3xl border border-white/5 overflow-hidden shadow-lg" },
                        // History Item
                        React.createElement('button', { onClick: ()=>navTo('history'), className: "w-full p-4 flex items-center justify-between hover:bg-white/5 border-b border-white/5 transition-colors group" },
                            React.createElement('div', { className: "flex items-center gap-4" },
                                React.createElement('div', { className: "p-2.5 bg-blue-500/10 rounded-xl text-blue-500" }, React.createElement(History, { size: 20 })),
                                React.createElement('span', { className: "font-bold text-sm text-gray-200 group-hover:text-white" }, t('history'))
                            ),
                            React.createElement(ChevronRight, { size: 18, className: "text-gray-600 group-hover:text-gold-500 transition-colors" })
                        ),
                        // Policy Item
                        React.createElement('button', { onClick: ()=>navTo('policy'), className: "w-full p-4 flex items-center justify-between hover:bg-white/5 border-b border-white/5 transition-colors group" },
                            React.createElement('div', { className: "flex items-center gap-4" },
                                React.createElement('div', { className: "p-2.5 bg-purple-500/10 rounded-xl text-purple-500" }, React.createElement(ShieldCheck, { size: 20 })),
                                React.createElement('span', { className: "font-bold text-sm text-gray-200 group-hover:text-white" }, t('policy'))
                            ),
                            React.createElement(ChevronRight, { size: 18, className: "text-gray-600 group-hover:text-gold-500 transition-colors" })
                        ),
                        // Settings Item
                        React.createElement('button', { onClick: ()=>navTo('settings'), className: "w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors group" },
                            React.createElement('div', { className: "flex items-center gap-4" },
                                React.createElement('div', { className: "p-2.5 bg-gray-500/10 rounded-xl text-gray-400 group-hover:text-white transition-colors" }, React.createElement(Settings, { size: 20 })),
                                React.createElement('span', { className: "font-bold text-sm text-gray-200 group-hover:text-white" }, t('settings'))
                            ),
                            React.createElement(ChevronRight, { size: 18, className: "text-gray-600 group-hover:text-gold-500 transition-colors" })
                        )
                    )
                )
            );
        }

        function DepositScreen({ user, showMsg, t, settings, back }) {
            const [method, setMethod] = useState(null);
            const [amount, setAmount] = useState('');
            const [imgFile, setImgFile] = useState(null);
            const [loading, setLoading] = useState(false);
            const [showSuccess, setShowSuccess] = useState(false);

            const METHODS = [
                { id: 'attijari', name: t('method_bank'), color: 'text-orange-500', bg: 'from-orange-900/40 to-orange-900/10', icon: Landmark, desc: "Direct Bank Transfer" },
                { id: 'cashplus', name: t('method_cash'), color: 'text-yellow-500', bg: 'from-yellow-900/40 to-yellow-900/10', icon: Zap, desc: "Cash Plus / Wafacash" },
                { id: 'binance', name: t('method_crypto'), color: 'text-yellow-400', bg: 'from-yellow-700/40 to-yellow-900/10', icon: Disc, desc: "USDT (TRC20)" },
                { id: 'paypal', name: 'PayPal', color: 'text-blue-500', bg: 'from-blue-900/40 to-blue-900/10', icon: Wallet, desc: "International" }
            ];

            const submit = async () => {
                if(loading) return; 
                if(!method || !amount || !imgFile) return showMsg(t('inputs_err'), 'error');
                setLoading(true);
                try {
                    const base64Img = await convertToBase64(imgFile);
                    await addDoc(collection(db, "deposits"), { userId: user.id, username: user.username, amount: Number(amount), method: method.name, status: 'pending', image: base64Img, date: new Date().toISOString() });
                    setShowSuccess(true);
                } catch(e) { showMsg(t('error'), 'error'); }
                setLoading(false);
            };

            const convertToBase64 = (file) => new Promise((resolve, reject) => { const reader = new FileReader(); reader.readAsDataURL(file); reader.onload = () => resolve(reader.result); reader.onerror = error => reject(error); });

            if (showSuccess) return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-md animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 p-8 rounded-3xl border border-green-500/30 text-center max-w-sm w-full mx-6 relative overflow-hidden" },
                    React.createElement('div', { className: "absolute inset-0 bg-green-500/5" }),
                    React.createElement('div', { className: "w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_30px_rgba(34,197,94,0.3)]" },
                        React.createElement(CheckCircle, { size: 40, className: "text-green-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, t('req_sent')),
                    React.createElement('p', { className: "text-gray-400 text-sm mb-6" }, t('req_wait')),
                    React.createElement(Button, { onClick: () => { setShowSuccess(false); back(); }, full: true, variant: 'green' }, "Done")
                )
            );

            return React.createElement('div', { className: "h-full flex flex-col animate-slide-up pb-20" },
                // Header
                React.createElement('div', { className: "flex items-center gap-4 mb-6" },
                    React.createElement('button', { onClick: back, className: "p-2 rounded-xl bg-white/5 hover:bg-white/10 text-white transition-colors" }, React.createElement(ChevronLeft)),
                    React.createElement('h2', { className: "text-2xl font-black text-white font-oswald tracking-wide" }, t('deposit'))
                ),

                React.createElement('div', { className: "flex-1 overflow-y-auto space-y-6 pr-1" },
                    // 1. Payment Method Grid
                    React.createElement('div', { className: "space-y-3" },
                        React.createElement('p', { className: "text-xs font-bold text-gray-500 uppercase tracking-widest pl-1" }, "SELECT METHOD"),
                        React.createElement('div', { className: "grid grid-cols-1 gap-3" },
                            METHODS.map(m => React.createElement('button', { key: m.id, onClick: () => { setMethod(m); AudioSys.click(); }, className: `relative overflow-hidden p-4 rounded-2xl border transition-all duration-300 flex items-center gap-4 group ${method?.id === m.id ? 'border-gold-500 bg-gold-500/10 shadow-[0_0_20px_rgba(234,179,8,0.1)]' : 'border-white/5 bg-dark-900 hover:border-white/20'}` },
                                React.createElement('div', { className: `absolute inset-0 bg-gradient-to-r ${m.bg} opacity-0 group-hover:opacity-100 transition-opacity` }),
                                React.createElement('div', { className: `p-3 rounded-xl bg-black/40 ${m.color} border border-white/5 relative z-10` }, React.createElement(m.icon, { size: 24 })),
                                React.createElement('div', { className: "text-left relative z-10" },
                                    React.createElement('p', { className: "font-bold text-white text-sm" }, m.name),
                                    React.createElement('p', { className: "text-[10px] text-gray-400" }, m.desc)
                                ),
                                method?.id === m.id && React.createElement(CheckCircle, { className: "ml-auto text-gold-500 animate-pop", size: 20 })
                            ))
                        )
                    ),

                    // 2. Deposit Details (Conditional Render)
                    method && React.createElement('div', { className: "space-y-6 animate-slide-up" },
                        // Payment Info Box
                        React.createElement('div', { className: "bg-dark-800/50 p-5 rounded-2xl border border-white/5 relative overflow-hidden" },
                            React.createElement('div', { className: "absolute top-0 left-0 w-1 h-full bg-gold-500" }),
                            React.createElement('p', { className: "text-[10px] text-gray-400 mb-2 uppercase tracking-widest" }, "SEND PAYMENT TO"),
                            React.createElement('div', { className: "flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/10" },
                                React.createElement('p', { className: "font-mono text-sm text-gold-400 break-all select-all" }, settings[`${method.id}_info`] || "Contact Admin"),
                                React.createElement('button', { onClick:() => { navigator.clipboard.writeText(settings[`${method.id}_info`]); showMsg("Copied"); }, className: "text-gray-500 hover:text-white ml-2" }, React.createElement(Copy, { size: 16 }))
                            )
                        ),

                        // Amount Input
                        React.createElement('div', {},
                            React.createElement('p', { className: "text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 pl-1" }, "ENTER AMOUNT"),
                            React.createElement(Input, { placeholder: "0.00", type: "number", value: amount, onChange: e=>setAmount(e.target.value), icon: DollarSign, className: "text-2xl font-black font-mono tracking-tighter" })
                        ),

                        // Upload Proof
                        React.createElement('div', {},
                            React.createElement('p', { className: "text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 pl-1" }, "PAYMENT RECEIPT"),
                            React.createElement('div', { className: `border-2 border-dashed rounded-2xl p-8 text-center relative transition-all ${imgFile ? 'border-green-500 bg-green-500/5' : 'border-white/10 hover:border-gold-500/50 hover:bg-white/5'}` },
                                React.createElement('input', { type: "file", accept: "image/*", onChange: e=>setImgFile(e.target.files[0]), className: "absolute inset-0 opacity-0 z-10 w-full h-full cursor-pointer" }),
                                React.createElement('div', { className: "pointer-events-none" },
                                    imgFile 
                                    ? React.createElement('div', { className: "flex flex-col items-center text-green-500 gap-2" }, React.createElement(CheckCircle, { size: 32 }), React.createElement('span', { className: "text-xs font-bold" }, "File Selected"))
                                    : React.createElement('div', { className: "flex flex-col items-center text-gray-500 gap-2" }, React.createElement(ExternalLink, { size: 32 }), React.createElement('span', { className: "text-xs" }, t('upload_proof')))
                                )
                            )
                        ),

                        React.createElement(Button, { full: true, onClick: submit, disabled: loading, className: "shadow-[0_0_30px_rgba(255,215,0,0.2)]" }, loading ? t('processing') : "CONFIRM DEPOSIT")
                    )
                )
            );
        }

        function WithdrawScreen({ user, showMsg, t, back }) {
            const [method, setMethod] = useState(null);
            const [form, setForm] = useState({ amount: '', name: '', account: '', phone: '', network: 'Orange' });
            const [loading, setLoading] = useState(false);
            const [showSuccess, setShowSuccess] = useState(false);
            
            const METHODS = [
                { id: 'bank', name: t('method_bank'), icon: Landmark, color: 'text-orange-500', desc: "2-3 Days" },
                { id: 'cash', name: t('method_cash'), icon: Zap, color: 'text-yellow-500', desc: "Instant" },
                { id: 'recharge', name: t('method_recharge'), icon: Smartphone, color: 'text-green-500', desc: "Refill" },
                { id: 'crypto', name: t('method_crypto'), icon: Disc, color: 'text-blue-500', desc: "USDT" }
            ];

            const submit = async () => {
                if(loading) return; 
                if(!method || !form.amount) return showMsg(t('inputs_err'), 'error');
                if(method.id==='recharge' && !form.phone) return showMsg(t('inputs_err'), 'error');
                const amt = Number(form.amount);
                if(amt <= 0) return showMsg("Invalid Amount", 'error');
                if(Number(user.balance) < amt) return showMsg("Insufficient Balance", 'error');

                setLoading(true);
                try {
                    await updateDoc(doc(db, "users", user.id), { balance: Number(user.balance) - amt });
                    await addDoc(collection(db, "withdraws"), { userId: user.id, username: user.username, amount: amt, method: method.name, details: form, status: 'pending', date: new Date().toISOString() });
                    setShowSuccess(true);
                } catch (e) { showMsg(t('error'), 'error'); }
                setLoading(false);
            };

            if (showSuccess) return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-md animate-fade-in" },
                React.createElement('div', { className: "bg-dark-900 p-8 rounded-3xl border border-gold-500/30 text-center max-w-sm w-full mx-6" },
                    React.createElement('div', { className: "w-20 h-20 bg-gold-500/20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_30px_rgba(234,179,8,0.3)]" },
                        React.createElement(Check, { size: 40, className: "text-gold-500 animate-pop" })
                    ),
                    React.createElement('h2', { className: "text-2xl font-bold text-white mb-2" }, "Withdrawal Initiated"),
                    React.createElement('p', { className: "text-gray-400 text-sm mb-6" }, "Your funds are on the way. Check history for status."),
                    React.createElement(Button, { onClick: () => { setShowSuccess(false); back(); }, full: true }, "Return to Wallet")
                )
            );

            return React.createElement('div', { className: "h-full flex flex-col animate-slide-up pb-20" },
                // Header
                React.createElement('div', { className: "flex items-center gap-4 mb-6" },
                    React.createElement('button', { onClick: back, className: "p-2 rounded-xl bg-white/5 hover:bg-white/10 text-white transition-colors" }, React.createElement(ChevronLeft)),
                    React.createElement('h2', { className: "text-2xl font-black text-white font-oswald tracking-wide" }, t('withdraw'))
                ),

                // Balance Indicator
                React.createElement('div', { className: "bg-gradient-to-r from-red-900/20 to-transparent p-4 rounded-2xl border-l-4 border-red-500 mb-6 flex justify-between items-center" },
                    React.createElement('span', { className: "text-xs font-bold text-red-200 uppercase tracking-wider" }, "WITHDRAWABLE"),
                    React.createElement('span', { className: "text-xl font-mono font-black text-white" }, `$${Number(user.balance).toFixed(2)}`)
                ),

                React.createElement('div', { className: "flex-1 overflow-y-auto space-y-6 pr-1" },
                    // Method Selector (Horizontal)
                    React.createElement('div', {},
                        React.createElement('p', { className: "text-xs font-bold text-gray-500 uppercase tracking-widest mb-3 pl-1" }, "DESTINATION"),
                        React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                            METHODS.map(m => React.createElement('button', { key: m.id, onClick: () => setMethod(m), className: `p-3 rounded-xl border flex flex-col items-center gap-2 transition-all ${method?.id === m.id ? 'border-gold-500 bg-gold-500/10' : 'border-white/10 bg-dark-800 hover:bg-dark-700'}` },
                                React.createElement(m.icon, { className: m.color, size: 24 }),
                                React.createElement('span', { className: "text-xs font-bold text-white" }, m.name),
                                React.createElement('span', { className: "text-[9px] text-gray-500" }, m.desc)
                            ))
                        )
                    ),

                    // Dynamic Form
                    method && React.createElement('div', { className: "space-y-4 animate-slide-up bg-dark-900/50 p-4 rounded-2xl border border-white/5" },
                        React.createElement(Input, { placeholder: "0.00", type:"number", value: form.amount, onChange: e=>setForm({...form, amount:e.target.value}), icon: DollarSign, className: "font-mono font-bold text-lg" }),
                        
                        (method.id === 'bank') && React.createElement(React.Fragment, null,
                            React.createElement(Input, { placeholder: t('name'), value: form.name, onChange: e=>setForm({...form, name:e.target.value}), icon: User }),
                            React.createElement(Input, { placeholder: t('rib'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: CreditCard }),
                            React.createElement(Input, { placeholder: t('bank_name'), value: form.bank, onChange: e=>setForm({...form, bank:e.target.value}), icon: Landmark })
                        ),
                        (method.id === 'cash') && React.createElement(React.Fragment, null,
                            React.createElement(Input, { placeholder: t('name'), value: form.name, onChange: e=>setForm({...form, name:e.target.value}), icon: User }),
                            React.createElement(Input, { placeholder: t('cnie'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: CreditCard }),
                            React.createElement(Input, { placeholder: t('phone'), value: form.phone, onChange: e=>setForm({...form, phone:e.target.value}), icon: Smartphone })
                        ),
                        (method.id === 'recharge') && React.createElement(React.Fragment, null,
                            React.createElement(Input, { placeholder: t('phone'), value: form.phone, onChange: e=>setForm({...form, phone:e.target.value}), icon: Smartphone }),
                            React.createElement('select', { value: form.network, onChange: e=>setForm({...form, network:e.target.value}), className: "w-full bg-dark-950 border border-white/10 p-4 rounded-xl text-white outline-none appearance-none font-bold" },
                                React.createElement('option', {value:"Orange"}, "Orange"),
                                React.createElement('option', {value:"Maroc Telecom"}, "Maroc Telecom"),
                                React.createElement('option', {value:"Inwi"}, "Inwi")
                            )
                        ),
                        (method.id === 'crypto') && React.createElement(React.Fragment, null,
                            React.createElement(Input, { placeholder: t('wallet_addr'), value: form.account, onChange: e=>setForm({...form, account:e.target.value}), icon: Disc })
                        ),

                        React.createElement(Button, { full:true, onClick: submit, disabled: loading, variant:'red' }, loading ? t('processing') : "REQUEST WITHDRAWAL")
                    )
                )
            );
        }

        function ExchangeScreen({ user, showMsg, t, back }) {
            const [amount, setAmount] = useState('');
            const [mode, setMode] = useState('to_coins'); 
            const RATE = 100; // 1 USD = 100 COINS

            const execute = async () => {
                const val = Number(amount);
                if(!val || val <= 0) return showMsg("Invalid Amount", "error");

                if (mode === 'to_coins') {
                    if (Number(user.balance) < val) return showMsg("Insufficient Balance ($)", "error");
                    const coinsToAdd = val * RATE;
                    await updateDoc(doc(db,"users",user.id), {
                        balance: Number(user.balance) - val,
                        coins: Number(user.coins) + coinsToAdd
                    });
                    showMsg(`Exchanged $${val} to ${coinsToAdd} Coins`, 'success');
                } else {
                    if (Number(user.coins) < val) return showMsg("Insufficient Coins", "error");
                    const usdToAdd = val / RATE;
                    await updateDoc(doc(db,"users",user.id), {
                        coins: Number(user.coins) - val,
                        balance: Number(user.balance) + usdToAdd
                    });
                    showMsg(`Exchanged ${val} Coins to $${usdToAdd.toFixed(2)}`, 'success');
                }
                setAmount('');
            };

            return React.createElement('div', { className: "animate-pop" },
                React.createElement('button', { onClick: back, className: "mb-4 text-gold-500 flex items-center gap-2" }, React.createElement(ChevronRight), t('wallet')),
                React.createElement('h2', { className: "text-2xl font-bold mb-4 text-gold-500" }, t('exchange')),
                React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl border border-white/10 space-y-6" },
                    React.createElement('div', { className: "flex justify-center" },
                          React.createElement('div', { className: "bg-black/40 px-4 py-2 rounded-full border border-white/5 text-xs text-gray-400 flex items-center gap-2" },
                            React.createElement(DollarSign, { size: 12, className: "text-green-500" }),
                            "1.00",
                            React.createElement(ArrowLeftRight, { size: 12 }),
                            React.createElement(Gem, { size: 12, className: "text-gold-500" }),
                            RATE
                          )
                    ),
                    React.createElement('div', { className: "relative" },
                          React.createElement('div', { className: "flex justify-between text-xs text-gray-400 mb-1 px-1" },
                             React.createElement('span', {}, mode === 'to_coins' ? "From (USD Balance)" : "From (Game Coins)"),
                             React.createElement('span', { className: "text-white font-mono" }, mode === 'to_coins' ? `$${Number(user.balance).toFixed(2)}` : user.coins)
                          ),
                          React.createElement(Input, { type: "number", value: amount, onChange: e=>setAmount(e.target.value), icon: mode==='to_coins'?DollarSign:Gem, placeholder: "Amount to convert" })
                    ),
                    React.createElement('div', { className: "flex justify-center" },
                        React.createElement('button', { onClick: ()=>setMode(mode==='to_coins'?'to_usd':'to_coins'), className: "p-3 bg-gold-500 rounded-full text-black shadow-lg hover:scale-110 transition-transform" },
                             React.createElement(ArrowUp, { size: 20, className: "rotate-0" }) 
                        )
                    ),
                    React.createElement('div', { className: "bg-black/40 p-4 rounded-xl text-center border border-white/5" },
                        React.createElement('p', { className: "text-xs text-gray-500 mb-1" }, "You Receive"),
                        React.createElement('p', { className: "text-2xl font-black font-mono text-white flex items-center justify-center gap-2" },
                            mode === 'to_coins' ? (amount ? (amount * RATE) : 0) : (amount ? (amount / RATE).toFixed(2) : '0.00'),
                            mode === 'to_coins' ? React.createElement(Gem, { size: 20, className: "text-gold-500" }) : React.createElement(DollarSign, { size: 20, className: "text-green-500" })
                        )
                    ),
                    React.createElement(Button, { full: true, onClick: execute }, t('convert'))
                )
            );
        }

        function HistoryScreen({ user, t, back }) {
            const [list, setList] = useState([]);
            useEffect(() => {
                const fetchHistory = async () => {
                    const dQ = query(collection(db, "deposits"), where("userId", "==", user.id));
                    const wQ = query(collection(db, "withdraws"), where("userId", "==", user.id));
                    const [dSnap, wSnap] = await Promise.all([getDocs(dQ), getDocs(wQ)]);
                    const dData = dSnap.docs.map(d => ({...d.data(), type: 'deposit'}));
                    const wData = wSnap.docs.map(d => ({...d.data(), type: 'withdraw'}));
                    const combined = [...dData, ...wData].sort((a,b) => new Date(b.date) - new Date(a.date));
                    setList(combined);
                };
                fetchHistory();
            }, []);

            return React.createElement('div', { className: "animate-pop" },
                React.createElement('div', { className: "flex items-center gap-2 mb-4" }, 
                     back && React.createElement('button', { onClick: back, className: "text-gold-500" }, React.createElement(ChevronRight)),
                    React.createElement('h2', { className: "text-gold-500 font-bold text-lg" }, t('history'))
                ),
                list.length === 0 
                ? React.createElement('div', { className: "bg-dark-900 rounded-2xl p-6 text-center text-gray-500" }, "No records found")
                : React.createElement('div', { className: "space-y-2" }, list.map((item, i) => 
                    React.createElement('div', { key: i, className: "bg-dark-900 p-4 rounded-xl flex justify-between items-center border border-white/5" },
                        React.createElement('div', {}, 
                            React.createElement('p', { className: `font-bold ${item.type==='deposit'?'text-green-400':'text-red-400'}` }, 
                                item.type === 'deposit' ? 'DEPOSIT' : 'WITHDRAW'
                            ),
                            React.createElement('p', { className: "text-xs text-white/80" }, item.method),
                            React.createElement('p', { className: "text-[10px] text-gray-500" }, new Date(item.date).toLocaleDateString())
                        ),
                        React.createElement('div', { className: "text-right" }, 
                            React.createElement('p', { className: "text-white font-mono font-bold" }, item.type==='deposit' ? `+${item.amount}$` : `-${item.amount}$`),
                            React.createElement('span', { className: `text-[9px] px-2 py-0.5 rounded ${item.status==='pending'?'bg-yellow-500/20 text-yellow-500':(item.status==='approved'?'bg-green-500/20 text-green-500':'bg-red-500/20 text-red-500')}` }, item.status)
                        )
                    )
                ))
            );
        }

        function Header({ user, toggleMenu }) {
            return React.createElement('div', { className: "sticky top-0 z-40 glass-premium px-5 py-4 flex justify-between items-center transition-all duration-300" },
                React.createElement('div', { className: "flex items-center gap-3" },
                    React.createElement('button', { onClick: () => { AudioSys.click(); toggleMenu(); }, className: "p-2 bg-white/5 rounded-xl text-gold-500 border border-white/5 hover:bg-gold-500/10 transition-colors btn-press" }, React.createElement(Menu, { size: 24 })),
                    React.createElement('div', { className: "relative group" },
                        React.createElement('div', { className: "absolute -inset-1 bg-gradient-to-r from-gold-600 to-gold-300 rounded-xl blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200" }),
                        React.createElement('div', { className: "relative w-10 h-10 rounded-xl bg-gradient-to-tr from-dark-900 to-black flex items-center justify-center border border-gold-500/30" },
                            React.createElement('span', { className: "font-black text-gold-500 text-sm tracking-tighter" }, "CD")
                        )
                    )
                ),
                React.createElement('div', { className: "bg-black/40 border border-gold-500/20 px-4 py-1.5 rounded-full flex items-center gap-3 shadow-[inset_0_2px_10px_rgba(0,0,0,0.5)]" }, 
                    React.createElement('div', { className: "w-2 h-2 rounded-full bg-green-500 animate-pulse shadow-[0_0_8px_#22c55e]" }),
                    React.createElement(Gem, { size: 16, className: "text-gold-500 text-glow" }), 
                    React.createElement('div', { className: "text-gold-100 font-bold text-sm" }, React.createElement(AnimatedCounter, { value: user.coins }))
                )
            );
        }

        function Sidebar({ user, close, navTo, t, lang, setLang, settings, logout }) {
            return React.createElement('div', { className: "fixed inset-0 z-50 flex" },
                React.createElement('div', { className: "absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity duration-300", onClick: close }),
                React.createElement('div', { className: `relative w-80 h-full bg-[#050505] border-l border-gold-500/20 shadow-[0_0_80px_rgba(0,0,0,1)] flex flex-col transition-transform duration-300 ${lang==='ar'?'animate-slide-in-right':'animate-slide-in-left'}` },
                    
                    // ÿ±ÿ£ÿ≥ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© (ŸÖÿπ ÿßŸÑÿ¥ÿπÿßÿ±)
                    React.createElement('div', { className: "p-8 border-b border-white/5 bg-gradient-to-b from-gold-900/10 to-transparent relative overflow-hidden" },
                        React.createElement('div', { className: "absolute top-0 right-0 w-full h-full bg-[url('./logo.jpg')] bg-cover opacity-5 blur-sm pointer-events-none mix-blend-overlay" }),
                        React.createElement('div', { className: "flex justify-between items-start mb-6 relative z-10" },
                            React.createElement('div', { className: "w-20 h-20 rounded-full bg-gradient-to-tr from-gold-300 via-yellow-500 to-gold-800 p-[3px] shadow-[0_0_30px_rgba(234,179,8,0.3)] animate-pulse-glow" },
                                React.createElement('div', { className: "w-full h-full rounded-full bg-black flex items-center justify-center overflow-hidden relative" },
                                    React.createElement('img', { 
                                        src: "./logo.jpg", 
                                        className: "w-full h-full object-cover relative z-10 hover:scale-110 transition-transform duration-500",
                                        onError: (e) => { e.target.style.display='none'; } 
                                    }),
                                    React.createElement(User, { className: "text-gold-500 absolute", size: 32 })
                                )
                            ),
                            React.createElement('button', { onClick: close, className: "text-gray-500 hover:text-white transition-colors bg-white/5 p-2 rounded-full backdrop-blur-md hover:bg-red-500/20 hover:text-red-500" }, React.createElement(X, { size: 20 }))
                        ),
                        React.createElement('div', { className: "relative z-10 space-y-1" },
                            React.createElement('h3', { className: "text-white font-black text-2xl font-oswald tracking-wide uppercase" }, user.fullName || "VIP MEMBER"),
                            React.createElement('div', { className: "flex items-center gap-2" },
                                React.createElement('span', { className: "text-[9px] bg-gradient-to-r from-gold-500 to-yellow-300 text-black font-black px-2 py-0.5 rounded shadow-lg shadow-gold-500/20" }, "TIER 1"),
                                React.createElement('p', { className: "text-gray-400 text-xs font-mono tracking-wider" }, `ID: ${user.memberId}`)
                            )
                        )
                    ),

                    // ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑
                    React.createElement('nav', { className: "flex-1 overflow-y-auto p-4 space-y-2 no-scrollbar" },
                        React.createElement(SidebarBtn, { icon: Home, label: t('home'), onClick: ()=>navTo('home') }),
                        React.createElement(SidebarBtn, { icon: Dices, label: t('casino'), onClick: ()=>navTo('casino'), badge: "HOT" }),
                        React.createElement(SidebarBtn, { icon: Wallet, label: t('wallet'), onClick: ()=>navTo('profile') }),
                        React.createElement(SidebarBtn, { icon: Trophy, label: t('tasks'), onClick: ()=>navTo('tasks') }),
                        
                        React.createElement('div', { className: "h-px bg-gradient-to-r from-transparent via-white/10 to-transparent my-4 mx-2" }), 
                        
                        React.createElement(SidebarBtn, { icon: History, label: t('history'), onClick: ()=>navTo('history') }),
                        React.createElement(SidebarBtn, { icon: Settings, label: t('settings'), onClick: ()=>navTo('settings') }),
                        
                        // üëáüëá ÿ™ŸÖÿ™ ÿ•ÿ∂ÿßŸÅÿ© ÿ≤ÿ± ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ ŸáŸÜÿß üëáüëá
                        React.createElement(SidebarBtn, { icon: FileText, label: t('terms'), onClick: ()=>navTo('terms') }),
                        
                        React.createElement(SidebarBtn, { icon: ShieldCheck, label: t('policy'), onClick: ()=>navTo('policy') }),
                        
                        React.createElement('button', { 
                            onClick: () => { const l = lang==='ar'?'en':'ar'; setLang(l); localStorage.setItem('cd0777_lang', l); AudioSys.click(); },
                            className: "w-full flex items-center justify-between p-3.5 rounded-xl text-gray-400 hover:bg-white/5 border border-transparent hover:border-white/10 transition-all mt-2 group" 
                        }, 
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement(Globe, { size: 20, className: "group-hover:text-blue-400 transition-colors" }),
                                React.createElement('span', { className: "font-medium text-sm" }, t('lang'))
                            ),
                            React.createElement('span', { className: "text-[10px] bg-white/5 px-2 py-1 rounded font-mono text-gray-300" }, lang==='ar'?'English':'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©')
                        )
                    ),

                    // ÿ≤ÿ± ÿßŸÑÿÆÿ±Ÿàÿ¨
                    React.createElement('div', { className: "p-6 border-t border-white/5 bg-black/40" },
                        React.createElement('button', { onClick: logout, className: "w-full flex items-center justify-center gap-2 p-4 rounded-2xl bg-red-500/5 text-red-500 border border-red-500/20 hover:bg-red-500/10 hover:border-red-500/40 hover:shadow-[0_0_20px_rgba(239,68,68,0.1)] transition-all font-bold text-sm btn-press group" },
                            React.createElement(LogOut, { size: 18, className: "group-hover:-translate-x-1 transition-transform" }),
                            t('logout')
                        )
                    )
                )
            );
        }
        
        const SidebarBtn = ({ icon: Icon, label, onClick }) => React.createElement('button', { onClick, className: "w-full flex items-center gap-4 p-3.5 rounded-xl text-gray-300 hover:bg-white/5 btn-press" }, React.createElement(Icon, { size: 20 }), React.createElement('span', {}, label));
        const NavBtn = ({ icon: Icon, label, active, onClick }) => React.createElement('button', { onClick, className: `flex flex-col items-center gap-1 transition-all ${active?'text-gold-500 -translate-y-1 scale-110':'text-gray-500'}` }, React.createElement(Icon, { size: 24, strokeWidth: active?2.5:2 }), React.createElement('span', { className: "text-[9px] font-bold" }, label));
        const SettingsBtn = ({ icon: Icon, label, onClick, arrow, isRTL }) => React.createElement('button', { onClick, className: "w-full flex items-center justify-between p-4 hover:bg-white/5 rounded-xl group transition-all" }, React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "p-2 bg-dark-950 rounded-lg text-gold-500 group-hover:scale-110 transition-transform" }, React.createElement(Icon, { size: 18 })), React.createElement('span', { className: "font-medium text-sm" }, label)), arrow && (isRTL ? React.createElement(ChevronLeft, { size: 16, className: "text-gray-600" }) : React.createElement(ChevronRight, { size: 16, className: "text-gray-600" })));

        function InfoPage({ title, content, back, settings }) {
            const supportLink = settings?.support_link || "https://t.me/your_admin";
            const supportText = settings?.support_text || "Contact us for assistance";
            return React.createElement('div', { className: "h-full bg-dark-950 p-6 overflow-y-auto animate-pop" },
                React.createElement('button', { onClick: back, className: "mb-6 text-gold-500 flex items-center gap-2 font-bold p-2 bg-gold-500/10 rounded-xl w-max" }, React.createElement(ChevronRight), "Back"),
                React.createElement('h2', { className: "text-3xl font-bold mb-6 text-gold-500 font-oswald uppercase" }, title),
                React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl text-gray-300 text-sm leading-relaxed whitespace-pre-wrap font-cairo border border-white/5 shadow-lg mb-6" }, content),
                React.createElement('div', { className: "border-t border-white/10 pt-6 mt-4" },
                    React.createElement('div', { className: "bg-blue-900/20 border border-blue-500/30 p-6 rounded-2xl text-center" },
                        React.createElement(Headphones, { size: 32, className: "text-blue-400 mx-auto mb-3" }),
                        React.createElement('h3', { className: "text-white font-bold mb-2" }, "Support Center"),
                        React.createElement('p', { className: "text-gray-400 text-xs mb-4" }, supportText),
                        React.createElement('a', { href: supportLink, target: "_blank", rel: "noopener", className: "inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl font-bold transition-colors shadow-lg shadow-blue-900/50" }, React.createElement(Send, { size: 16 }), "Contact Support")
                    )
                )
            );
        }

        function PendingActivationScreen({ user, logout, t, isRTL, showMsg, settings }) {
            const promoCode = settings?.promo_code || "CD0777";
            const telegramLink = settings?.telegram_link || "https://t.me/your_admin_link";
            const xbetLink = settings?.xbet_link || "https://refpa7921972.top/L?tag=d_3162621m_1573c_&site=3162621&ad=1573";
            const copyCode = (e) => { e.stopPropagation(); e.preventDefault(); navigator.clipboard.writeText(promoCode); showMsg(`Copied: ${promoCode}`); };
            
            return React.createElement('div', { className: "h-screen bg-black flex flex-col items-center justify-center p-6 relative overflow-hidden", dir: isRTL?'rtl':'ltr' },
                React.createElement('div', { className: "absolute inset-0 luxury-bg opacity-90" }),
                React.createElement('div', { className: "absolute top-0 left-0 w-full h-full star-bg opacity-40" }),
                React.createElement('div', { className: "absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[150vw] h-[150vw] bg-gold-500/5 blur-[120px] rounded-full pointer-events-none" }),
                
                React.createElement('div', { className: "relative w-full max-w-sm aspect-[1.6/1] mb-8 animate-fade-in perspective-1000 group cursor-pointer" },
                    React.createElement('div', { className: "absolute inset-0 elite-card-bg rounded-2xl shadow-2xl overflow-hidden flex flex-col p-6 z-10 transition-transform transform group-hover:scale-105" },
                        React.createElement('div', { className: "absolute inset-0 card-shine pointer-events-none z-20 opacity-30" }),
                        React.createElement('div', { className: "absolute inset-0 hologram pointer-events-none opacity-20" }),
                        
                        React.createElement('div', { className: "flex justify-between items-start z-30" },
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement('div', { className: "w-10 h-10 rounded-full border-2 border-gold-500 flex items-center justify-center bg-black" }, React.createElement(Crown, { size: 20, className: "text-gold-500" })),
                                React.createElement('div', { className: "flex flex-col" }, React.createElement('span', { className: "text-white font-oswald tracking-[0.2em] text-lg font-bold italic" }, "ELITE"), React.createElement('span', { className: "text-gold-500 text-[10px] tracking-[0.4em] uppercase" }, "PRESTIGE CLUB"))
                            ),
                            React.createElement(Wifi, { size: 24, className: "text-white/50 rotate-90" })
                        ),
                        
                        React.createElement('div', { className: "my-auto relative z-30" },
                             React.createElement('div', { className: "flex items-center gap-3 mb-1" }, React.createElement('div', { className: "bg-gold-500/20 px-3 py-1 rounded text-gold-400 text-xs font-bold border border-gold-500/50" }, "WELCOME BONUS"), React.createElement('div', { className: "h-px flex-1 bg-gradient-to-r from-gold-500/50 to-transparent" })),
                             React.createElement('div', { className: "flex items-baseline gap-2" }, React.createElement('span', { className: "text-4xl font-black text-transparent bg-clip-text bg-gradient-to-t from-gold-600 to-white drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]" }, "1000"), React.createElement('span', { className: "text-sm text-gold-300 font-bold" }, "COINS")),
                             React.createElement('p', { className: "text-[10px] text-gray-400 mt-1 flex items-center gap-1 animate-pulse" }, React.createElement(RefreshCw, { size: 10 }), "Auto-convert to CASH upon approval")
                        ),
                        
                        React.createElement('div', { className: "mt-auto flex justify-between items-end z-30" },
                            React.createElement('div', {}, React.createElement('p', { className: "text-[8px] text-gray-500 uppercase font-bold tracking-widest" }, "MEMBER"), React.createElement('p', { className: "text-sm text-white font-mono uppercase tracking-wide drop-shadow-md" }, user.fullName || user.username)),
                            React.createElement('div', { className: "text-right" }, React.createElement('p', { className: "text-[8px] text-gray-500 uppercase font-bold" }, "ID"), React.createElement('p', { className: "text-sm font-mono text-white/80" }, user.memberId || "xxxx"))
                        )
                    )
                ),

                React.createElement('div', { className: "w-full max-w-sm space-y-4 relative z-10" },
                    React.createElement('div', { className: "bg-dark-900/80 backdrop-blur-md border border-white/10 p-5 rounded-2xl space-y-4" },
                        React.createElement('h3', { className: "text-center text-white font-bold mb-2 uppercase tracking-wide text-xs opacity-60" }, "Complete Activation"),
                        
                        React.createElement('a', { href: xbetLink, target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5 group hover:border-green-500/50 hover:bg-green-900/10 transition-all cursor-pointer" },
                            React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "w-8 h-8 rounded-full bg-gradient-to-tr from-green-600 to-green-400 flex items-center justify-center font-bold text-white text-xs shadow-lg" }, "1"), React.createElement('div', {}, React.createElement('p', { className: "text-xs text-white font-bold" }, "Register on 1xBet"), React.createElement('p', { className: "text-[10px] text-gray-400" }, "You MUST use Promo Code:"))),
                            React.createElement('button', { onClick: copyCode, className: "flex items-center gap-2 px-2 py-1 bg-green-500/20 text-green-400 rounded-lg border border-green-500/30 font-mono font-bold text-xs hover:bg-green-500/30" }, promoCode, React.createElement(Copy, { size: 12 }))
                        ),

                        React.createElement('a', { href: telegramLink, target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5 group hover:border-blue-500/50 hover:bg-blue-900/10 transition-all" },
                            React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "w-8 h-8 rounded-full bg-gradient-to-tr from-sky-500 to-sky-300 flex items-center justify-center text-white shadow-lg" }, React.createElement(Send, { size: 14 })), React.createElement('div', {}, React.createElement('p', { className: "text-xs text-gray-300" }, "Send ID to Admin"), React.createElement('p', { className: "text-xs font-bold text-sky-400" }, "Telegram Verification"))),
                            React.createElement(ExternalLink, { size: 16, className: "text-gray-500 group-hover:text-white transition-colors" })
                        )
                    ),

                    React.createElement('div', { className: "flex items-center justify-center gap-2 text-xs text-gold-500/70" }, React.createElement('div', { className: "w-2 h-2 rounded-full bg-gold-500 animate-pulse" }), t('wait_admin')),
                    React.createElement('button', { onClick: logout, className: "w-full mt-4 text-gray-500 text-xs font-bold flex items-center justify-center gap-2 hover:text-white transition-colors" }, React.createElement(LogOut, { size: 14 }), t('logout'))
                )
            );
        }

        // --- OPTIMIZED ADMIN PANEL (TIER 1 SCALABILITY) ---
        function AdminPanel({ user, logout, db, showMsg, t }) {
            const [activeTab, setActiveTab] = useState('configuration'); // ŸÜÿ®ÿØÿ£ ÿ®ÿµŸÅÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            const [dataList, setDataList] = useState([]);
            const [loading, setLoading] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            const [balInput, setBalInput] = useState('');
            const [editId, setEditId] = useState(null);
            
            // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ (ÿ®ŸÖÿß ŸÅŸä ÿ∞ŸÑŸÉ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑÿ£ÿ±ÿ®ÿπÿ©)
            const [conf, setConf] = useState({
                house_win_rate: 70,
                promo_code: "CD0777",
                telegram_link: "",
                xbet_link: "",
                // ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑÿ£ÿ±ÿ®ÿπÿ©
                attijari_info: "", // Bank Info
                cashplus_info: "", // CashPlus Info
                binance_info: "",  // Crypto Wallet
                paypal_info: "",   // PayPal Email
                // ÿßŸÑŸÜÿµŸàÿµ
                terms: DEFAULT_TERMS,
                policy: DEFAULT_POLICY
            });

            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            useEffect(() => {
                getDoc(doc(db, "settings", "global")).then(s => {
                    if(s.exists()) {
                        const d = s.data();
                        setConf(prev => ({...prev, ...d}));
                        if(d.house_win_rate) GLOBAL_HOUSE_EDGE = d.house_win_rate / 100;
                    }
                });
            }, []);

            // ÿ¨ŸÑÿ® ÿßŸÑŸÇŸàÿßÿ¶ŸÖ
            useEffect(() => {
                let unsub;
                setDataList([]); 
                if(activeTab === 'deposits') unsub = onSnapshot(query(collection(db, "deposits"), where("status", "==", "pending"), limit(50)), s => setDataList(s.docs.map(d => ({id: d.id, ...d.data()}))));
                else if(activeTab === 'withdraws') unsub = onSnapshot(query(collection(db, "withdraws"), where("status", "==", "pending"), limit(50)), s => setDataList(s.docs.map(d => ({id: d.id, ...d.data()}))));
                else if(activeTab === 'pending_users') unsub = onSnapshot(query(collection(db, "users"), where("status", "==", "pending"), limit(50)), s => setDataList(s.docs.map(d => ({id: d.id, ...d.data()}))));
                else if(activeTab === 'users' || activeTab === 'logs') loadData();
                return () => { if(unsub) unsub(); };
            }, [activeTab]);

            const loadData = async () => {
                const col = activeTab === 'users' ? 'users' : 'game_logs';
                const snap = await getDocs(query(collection(db, col), limit(20)));
                setDataList(snap.docs.map(d => ({id: d.id, ...d.data()})));
            };

            const saveConfig = async () => {
                setLoading(true);
                try {
                    await setDoc(doc(db,"settings","global"), conf, {merge:true});
                    GLOBAL_HOUSE_EDGE = conf.house_win_rate / 100;
                    showMsg("SETTINGS SAVED ‚úÖ");
                } catch(e) { showMsg("Error", "error"); }
                setLoading(false);
            };

            const updateSt = async (uid, st, type, item) => {
                if(type === 'user') await updateDoc(doc(db, "users", uid), { status: st });
                else {
                    await updateDoc(doc(db, type==='dep'?'deposits':'withdraws', uid), { status: st });
                    if(st === 'approved' && type === 'dep') {
                        const uRef = doc(db,"users", item.userId);
                        const uSnap = await getDoc(uRef);
                        if(uSnap.exists()) await updateDoc(uRef, { coins: Number(uSnap.data().coins||0) + (item.amount * 10) }); 
                    }
                }
                showMsg("Updated");
            };

            const handleSearch = async () => {
                if(!searchTerm) return loadData();
                const snap = await getDocs(query(collection(db, "users"), where("username", "==", searchTerm)));
                setDataList(snap.docs.map(d => ({id: d.id, ...d.data()})));
            };

            const AdminSidebar = () => React.createElement('div', { className: "w-64 bg-dark-900 border-r border-white/5 flex flex-col p-4 hidden md:flex" },
                React.createElement('h1', { className: "text-2xl font-black text-gold-500 mb-8 tracking-widest text-center" }, "GOD MODE"),
                ['configuration', 'pending_users', 'deposits', 'withdraws', 'users', 'logs'].map(t => 
                    React.createElement('button', { key: t, onClick: ()=>setActiveTab(t), className: `p-3 rounded-xl mb-2 text-left font-bold text-xs transition-all flex items-center gap-3 ${activeTab===t ? 'bg-gold-500 text-black shadow-lg shadow-gold-500/20' : 'text-gray-400 hover:bg-white/5 hover:text-white'}` }, 
                        t.toUpperCase().replace('_', ' ')
                    )
                ),
                React.createElement('button', { onClick: logout, className: "mt-auto p-3 rounded-xl bg-red-900/20 text-red-500 font-bold flex items-center gap-3 hover:bg-red-900/40" }, React.createElement(LogOut, {size:18}), "LOGOUT")
            );

            const renderContent = () => {
                if (activeTab === 'configuration') return React.createElement('div', { className: "space-y-6 animate-fade-in pb-20" },
                    
                    // 1. GAME SETTINGS (WIN RATE)
                    React.createElement('div', { className: "bg-dark-900 p-6 rounded-2xl border border-gold-500/30 shadow-lg relative overflow-hidden" },
                        React.createElement('h3', { className: "text-gold-500 font-bold mb-4 flex items-center gap-2" }, React.createElement(Target), "GAME DIFFICULTY CONTROL"),
                        React.createElement('div', { className: "flex items-center gap-4" },
                            React.createElement('span', { className: "text-green-500 text-xs font-bold" }, "EASY"),
                            React.createElement('input', { type: "range", min: "0", max: "100", step: "5", value: conf.house_win_rate, onChange: e=>setConf({...conf, house_win_rate: Number(e.target.value)}), className: "flex-1 h-3 bg-gray-700 rounded-full appearance-none cursor-pointer accent-gold-500" }),
                            React.createElement('span', { className: "text-red-500 text-xs font-bold" }, "HARD")
                        ),
                        React.createElement('p', { className: "text-center mt-2 font-mono text-gold-500" }, `House Win Rate: ${conf.house_win_rate}%`)
                    ),

                    // 2. PAYMENT METHODS (THE 4 METHODS)
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                        // Bank
                        React.createElement('div', { className: "bg-dark-900 p-4 rounded-xl border border-white/5" },
                            React.createElement('h4', { className: "text-orange-500 font-bold mb-2 flex items-center gap-2" }, React.createElement(Landmark, {size:16}), "Bank Transfer (Attijari)"),
                            React.createElement('textarea', { className: "w-full h-20 bg-black border border-white/10 p-2 rounded text-white text-xs", placeholder: "RIB / Name...", value: conf.attijari_info, onChange: e=>setConf({...conf, attijari_info:e.target.value}) })
                        ),
                        // CashPlus
                        React.createElement('div', { className: "bg-dark-900 p-4 rounded-xl border border-white/5" },
                            React.createElement('h4', { className: "text-yellow-500 font-bold mb-2 flex items-center gap-2" }, React.createElement(Zap, {size:16}), "Cash Plus / Wafa"),
                            React.createElement('textarea', { className: "w-full h-20 bg-black border border-white/10 p-2 rounded text-white text-xs", placeholder: "Full Name / City / Phone...", value: conf.cashplus_info, onChange: e=>setConf({...conf, cashplus_info:e.target.value}) })
                        ),
                        // Crypto
                        React.createElement('div', { className: "bg-dark-900 p-4 rounded-xl border border-white/5" },
                            React.createElement('h4', { className: "text-green-500 font-bold mb-2 flex items-center gap-2" }, React.createElement(Disc, {size:16}), "Crypto (USDT TRC20)"),
                            React.createElement('input', { className: "w-full bg-black border border-white/10 p-3 rounded text-white text-xs font-mono", placeholder: "Wallet Address...", value: conf.binance_info, onChange: e=>setConf({...conf, binance_info:e.target.value}) })
                        ),
                        // PayPal
                        React.createElement('div', { className: "bg-dark-900 p-4 rounded-xl border border-white/5" },
                            React.createElement('h4', { className: "text-blue-500 font-bold mb-2 flex items-center gap-2" }, React.createElement(Wallet, {size:16}), "PayPal"),
                            React.createElement('input', { className: "w-full bg-black border border-white/10 p-3 rounded text-white text-xs", placeholder: "PayPal Email...", value: conf.paypal_info, onChange: e=>setConf({...conf, paypal_info:e.target.value}) })
                        )
                    ),

                    // 3. LINKS & CODES
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-4" },
                        React.createElement(Input, { placeholder:"Promo Code", value: conf.promo_code, onChange: e=>setConf({...conf, promo_code:e.target.value}) }),
                        React.createElement(Input, { placeholder:"1XBET Link", value: conf.xbet_link, onChange: e=>setConf({...conf, xbet_link:e.target.value}) }),
                        React.createElement(Input, { placeholder:"Telegram Link", value: conf.telegram_link, onChange: e=>setConf({...conf, telegram_link:e.target.value}) }),
                    ),

                    // 4. LEGAL TEXTS
                    React.createElement('div', { className: "space-y-4" },
                        React.createElement('h3', {className:"text-gold-500 font-bold"}, "Legal Texts"),
                        React.createElement('textarea', { className: "w-full h-32 bg-dark-900 border border-white/10 p-3 rounded-xl text-white text-xs font-mono", placeholder:"Terms & Conditions", value: conf.terms, onChange: e=>setConf({...conf, terms:e.target.value}) }),
                        React.createElement('textarea', { className: "w-full h-32 bg-dark-900 border border-white/10 p-3 rounded-xl text-white text-xs font-mono", placeholder:"Privacy Policy", value: conf.policy, onChange: e=>setConf({...conf, policy:e.target.value}) }),
                    ),

                    React.createElement(Button, { onClick: saveConfig, full: true, loading: loading }, "SAVE ALL CHANGES")
                );

                // --- OLD TABS (DATA TABLES) ---
                return React.createElement('div', { className: "space-y-4 animate-fade-in" },
                    activeTab === 'users' && React.createElement('div', { className: "flex gap-2 mb-4" },
                        React.createElement('input', { className: "bg-dark-900 border border-white/10 p-2 rounded-lg flex-1 text-white", placeholder: "Search Username...", value: searchTerm, onChange: e=>setSearchTerm(e.target.value) }),
                        React.createElement(Button, { onClick: handleSearch, className: "py-2 px-6" }, "Search")
                    ),
                    dataList.length === 0 ? React.createElement('div', {className:"text-center text-gray-500 py-10"}, "No records found.") : 
                    dataList.map(item => React.createElement('div', { key: item.id, className: "bg-dark-900 p-4 rounded-xl border border-white/5 flex flex-col md:flex-row justify-between items-center gap-4" },
                        React.createElement('div', { className: "flex-1" },
                            React.createElement('p', { className: "font-bold text-white" }, item.username || item.fullName || "User"),
                            React.createElement('p', { className: "text-xs text-gold-500 font-mono" }, 
                                activeTab === 'users' ? `Coins: ${item.coins} | Bal: $${item.balance||0}` : 
                                activeTab === 'logs' ? `${item.game} | Profit: ${item.profit}` :
                                `${item.amount}$ via ${item.method}`
                            ),
                            item.image && React.createElement('a', { href: item.image, target: "_blank", className: "text-xs text-blue-400 underline block mt-1" }, "View Payment Proof")
                        ),
                        React.createElement('div', { className: "flex gap-2" },
                            (activeTab === 'deposits') && React.createElement(React.Fragment, null,
                                React.createElement('button', { onClick: ()=>updateSt(item.id, 'approved', 'dep', item), className: "bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-bold text-xs" }, "APPROVE"),
                                React.createElement('button', { onClick: ()=>updateSt(item.id, 'rejected', 'dep'), className: "bg-red-900/30 text-red-500 px-4 py-2 rounded-lg font-bold text-xs" }, "REJECT")
                            ),
                            (activeTab === 'withdraws') && React.createElement(React.Fragment, null,
                                React.createElement('button', { onClick: ()=>updateSt(item.id, 'approved', 'with', item), className: "bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-bold text-xs" }, "PAY & APPROVE"),
                                React.createElement('button', { onClick: ()=>updateSt(item.id, 'rejected', 'with'), className: "bg-red-900/30 text-red-500 px-4 py-2 rounded-lg font-bold text-xs" }, "REJECT")
                            ),
                            (activeTab === 'pending_users') && React.createElement(React.Fragment, null,
                                React.createElement('button', { onClick: ()=>updateSt(item.id, 'active', 'user'), className: "bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-bold text-xs" }, "ACTIVATE"),
                                React.createElement('button', { onClick: ()=>deleteDoc(doc(db,"users",item.id)), className: "bg-red-900/30 text-red-500 px-4 py-2 rounded-lg font-bold text-xs" }, "DELETE")
                            ),
                            (activeTab === 'users') && React.createElement(React.Fragment, null,
                                editId === item.id ? React.createElement('div', {className:"flex gap-2"},
                                    React.createElement('input', {type:"number", className:"w-20 bg-black text-white px-2 rounded", onChange:e=>setBalInput(e.target.value)}),
                                    React.createElement('button', {onClick:()=>{updateDoc(doc(db,"users",item.id),{coins:Number(balInput)}); setEditId(null)}, className:"text-green-500"}, React.createElement(Check))
                                ) : React.createElement('button', {onClick:()=>{setEditId(item.id); setBalInput(item.coins)}, className:"text-blue-500 p-2 bg-blue-500/10 rounded"}, React.createElement(Edit3, {size:16})),
                                React.createElement('button', { onClick: ()=>updateSt(item.id, item.status==='banned'?'active':'banned', 'user'), className: `px-3 py-1 rounded-lg text-xs font-bold ${item.status==='banned'?'bg-green-500/20 text-green-500':'bg-red-500/20 text-red-500'}` }, item.status==='banned'?'UNBAN':'BAN')
                            )
                        )
                    ))
                );
            };

            return React.createElement('div', { className: "flex h-screen bg-[#050505] text-white font-sans overflow-hidden" },
                React.createElement(AdminSidebar),
                React.createElement('div', { className: "flex-1 flex flex-col h-full" },
                    // Mobile Header
                    React.createElement('div', { className: "md:hidden p-4 border-b border-white/10 flex justify-between items-center bg-dark-900" },
                        React.createElement('h1', { className: "text-lg font-black text-gold-500" }, "ADMIN GOD MODE"),
                        React.createElement('button', { onClick: logout, className: "text-red-500" }, React.createElement(LogOut, {size:20}))
                    ),
                    // Mobile Nav Scroll
                    React.createElement('div', { className: "md:hidden flex gap-2 p-2 overflow-x-auto bg-dark-950 border-b border-white/5" },
                        ['configuration', 'pending_users', 'deposits', 'withdraws', 'users', 'logs'].map(t => 
                            React.createElement('button', { 
                                key: t, onClick: ()=>setActiveTab(t), 
                                className: `px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap ${activeTab===t ? 'bg-gold-500 text-black' : 'bg-white/5 text-gray-400'}` 
                            }, t.toUpperCase().replace('_', ' '))
                        )
                    ),
                    // Main Content Area
                    React.createElement('div', { className: "flex-1 overflow-y-auto p-6" },
                        renderContent()
                    )
                )
            );
        }

        function SplashScreen() {
            const [progress, setProgress] = useState(0);
            const [text, setText] = useState("INITIALIZING CORE...");

            useEffect(() => {
                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ
                const times = [
                    { p: 20, t: "LOADING ASSETS...", d: 500 },
                    { p: 45, t: "VERIFYING ENCRYPTION...", d: 1000 },
                    { p: 70, t: "CONNECTING TO SATELLITE...", d: 1500 },
                    { p: 90, t: "SYNCING WALLET DATA...", d: 2000 },
                    { p: 100, t: "ACCESS GRANTED", d: 2400 }
                ];

                times.forEach(step => {
                    setTimeout(() => {
                        setProgress(step.p);
                        setText(step.t);
                        AudioSys.click(); // ÿµŸàÿ™ ÿ™ŸÉÿ™ŸÉÿ© ÿπŸÜÿØ ŸÉŸÑ ŸÖÿ±ÿ≠ŸÑÿ©
                    }, step.d);
                });
            }, []);

            return React.createElement('div', { className: "fixed inset-0 bg-[#020617] z-[100] flex flex-col items-center justify-center font-mono" },
                // ÿßŸÑÿÆŸÑŸÅŸäÿ© ÿßŸÑÿ¥ÿ®ŸÉŸäÿ©
                React.createElement('div', { className: "absolute inset-0 opacity-10 bg-[radial-gradient(circle_at_center,_#334155_1px,_transparent_1px)]", style: { backgroundSize: '24px 24px' } }),
                
                // ÿßŸÑÿ¥ÿπÿßÿ± ÿßŸÑŸÜÿßÿ®ÿ∂
                React.createElement('div', { className: "relative w-32 h-32 flex items-center justify-center mb-12" },
                    React.createElement('div', { className: "absolute inset-0 border-t-4 border-l-4 border-gold-500/50 rounded-full animate-spin", style: { animationDuration: '3s' } }),
                    React.createElement('div', { className: "absolute inset-2 border-b-4 border-r-4 border-gold-500/30 rounded-full animate-spin", style: { animationDuration: '2s', animationDirection: 'reverse' } }),
                    React.createElement('h1', { className: "text-6xl font-black text-transparent bg-clip-text bg-gradient-to-tr from-gold-300 to-gold-600 font-oswald tracking-tighter animate-pulse" }, "CD")
                ),

                // ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
                React.createElement('div', { className: "w-64 h-1 bg-gray-800 rounded-full overflow-hidden mb-4 relative" },
                    React.createElement('div', { 
                        className: "h-full bg-gold-500 shadow-[0_0_15px_#eab308] transition-all duration-300 ease-out",
                        style: { width: `${progress}%` } 
                    })
                ),

                // ÿßŸÑŸÜÿµŸàÿµ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿ©
                React.createElement('div', { className: "h-6 flex items-center" },
                    React.createElement('p', { className: "text-[10px] text-gold-500/80 tracking-[0.3em] font-bold animate-pulse" }, text)
                ),

                // ÿ±ŸÇŸÖ ÿßŸÑÿ•ÿµÿØÿßÿ±
                React.createElement('div', { className: "absolute bottom-8 text-gray-600 text-[9px] flex flex-col items-center gap-1" },
                    React.createElement(Lock, { size: 12 }),
                    React.createElement('span', {}, "SECURE CONNECTION: ENCRYPTED")
                )
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>

